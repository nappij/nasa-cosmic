      SUBROUTINE PRECHO(DEP)
C
      IMPLICIT REAL*8(A-H,O-Z)
C
      REAL*8 I3,I2OVI3
C
      COMMON/CCNVRT/BDYMI(3,3),DPRMI(3,3),EMODLS(10),RTUBE(10),
C
     *              HTUBE(10),THERMC(10),TIPMS(10),C(10)
C
      COMMON/CECHON/CEI20(10),CEI21(10),CEI30(10),CEI31(10)
C
     1             ,CGJ0(10),CGJ1(10),TWI0(3,10),TWI1(3,10)
C
     2             ,TWID0(3,10),TWID1(3,10),MODEST(10)
C
      COMMON/CONSTS/PI,TWOPI,RADIAN
C
C
      COMMON/DATOUT/IDATA,MLAST
C
      COMMON/INEWR/NKT(10),ICP,ICPS
C
      COMMON/IPOOL1/IGRAV,IDAMP,IK,K1,ITIM,IAB,IAPS,IBB,IBPS,NK(10),
C
     *              LK(10),LLK(10)
C
      COMMON/ITW/ITWIST,ITWST1
C
      COMMON/RMAIN1/DUMM1(5),UPBND(150),DNBND(150)
C
      COMMON/RNEWC/ZGJ(10),ZEDQ(10),ZO(10),ZED2(10),ZED3(10)
C
      COMMON/RNEWR / ZA(10),I3(10),I2OVI3(10),
C
     *             ZDQ(10),ZJ(10),D2(10),D3(10)
C
      COMMON/RNEWV/CW(10,3),CDW(10,3)
C
      COMMON/RPOOL1/RHOK(10),TIME,SA(3,3),FM1(3,3),ZLK(10),OMEG(3),
     *              ZLKP(10),ZLKDP(10),CMATO(3,3),GBAR(3,3),YBCM(3),
     *              ZBZK(3,10),FCMO(3,3),DTO,PHID,PHI
C
      COMMON/TMSINR/TIPINR(3,10),RTSQ(3,10),XIPL(6),BETL(6)
C
      COMMON/TWIBND/TWIUP,TWIDN,TWDUP,TWDDN
C
      COMMON/TWIOUT/CWO(10,3),CWDO(10,3)
C
C
      DIMENSION DEP(150)
C
C
C
      IF(IDATA.NE.0) GO TO 20
C
      NEL=IK-K1
C
      DO 10 I=1,IK
      CI3=PI*RTUBE(I)**3*HTUBE(I)
      I1=I+K1
      IF(I1.GT.IK) I1=I-NEL
      CI2=CI3*I2OVI3(I1)
      CEI20(I)=CI2*EMODLS(I)
      CEI21(I1)=CEI20(I)
      CEI30(I)=CI3*EMODLS(I)
      CEI31(I1)=CEI30(I)
      I3(I1)=CI3
      IF(ITWIST.EQ.0) GO TO 10
      CGJ0(I)=0.4D0*EMODLS(I)*ZJ(I1)
      CGJ1(I1)=CGJ0(I)
      ZO(I1)=EMODLS(I)*(CI2-CI3)/144.0D0
      ZGJ(I1)=0.4D0*EMODLS(I)*ZJ(I1)/144.0D0
      ZED2(I1)=EMODLS(I)*D2(I1)/1728.0D0
      ZED3(I1)=EMODLS(I)*D3(I1)/1728.0D0
      ZEDQ(I1)=EMODLS(I)*ZDQ(I1)/(144.0D0*144.0D0)
      DO 8 J=1,3
      TWI0(J,I)=CW(I1,J)
      TWID0(J,I)=CDW(I1,J)
    8 CONTINUE
      MODEST(I)=NKT(I1)
   10 CONTINUE
C
      GO TO 30
C
   20 CONTINUE
C
      DO 25  I=1,IK
      DO 24 J=1,3
      TWI1(J,I)=CWO(I,J)
      TWID1(J,I)=CWDO(I,J)
   24 CONTINUE
   25 CONTINUE
C
   30 CONTINUE
C
      L=1
C
      DO 101 K=1,IK
      IF(NKT(K).EQ.0) GO TO 108
      IF(L.NE.1) GO TO 201
      ICPS=ICP+NKT(K)
      IKOUT=ICP
      IKOUTD=ICPS
      L=2
  201 CONTINUE
      NKNT=NKT(K)
      DO 102 IP=1,NKNT
      IP1=IP-1
         DEP(IKOUT+IP1)=CW(K,IP)*RADIAN
         DEP(IKOUTD+IP1)=CDW(K,IP)*RADIAN
      IF(IDATA.EQ.0) GO TO 104
      DEP(IKOUT+IP1)=CWO(K,IP)*RADIAN
      DEP(IKOUTD+IP1)=CWDO(K,IP)*RADIAN
  104 CONTINUE
      UPBND(IKOUT+IP1)=TWIUP
      DNBND(IKOUT+IP1)=TWIDN
      UPBND(IKOUTD+IP1)=TWDUP
      DNBND(IKOUTD+IP1)=TWDDN
  102 CONTINUE
      IKOUT=IKOUT+NKNT*2
      IKOUTD=IKOUTD+NKNT*2
  108 CONTINUE
      DO 109 I=1,3
      CWO(K,I)=0.0D0
      CWDO(K,I)=0.0D0
  109 CONTINUE
C
      RTSQ(1,K)=0.5D0*(TIPINR(2,K)+TIPINR(3,K)-TIPINR(1,K))
      RTSQ(2,K)=0.5D0*(TIPINR(3,K)+TIPINR(1,K)-TIPINR(2,K))
      RTSQ(3,K)=0.5D0*(TIPINR(1,K)+TIPINR(2,K)-TIPINR(3,K))
C
  101 CONTINUE
C
      RETURN
C
      END
