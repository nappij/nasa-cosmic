*DECK MAIN
      PROGRAM PAFAC( INPUT,OUTPUT,TAPE2=INPUT,TAPE3=OUTPUT,TAPE6         MAIN        2
     +,TAPE7,TAPE8,TAPE9)                                                MAIN        3
C     MAIN PROGRAM OF STANDARD PAFAC (PLASTIC ANALYSIS OF COMPOSITES)    MAIN        4
C     PAC78 PROGRAM/DUKE UNIVERSITY/MAY  01,1980/Y.A.BAHEI-EL-DIN/////// MAIN        5
C     PAFAC PROGRAM/NASA LANGLEY/ NOVEMBER 1982/C.A.BIGELOW///////////// MAIN        6
        COMMON /COMEL/ IN(5000)                                          MAIN        7
      IN(326) = 2                                                        MAIN        8
      IN(327) = 3                                                        MAIN        9
    1 IFLG = 0                                                           MAIN       10
        CALL PAC1 (IFLG,5000)                                            MAIN       11
      IF( IFLG .EQ. 1 ) GO TO 2                                          MAIN       12
    3 IFLG = 0                                                           MAIN       13
      CALL PAC2 ( IFLG )                                                 MAIN       14
      IF(IFLG .EQ. 1 ) GO TO 1                                           MAIN       15
    4 IFLG = 0                                                           MAIN       16
      CALL PAC3 ( IFLG )                                                 MAIN       17
      IF (IFLG .EQ. 1) GO TO 1                                           MAIN       18
      IFLG = 0                                                           MAIN       19
      CALL PAC4 ( IFLG )                                                 MAIN       20
      IF(IFLG .EQ. 1) GO TO 3                                            MAIN       21
      IF(IFLG .EQ. 2) GO TO 4                                            MAIN       22
      GO TO 1                                                            MAIN       23
    2 STOP                                                               MAIN       24
      END                                                                MAIN       25
*DECK TIME
      SUBROUTINE TIMEO(CTIME)                                            TIME        2
      COMMON / INIT / TIME1                                              TIME        3
      GO TO 1                                                            TIME        4
      ENTRY RESET                                                        TIME        5
      CALL SECOND(TIME1)                                                 TIME        6
      RETURN                                                             TIME        7
  1   CALL SECOND(TIME2)                                                 TIME        8
      CTIME = TIME2 - TIME1                                              TIME        9
      RETURN                                                             TIME       10
      END                                                                TIME       11
*DECK PAC1
      SUBROUTINE PAC1( IFLG,IDATA )                                      PAC1        2
C     MAIN SUBROUTINE FOR THE INPUT LINK                                 PAC1        3
C     READS STORES AND CHECKS INPUT DATA                                 PAC1        4
CMAP10                                                                   PAC1        5
      COMMON/COMEL/IN                                                    PAC1        6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PAC1        7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PAC1        8
      EQUIVALENCE (IN,IA(1),AA(1))                                       PAC1        9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PAC1       10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PAC1       11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PAC1       12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PAC1       13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PAC1       14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PAC1       15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PAC1       16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PAC1       17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PAC1       18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PAC1       19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PAC1       20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PAC1       21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PAC1       22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PAC1       23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PAC1       24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PAC1       25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PAC1       26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PAC1       27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PAC1       28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PAC1       29
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           PAC1       30
CEND MAP10                                                               PAC1       31
CMAP20                                                                   PAC1       32
      DIMENSION LLL(27)                                                  PAC1       33
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PAC1       34
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PAC1       35
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PAC1       36
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PAC1       37
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PAC1       38
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PAC1       39
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PAC1       40
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PAC1       41
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PAC1       42
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PAC1       43
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PAC1       44
CEND MAP20                                                               PAC1       45
      DIMENSION ZEM(20)                                                  PAC1       46
      DATA CTES/4HEND /,CENT/4H????/                                     PAC1       47
   10 CALL RESET                                                         PAC1       48
      IERR=0                                                             PAC1       49
  15  READ(IO,297) ( ZEM(I),I=1,20 )                                     PAC1       50
      IF(EOF(IO).NE.0) GO TO 7                                           PAC1       51
  297 FORMAT(20A4)                                                       PAC1       52
      IF(ZEM(1) .EQ. CENT) GO TO 57                                      PAC1       53
      DO 2 I=1,325                                                       PAC1       54
    2 IA(I)=0                                                            PAC1       55
      ISCAL=0                                                            PAC1       56
      ITY=IDATA                                                          PAC1       57
      DO 30 I=1,20                                                       PAC1       58
 30   AA(I+250)=ZEM(I)                                                   PAC1       59
      GO TO 1                                                            PAC1       60
C *** RESTART JOB                                                        PAC1       61
 57   READ(IO,31) NIP,NIPRS,NIMAT,NISDT,NIYIT,NELMT,NINP,NIHARD,JTAS     PAC1       62
     1,NIPIR,ISCAL,NLCDP,NIAMB                                           PAC1       63
   31 FORMAT (I4,3I2,I1,I5,5I1,2I2)                                      PAC1       64
      REWIND JTAS                                                        PAC1       65
      READ(JTAS) IFILE,LLZ,LEN,ICOUNT,(AA(I),I=1,IFILE)                  PAC1       66
      IMES=0                                                             PAC1       67
      IBUN=0                                                             PAC1       68
      ICOR=0                                                             PAC1       69
      IPOTT=IPOT-100                                                     PAC1       70
      IF(ITAX .EQ. 0) GO TO 33                                           PAC1       71
      REWIND ITAX                                                        PAC1       72
      WRITE(ITAX) (AA(LLZ+I),I=1,LEN)                                    PAC1       73
 33   IYIT=NIYIT                                                         PAC1       74
      INP=NINP                                                           PAC1       75
      IPIR=NIPIR                                                         PAC1       76
      IHARD=NIHARD                                                       PAC1       77
      DO 32 I=1,20                                                       PAC1       78
 32   AA(I+250)=ZEM(I)                                                   PAC1       79
      ALL=AA(LLD+2*LCDP)                                                 PAC1       80
      ILL=IA(LCDP+LLD)                                                   PAC1       81
      IF(ISCAL .EQ. 1) GO TO 46                                          PAC1       82
      PSCAL=1.                                                           PAC1       83
 46   CALL TABLP                                                         PAC1       84
      WRITE(MO,60)NIP,NIPRS,NIMAT,NISDT,NIYIT,NELMT,NINP,NIHARD,JTAS     PAC1       85
     1,NIPIR,ISCAL,NIAMB                                                 PAC1       86
 60   FORMAT(/////1X,18HRESTART PARAMETERS//                             PAC1       87
     11X,29HNIP   PARM. FOR CONC LOADS   ,I5,2X,                         PAC1       88
     21X,29HNIPRS PARM. FOR PR. TYPES    ,I5/                            PAC1       89
     31X,29HNIMAT PARM. FOR MATER. TYPES ,I5,2X,                         PAC1       90
     41X,29HNISDT PARM. FOR TEMP. CHANGES,I5/                            PAC1       91
     51X,29HNIYIT PARM. FOR TEMP. DEPEND.,I5,2X,                         PAC1       92
     61X,29HNELMT NEW ELMT PROP INDICATOR,I5,2X/                         PAC1       93
     71X,31HNINP  NEW PRINT LEVEL INDICATOR,I3,2X,                       PAC1       94
     81X,30HNIHARD NEW HARDENING INDICATOR,I4/                           PAC1       95
     91X,29HJTAS  RESTART INPUT FILE     ,I5,2X,                         PAC1       96
     A1X,29HNIPIR NEW RESTART OUTPUT FILE,I5/                            PAC1       97
     B1X,31HISCAL PARM. FOR RESTART SCALING,I3,2X,                       PAC1       98
     C2X,31HNIAMB MAT TP NO FOR FAILED ELMT,I2)                          PAC1       99
       IAMB=NIAMB                                                        PAC1      100
      LCDP=NLCDP                                                         PAC1      101
      IF(NIMAT .EQ. IMAT) GO TO 58                                       PAC1      102
      CALL RTABP                                                         PAC1      103
      GO TO 59                                                           PAC1      104
 58   CALL MTABP                                                         PAC1      105
   59 IF(NIPRS.EQ.IPRS) CALL PTAB(2)                                     PAC1      106
      IF(NISDT.EQ.ISDT) CALL PTAB(3)                                     PAC1      107
      IF((NIP .EQ. IP) .AND. (IP .NE. 0)) CALL NLOD                      PAC1      108
C *** READ NEW MATERIAL PROPERTIES OF ELEMENTS IF REQUIRED               PAC1      109
      IF(NELMT.EQ.0)GO TO 240                                            PAC1      110
      DO 200 I=1,NELMT                                                   PAC1      111
      READ(IO,210) M,IMET                                                PAC1      112
  210 FORMAT(2I4)                                                        PAC1      113
      IF(IMET.LE.IMAT) GO TO 220                                         PAC1      114
      WRITE(MO,230) M                                                    PAC1      115
  230 FORMAT(34H NEW MATERIAL TYPE NO. FOR ELEMENT,                      PAC1      116
     1I5,30H OUT OF RANGE. ELEMENT IGNORED)                              PAC1      117
      GO TO 200                                                          PAC1      118
  220 JM=J1+M                                                            PAC1      119
      JMFI=IA(JM)-100*(IA(JM)/100)                                       PAC1      120
      IA(JM)=100*IMET+JMFI                                               PAC1      121
  200 CONTINUE                                                           PAC1      122
C *** SCALE THE LOADS                                                    PAC1      123
  240 DO 45 I=1,LCDP                                                     PAC1      124
      J=LLD+LCDP+I                                                       PAC1      125
 45   AA(J)=PSCAL*AA(J)                                                  PAC1      126
C *** COMPUTE NEW DESC                                                   PAC1      127
      I=IA(LLD+1)-ILL                                                    PAC1      128
      IF(I .GT. 0) GO TO 40                                              PAC1      129
      IERR=IERR+1                                                        PAC1      130
      GO TO 35                                                           PAC1      131
   40 C1=(AA(LLD+LCDP+1)-ALL)/I                                          PAC1      132
      IF(C1*DESC.GT.0.) GO TO 43                                         PAC1      133
      DO 42 I=1,IT                                                       PAC1      134
      K=LLL(7)+I                                                         PAC1      135
 42   AA(K)=ABS(AA(K))                                                   PAC1      136
 43   DESC=C1                                                            PAC1      137
      ITER=ITER+1                                                        PAC1      138
      ITERS=0                                                            PAC1      139
      KTERS=0                                                            PAC1      140
C *** UPDATE TEMP. DECREASES AND ADJUST YIELD STRESSES IF IYIT .NE. 0    PAC1      141
      IF((ISDT .EQ. 0) .OR. (IYIT .EQ. 0)) GO TO 35                      PAC1      142
      MS=20*IHARD                                                        PAC1      143
      MS1=20*IYIT                                                        PAC1      144
      LHD1=LHD+IMAT+IMAT*MS                                              PAC1      145
      MM=0                                                               PAC1      146
      DO 145 M=1,IT                                                      PAC1      147
      K=IA(J2+M)                                                         PAC1      148
      K=K-(K/100)*100+IDT                                                PAC1      149
      IF(K .EQ. IDT) GO TO 145                                           PAC1      150
      DT=DESC*AA(K)                                                      PAC1      151
      IF(DT .GE. 0.) GO TO 145                                           PAC1      152
      T1=AA(LLL(9)+M)                                                    PAC1      153
      T2=T1+DT                                                           PAC1      154
      AA(LLL(9)+M)=T2                                                    PAC1      155
      YP=ABS(AA(LLL(7)+M))                                               PAC1      156
      EP=ABS(AA(LLL(8)+M))                                               PAC1      157
      JMET=IA(J1+M)/100                                                  PAC1      158
      M1=LHD1+IMAT+MS1*(JMET-1)                                          PAC1      159
      M2=M1+10*IYIT                                                      PAC1      160
      MENTR=IA(LHD1+JMET)                                                PAC1      161
      DO 130 I=2,MENTR                                                   PAC1      162
      IF(AA(M1+I) .GT.T1) GO TO 131                                      PAC1      163
 130  CONTINUE                                                           PAC1      164
      I=I-1                                                              PAC1      165
 131  YPN1=AA(M2+I-1)+(T1-AA(M1+I-1))*(AA(M2+I)-AA(M2+I-1))/             PAC1      166
     1                                (AA(M1+I)-AA(M1+I-1))              PAC1      167
      DO 128 I=2,MENTR                                                   PAC1      168
      IF(AA(M1+I) .GT.T2) GO TO 129                                      PAC1      169
 128  CONTINUE                                                           PAC1      170
      I=I-1                                                              PAC1      171
 129  YPN2=AA(M2+I-1)+(T2-AA(M1+I-1))*(AA(M2+I)-AA(M2+I-1))/             PAC1      172
     1                                (AA(M1+I)-AA(M1+I-1))              PAC1      173
      AA(LLL(7)+M)=YP*YPN2/YPN1                                          PAC1      174
      AA(LLL(8)+M)=-EP                                                   PAC1      175
      MM=MM+1                                                            PAC1      176
 145  CONTINUE                                                           PAC1      177
      IF(MM .EQ. IT) IELAS=0                                             PAC1      178
      GO TO 35                                                           PAC1      179
 7    IF((IPIR .LE. 0) .OR. (IPIR .GE. 100)) GO TO 50                    PAC1      180
      END FILE IPIR                                                      PAC1      181
 50   IF((IPOT .LE. 100) .OR. (IPOT .GE. 200)) GO TO 61                  PAC1      182
      IPOT=IPOT-100                                                      PAC1      183
      END FILE IPOT                                                      PAC1      184
 61   WRITE (MO,4)                                                       PAC1      185
    4 FORMAT (1X,13HEND OF PAFAC.)                                       PAC1      186
      IFLG = 1                                                           PAC1      187
      RETURN                                                             PAC1      188
C *** STANDARD JOB                                                       PAC1      189
    1 CALL DMEMP                                                         PAC1      190
      DO 9 I=J1,IID                                                      PAC1      191
    9 IA(I)=0                                                            PAC1      192
      CALL TABLP                                                         PAC1      193
      CALL MTABP                                                         PAC1      194
      CALL PTAB(1)                                                       PAC1      195
      CALL NCOR                                                          PAC1      196
      CALL NBON                                                          PAC1      197
      CALL NMES                                                          PAC1      198
      CALL SRATP                                                         PAC1      199
      CALL NASM                                                          PAC1      200
      CALL NLOD                                                          PAC1      201
C *** INITIALISE THE NECESSARY PARAMETERS                                PAC1      202
      ZZ=1.                                                              PAC1      203
      DESC=1.                                                            PAC1      204
      CUMS=1.0                                                           PAC1      205
      ISCAL=0                                                            PAC1      206
      ITER=1                                                             PAC1      207
      IELAS=0                                                            PAC1      208
      MPR=1                                                              PAC1      209
      ITERS=0                                                            PAC1      210
      KTERS=0                                                            PAC1      211
      IPOTT=100                                                          PAC1      212
      IFB=0                                                              PAC1      213
 35   IF (IERR.NE.0) GO TO 300                                           PAC1      214
      READ(IO,8)MAXI,MAXSI,NPRIN,NSTAV,ER1,IDIV ,IPOT,ITAX,IYEL,IDD,IRR, PAC1      215
     1TEST                                                               PAC1      216
 8    FORMAT(4I2,E12.5,I1,I2,I1,I4,A4,I2,43X,A3)                         PAC1      217
      IF(ER1.EQ.0.) ER1=0.01                                             PAC1      218
      IF (MAXSI.LE.0) MAXSI=10                                           PAC1      219
      IF(ZEM(1).EQ.CENT) GO TO 18                                        PAC1      220
      IF(IRR.EQ.1) GO TO 18                                              PAC1      221
      GO TO 300                                                          PAC1      222
   18 WRITE (MO,21) MAXI,MAXSI,NPRIN,NSTAV,ER1,IDIV,IPOT,ITAX,IYEL       PAC1      223
     1,IDD,IRR                                                           PAC1      224
   21 FORMAT(                                                            PAC1      225
     11X,47HSUBSTEP PRINTOUT INDICATOR(MAXI)%              ,I11/         PAC1      226
     21X,47HMAXIMUM NUMBER OF ALLOWABLE SUBSTEPS(MAXSI)%   ,I11/         PAC1      227
     31X,47HPRINTOUT INDICATOR FOR STRESS LINK(NPRIN)      ,I11/         PAC1      228
     41X,47HSTRAIN AVERAGING INDICATOR(NSTAV)%             ,I11/         PAC1      229
     51X,47HCONVERGENCE CRIT. FOR SUBSTEPS(ER1)%           ,E11.4/       PAC1      230
     61X,47HSUBDIVISION INDICATOR(IDIV)%                   ,I11/         PAC1      231
     71X,47HPLOT FILE UNIT NUMBER(IPOT)%                   ,I11/         PAC1      232
     81X,47HCUMULATIVE DEFORMATION FILE NAME(ITAX)%        ,I11/         PAC1      233
     91X,47HNO. OF ELTS. WHICH MAY YIELD IN A STEP(IYEL)%  ,I11/         PAC1      234
     A1X,47HJOB ID(IDD)%                                   ,7X,A4/       PAC1      235
     B1X,47HRESTART COUNT(IRR)%                            ,I11)         PAC1      236
      IF(INX.LT.2) GO TO 6                                               PAC1      237
      REWIND ITAS                                                        PAC1      238
      IND=3*IN                                                           PAC1      239
      WRITE (ITAS) (AA(IDEF+I),I=1,IND)                                  PAC1      240
      IF(IPOT .NE. IPOTT) GO TO 6                                        PAC1      241
C *** POSITION IPOT FOR A RESTARTED JOB                                  PAC1      242
      REWIND IPOT                                                        PAC1      243
      DO 37 I=1,ICOUNT                                                   PAC1      244
 37   READ(IPOT)                                                         PAC1      245
      IPOT=-IPOT                                                         PAC1      246
  6   CALL TIMEO (C1T)                                                   PAC1      247
      WRITE (MO,5)C1T                                                    PAC1      248
    5 FORMAT (1X,15HINPUT LINK TOOK,F7.2,9H SECONDS.)                    PAC1      249
      IF ((INX.LE.1).OR.(IERR.NE.0)) GO TO 10                            PAC1      250
      NI=0                                                               PAC1      251
      RETURN                                                             PAC1      252
  300 WRITE (MO,11)                                                      PAC1      253
   11 FORMAT (1X,17H17.  INPUT ERROR.)                                   PAC1      254
      WRITE (MO,12)(I,IA(I),I=1,IID)                                     PAC1      255
   12 FORMAT (1H1,8HIA BLOCK,//(20I6))                                   PAC1      256
      WRITE (MO,13) (I,AA(I),I=1,IST)                                    PAC1      257
   13 FORMAT (1H1,8HAA BLOCK,//(6(I6,E14.7)))                            PAC1      258
 302  READ(IO,14) TEST                                                   PAC1      259
   14 FORMAT (77X,A3)                                                    PAC1      260
      IF (TEST.NE.CTES) GO TO 15                                         PAC1      261
      GO TO 6                                                            PAC1      262
      END                                                                PAC1      263
*DECK ARAN
      SUBROUTINE ARAN                                                    ARAN        2
C     RELABELS MESH POINTS                                               ARAN        3
CMAP10                                                                   ARAN        4
      COMMON/COMEL/IN                                                    ARAN        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ARAN        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ARAN        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       ARAN        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ARAN        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ARAN       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ARAN       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ARAN       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ARAN       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ARAN       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ARAN       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ARAN       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ARAN       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ARAN       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ARAN       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ARAN       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ARAN       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ARAN       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ARAN       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ARAN       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ARAN       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ARAN       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ARAN       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ARAN       28
      EQUIVALENCE     (IA(401), S(1))                                    ARAN       29
CEND MAP10                                                               ARAN       30
CMAP30                                                                   ARAN       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              ARAN       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      ARAN       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  ARAN       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  ARAN       35
CEND MAP30                                                               ARAN       36
      IWORD = 32                                                         ARAN       37
      CLT=0.0                                                            ARAN       38
      XSAP=0.0                                                           ARAN       39
      XN=IN                                                              ARAN       40
      NCYCL=0                                                            ARAN       41
      NCYCN=IN/10+3                                                      ARAN       42
      ISURP=ISUR+1                                                       ARAN       43
      ICYCL=-1                                                           ARAN       44
 90   DO 100 I=1,IN                                                      ARAN       45
      KI=MMIN+I                                                          ARAN       46
      KX=MMAX+I                                                          ARAN       47
      IA(KI)=0                                                           ARAN       48
 100  IA(KX)=0                                                           ARAN       49
      KX=-IN+MBIN                                                        ARAN       50
      DO 700 I=1,IN                                                      ARAN       51
      KY=KX+I                                                            ARAN       52
      DO 400 J=1,ISUR                                                    ARAN       53
      KY=KY+IN                                                           ARAN       54
      ACH=AA(KY)                                                         ARAN       55
      DO 300 JB=1,IWORD                                                  ARAN       56
      IF (LEBIN(ACH,JB)) 420,300,420                                     ARAN       57
 300  CONTINUE                                                           ARAN       58
 400  CONTINUE                                                           ARAN       59
      GO TO 3100                                                         ARAN       60
 420  KI=MMIN+I                                                          ARAN       61
      IA(KI)=IWORD*(J-1)+JB                                              ARAN       62
      JC=ISURP-J                                                         ARAN       63
      DO 600 J=1,JC                                                      ARAN       64
      JBI=ISURP-J                                                        ARAN       65
      KY=MBIN+(JBI-1)*IN+I                                               ARAN       66
      ACH=AA(KY)                                                         ARAN       67
      DO 500 JB=1,IWORD                                                  ARAN       68
      JBC=IWORD-JB+1                                                     ARAN       69
      IF (LEBIN(ACH,JBC)) 620,500,620                                    ARAN       70
 500  CONTINUE                                                           ARAN       71
 600  CONTINUE                                                           ARAN       72
      GO TO 3100                                                         ARAN       73
 620  KY=MMAX+I                                                          ARAN       74
      IA(KY)=IWORD*JBI-JB+1                                              ARAN       75
 700  CONTINUE                                                           ARAN       76
 2010 NEQ=IN-1                                                           ARAN       77
      DO 2100 I=1,NEQ                                                    ARAN       78
      IX=I+1                                                             ARAN       79
      KX=MMAX+IX                                                         ARAN       80
      KI=MMAX+I                                                          ARAN       81
      IF (IA(KX)-IA(KI)) 2030,2100,2100                                  ARAN       82
 2030 IA(KX)=IA(KI)                                                      ARAN       83
 2100 CONTINUE                                                           ARAN       84
 3000 RETURN                                                             ARAN       85
 3100 WRITE (MO,4)I                                                      ARAN       86
 4    FORMAT (14H 1.  THE POINT,I5,33H DOES NOT APPEAR IN MESH TOPOLOGY) ARAN       87
      GO TO 3000                                                         ARAN       88
      END                                                                ARAN       89
*DECK BAND
      SUBROUTINE BAND                                                    BAND        2
C     OBTAIN POINTERS FOR DIAGONALS OF REDUCED STIFFNESS MATRIX          BAND        3
CMAP10                                                                   BAND        4
      COMMON/COMEL/IN                                                    BAND        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  BAND        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     BAND        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       BAND        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   BAND        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   BAND       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   BAND       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   BAND       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   BAND       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   BAND       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   BAND       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   BAND       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   BAND       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   BAND       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   BAND       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   BAND       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   BAND       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   BAND       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   BAND       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   BAND       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   BAND       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   BAND       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   BAND       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    BAND       28
      EQUIVALENCE     (IA(401), S(1))                                    BAND       29
CEND MAP10                                                               BAND       30
CMAP30                                                                   BAND       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              BAND       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      BAND       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  BAND       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  BAND       35
CEND MAP30                                                               BAND       36
C     INITIALIZE                                                         BAND       37
      IND=3*IN                                                           BAND       38
      IDEG=3                                                             BAND       39
      KX=MMAX+1                                                          BAND       40
      IMAXN=IA(KX)                                                       BAND       41
      IMAXB=1                                                            BAND       42
      KN=0                                                               BAND       43
      LBAND=0                                                            BAND       44
      LIBO=0                                                             BAND       45
      IND2=IND+2                                                         BAND       46
C     PROCESS NODES SEQUENTIALLY.                                        BAND       47
      DO 2300 I=1,IN                                                     BAND       48
C     COMPUTE THE EXTEND OF I TH ROW BLOCK                               BAND       49
      KX=MMAX+I                                                          BAND       50
      IMAXG=IA(KX)*IDEG                                                  BAND       51
C     IS THE I TH ROW BLOCK SHORTER THAN THE PREVIOUS ROW BLOCK?         BAND       52
      IF (IMAXB-IMAXN) 1940,1940,2105                                    BAND       53
C     I TH ROW BLOCK IS SHORTER. UPDATE DELETED COLUMN COUNT             BAND       54
C     FOR ADDITIONAL DELETIONS IN THE I TH ROW BLOCK                     BAND       55
 1940 DO 2100 J=IMAXB,IMAXN                                              BAND       56
      KX=MSIR+J                                                          BAND       57
      IBOJ=IBB+IDEG*(IA(KX)-1)                                           BAND       58
      DO 2000 K=1,IDEG                                                   BAND       59
      IBOK=IBOJ+K                                                        BAND       60
      IF (IA(IBOK)) 1950,1950,2000                                       BAND       61
 1950 KN=KN+1                                                            BAND       62
 2000 CONTINUE                                                           BAND       63
 2100 CONTINUE                                                           BAND       64
C     COMPUTE BEGINNING AND END OF THE EXTRA LENGTH OF NEXT ROW          BAND       65
C     BLOCK FROM THE CURRENT ONE                                         BAND       66
 2105 KX=MMAX+I                                                          BAND       67
      IMAXN=IA(KX+1)                                                     BAND       68
      IMAXB=IA(KX)+1                                                     BAND       69
C     COMPUTE BANDWIDTHS OF RETAINED ROWS IN THE CURRENT ROW BLOCK       BAND       70
      KX=MSIR+I                                                          BAND       71
      LIBO=(IA(KX)-1)*IDEG+IBB                                           BAND       72
      DO 2200 J=1,IDEG                                                   BAND       73
      IBOL=LIBO+J                                                        BAND       74
      IF (IA(IBOL))2200,2200,2110                                        BAND       75
 2110 LBAND=LBAND+1                                                      BAND       76
      KX=MBAN+LBAND                                                      BAND       77
      IA(KX)=IMAXG-LBAND-KN+1                                            BAND       78
 2200 CONTINUE                                                           BAND       79
 2300 CONTINUE                                                           BAND       80
      ISUM=LBAND                                                         BAND       81
      ITAP=0                                                             BAND       82
      IF (ITAP-10) 10,10,20                                              BAND       83
C     COMPUTE POINTERS ASSUMING CONSTANT BANDWIDTH                       BAND       84
C     COMPUTE MAXIMUM BANDWIDTH                                          BAND       85
 20   MBDW=IA(MBAN+1)                                                    BAND       86
      DO 21 I=2,ISUM                                                     BAND       87
      KX=MBAN+I                                                          BAND       88
      IF (MBDW-IA(KX)) 22,21,21                                          BAND       89
 22   MBDW=IA(KX)                                                        BAND       90
 21   CONTINUE                                                           BAND       91
C     COMPUTE THE POINTERS OF THE RETAINED ROWS                          BAND       92
      IUI=IU+1                                                           BAND       93
      IA(IUI)=1                                                          BAND       94
      ISUM1=ISUM+1                                                       BAND       95
      DO 23 I=2,ISUM1                                                    BAND       96
      IUI=IU+I                                                           BAND       97
 23   IA(IUI)=IA(IUI-1)+MBDW                                             BAND       98
      GO TO 30                                                           BAND       99
C     COMPUTE THE POINTERS OF RETAINED ROWS                              BAND      100
 10   IUI=IU+1                                                           BAND      101
      IA(IUI)=1                                                          BAND      102
      ISUM1=ISUM+1                                                       BAND      103
      DO 416 I=2,ISUM1                                                   BAND      104
      IUI=IU+I                                                           BAND      105
      KX=MBAN+I-1                                                        BAND      106
 416  IA(IUI)=IA(IUI-1)+IA(KX)                                           BAND      107
 30   RETURN                                                             BAND      108
      END                                                                BAND      109
*DECK BNRY
      SUBROUTINE BNRY                                                    BNRY        2
C     TO GENERATE ABIN BINARY MATRIX                                     BNRY        3
CMAP10                                                                   BNRY        4
      COMMON/COMEL/IN                                                    BNRY        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  BNRY        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     BNRY        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       BNRY        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   BNRY        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   BNRY       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   BNRY       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   BNRY       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   BNRY       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   BNRY       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   BNRY       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   BNRY       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   BNRY       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   BNRY       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   BNRY       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   BNRY       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   BNRY       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   BNRY       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   BNRY       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   BNRY       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   BNRY       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   BNRY       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   BNRY       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    BNRY       28
      EQUIVALENCE     (IA(401), S(1))                                    BNRY       29
CEND MAP10                                                               BNRY       30
CMAP30                                                                   BNRY       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              BNRY       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      BNRY       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  BNRY       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  BNRY       35
CEND MAP30                                                               BNRY       36
      IWORD = 32                                                         BNRY       37
      IH=8                                                               BNRY       38
      IDEG=3                                                             BNRY       39
      IND=3*IN                                                           BNRY       40
      K=IN*ISUR                                                          BNRY       41
      DO 71 I=1,K                                                        BNRY       42
      JBIN=MBIN+I                                                        BNRY       43
 71   AA(JBIN)=0.                                                        BNRY       44
      DO 99 M=1,IT                                                       BNRY       45
      CALL TOPO                                                          BNRY       46
      DO 98 I=1,IH                                                       BNRY       47
      L=IH-I+1                                                           BNRY       48
      IF (N(L)) 98,98,97                                                 BNRY       49
 98   CONTINUE                                                           BNRY       50
 1    WRITE (MO,111) M                                                   BNRY       51
 111  FORMAT (12H 2.  ELEMENT,I4,2X,31HIN ERROR.      ELEMENT IGNORED.)  BNRY       52
      GO TO 99                                                           BNRY       53
 97   IMS=L                                                              BNRY       54
C     EXPAND ELEMENT VERTEX VECTOR,BY MULTIPLE DBC INPUT UNITS,IN IMAX   BNRY       55
      L=0                                                                BNRY       56
      DO 300 I=1,IMS                                                     BNRY       57
      L=L+1                                                              BNRY       58
      LX=MMAX+L                                                          BNRY       59
      IA(LX)=N(I)                                                        BNRY       60
      KN=(N(I)-1)*IDEG+IBB                                               BNRY       61
      DO 301 J=1,IDEG                                                    BNRY       62
      IBOL=KN+J                                                          BNRY       63
      IF (IA(IBOL)) 302,311,301                                          BNRY       64
 311  KS=IBOL-IBB+IIC                                                    BNRY       65
      JJ=IA(KS)/100000                                                   BNRY       66
      MEND=IA(KS)-100000*JJ                                              BNRY       67
      KS=IBB+IND+MEND                                                    BNRY       68
      DO 312 K=1,JJ                                                      BNRY       69
      KS=KS+1                                                            BNRY       70
      NODE=-(IA(KS)+1)/IDEG+1                                            BNRY       71
      IF(NODE .GT. IN) GO TO 312                                         BNRY       72
 314  L=L+1                                                              BNRY       73
      LX=MMAX+L                                                          BNRY       74
      IA(LX)=NODE                                                        BNRY       75
 312  CONTINUE                                                           BNRY       76
      GO TO 301                                                          BNRY       77
 302  NODE=-(IA(IBOL)+1)/IDEG+1                                          BNRY       78
      IF(NODE-IN) 303,303,301                                            BNRY       79
 303  IF (N(I)-NODE) 304,301,304                                         BNRY       80
 304  L=L+1                                                              BNRY       81
      LX=MMAX+L                                                          BNRY       82
      IA(LX)=NODE                                                        BNRY       83
 301  CONTINUE                                                           BNRY       84
 300  CONTINUE                                                           BNRY       85
      IMS=1                                                              BNRY       86
      DO 306 I=2,L                                                       BNRY       87
      LX=MMAX+I                                                          BNRY       88
      KN=IA(LX)                                                          BNRY       89
      DO 307 J=1,IMS                                                     BNRY       90
      LX=MMAX+J                                                          BNRY       91
      IF (IA(LX)-KN) 307,306,307                                         BNRY       92
 307  CONTINUE                                                           BNRY       93
      IMS=IMS+1                                                          BNRY       94
      LX=MMAX+IMS                                                        BNRY       95
      IA(LX)=KN                                                          BNRY       96
 306  CONTINUE                                                           BNRY       97
      DO 95 I=1,IMS                                                      BNRY       98
      LX=MMAX+I                                                          BNRY       99
      IB=IA(LX)                                                          BNRY      100
      KN=0                                                               BNRY      101
      LIBO=(IB-1)*IDEG+IBB                                               BNRY      102
      DO 971 J=1,IDEG                                                    BNRY      103
      IBOL=LIBO+J                                                        BNRY      104
      IF (IA(IBOL)) 9711,9711,972                                        BNRY      105
 9711 KN=KN+1                                                            BNRY      106
 971  CONTINUE                                                           BNRY      107
 972  DO 94 J=1,IMS                                                      BNRY      108
      IF (KN-IDEG) 942,941,942                                           BNRY      109
 941  IF (I-J) 95,942,94                                                 BNRY      110
 942  LX=MMAX+J                                                          BNRY      111
      JB=IA(LX)                                                          BNRY      112
      KM=0                                                               BNRY      113
      LIBO=(JB-1)*IDEG+IBB                                               BNRY      114
      DO 981 L=1,IDEG                                                    BNRY      115
      IBOL=LIBO+L                                                        BNRY      116
      IF (IA(IBOL)) 9811,9811,982                                        BNRY      117
 9811 KM=KM+1                                                            BNRY      118
 981  CONTINUE                                                           BNRY      119
      IF (KM-IDEG) 982,983,982                                           BNRY      120
 983  IF (I-J) 94,982,94                                                 BNRY      121
 982  JJ=(JB-1)/IWORD+1                                                  BNRY      122
      K=MBIN+(JJ-1)*IN+IB                                                BNRY      123
      ACH=AA(K)                                                          BNRY      124
      JBIT=JB-IWORD*(JJ-1)                                               BNRY      125
      CALL SEBIN (ACH,JBIT,1)                                            BNRY      126
      AA(K)=ACH                                                          BNRY      127
 94   CONTINUE                                                           BNRY      128
 95   CONTINUE                                                           BNRY      129
 99   CONTINUE                                                           BNRY      130
      RETURN                                                             BNRY      131
      END                                                                BNRY      132
*DECK BUNG
      SUBROUTINE BUNG                                                    BUNG        2
C     USER SUPPLIED SUBROUTINE USED TO GENERATE AND                      BUNG        3
C     STORE DEFLECTION BOUNDARY CONDITIONS                               BUNG        4
C                                                                        BUNG        5
C   MEANING OF SYMBOLS%                                                  BUNG        6
C                                                                        BUNG        7
C     A,IA    ARRAY(S) IN COMMON,COMEL                                   BUNG        8
C     B       PORTION OF COMMON AVAILABLE TO USERS                       BUNG        9
C     IBN     NUMBER OF DEFLECTION BOUNDARY CONDITIONS                   BUNG       10
C     IDEF    POINTER FOR BOUNDARY CONDITIONS ARRAY IN COMMON            BUNG       11
C     I1,J1   NODE AND DIRECTION OF INDEPENDENT DEFLECT. COMPONENT       BUNG       12
C     I2,J2   NODE AND DIRECTION OF DEPENDENT DEFLECT. COMPONENT         BUNG       13
C     C       CONSTANT RELATING DEPEN. AND INDEPEN. DEFLECT. COMP.       BUNG       14
C                                                                        BUNG       15
      COMMON/COMEL/A(401)                                                BUNG       16
      DIMENSION IA(401),B(50)                                            BUNG       17
      EQUIVALENCE (A(1),IA(1),IN),(A(2),IBN),(A(54),IDEF),(A(200),B(1))  BUNG       18
      RETURN                                                             BUNG       19
      END                                                                BUNG       20
*DECK COOR
      SUBROUTINE COOR                                                    COOR        2
C     READS AND STORES COORDINATES                                       COOR        3
CMAP10                                                                   COOR        4
      COMMON/COMEL/IN                                                    COOR        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  COOR        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     COOR        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       COOR        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   COOR        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   COOR       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   COOR       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   COOR       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   COOR       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   COOR       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   COOR       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   COOR       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   COOR       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   COOR       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   COOR       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   COOR       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   COOR       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   COOR       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   COOR       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   COOR       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   COOR       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   COOR       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   COOR       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    COOR       28
      EQUIVALENCE     (IA(401), S(1))                                    COOR       29
CEND MAP10                                                               COOR       30
      L=0                                                                COOR       31
    1 READ (IO,102) N(1),X(1),Y(1),Z(1),N(2),X(2),Y(2),Z(2)              COOR       32
  102 FORMAT (2(I4,3E12.7))                                              COOR       33
      KL=1                                                               COOR       34
      IF (N(1).LE.0) GO TO 2                                             COOR       35
    3 L=L+1                                                              COOR       36
      IF (L.NE.N(KL)) GO TO 6                                            COOR       37
      AA(IXX+L)=X(KL)                                                    COOR       38
      AA(IYY+L)=Y(KL)                                                    COOR       39
      AA(IZZ+L)=Z(KL)                                                    COOR       40
    7 IF (KL.GT.1) GO TO 4                                               COOR       41
    2 IF (N(2).LE.0) GO TO 4                                             COOR       42
      KL=KL+1                                                            COOR       43
      GO TO 3                                                            COOR       44
    4 IF (L.LT.IN) GO TO 1                                               COOR       45
      RETURN                                                             COOR       46
    6 WRITE (MO,103) L,N(KL)                                             COOR       47
  103 FORMAT (16H 3.  THE NODE IN,I5,30H POSITION IS ILLEGALLY LABELED,  COOR       48
     13H AS,I6)                                                          COOR       49
      GO TO 7                                                            COOR       50
      END                                                                COOR       51
*DECK CORG
      SUBROUTINE CORG                                                    CORG        2
C     USER SUPPLIED SUBROUTINE USED TO GENERATE AND STORE                CORG        3
C     THE NODAL COORDINATES                                              CORG        4
C                                                                        CORG        5
C   MEANING OF SYMBOLS%                                                  CORG        6
C                                                                        CORG        7
C     A    ARRAY(S) IN COMMON,COMEL                                      CORG        8
C     B    PORTION OF COMMON AVAILABLE TO USERS                          CORG        9
C     IN   NUMBER OF NODE POINTS                                         CORG       10
C     IXX  POINTER FOR X-COORDINATE ARRAY IN COMMON                      CORG       11
C     IYY  POINTER FOR Y-COORDINATE ARRAY IN COMMON                      CORG       12
C     IZZ  POINTER FOR Z-COORDINATE ARRAY IN COMMON                      CORG       13
C                                                                        CORG       14
      COMMON/COMEL/A(401)                                                CORG       15
      DIMENSION B(50)                                                    CORG       16
      EQUIVALENCE (A(1),IN),(A(50),IXX),(A(51),IYY),(A(52),IZZ),         CORG       17
     1(A(200),B(1))                                                      CORG       18
      RETURN                                                             CORG       19
      END                                                                CORG       20
*DECK DMEMP
      SUBROUTINE DMEMP                                                   DMEMP       2
C     TO COMPUTE DYNAMIC MEMORY ALLOCATION CONSTANTS                     DMEMP       3
CMAP10                                                                   DMEMP       4
      COMMON/COMEL/IN                                                    DMEMP       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  DMEMP       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     DMEMP       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       DMEMP       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   DMEMP       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   DMEMP      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   DMEMP      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   DMEMP      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   DMEMP      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   DMEMP      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   DMEMP      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   DMEMP      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   DMEMP      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   DMEMP      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   DMEMP      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   DMEMP      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   DMEMP      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   DMEMP      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   DMEMP      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   DMEMP      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   DMEMP      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   DMEMP      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   DMEMP      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    DMEMP      28
      EQUIVALENCE     (IA(401), S(1))                                    DMEMP      29
CEND MAP10                                                               DMEMP      30
CMAP20                                                                   DMEMP      31
      DIMENSION LLL(27)                                                  DMEMP      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   DMEMP      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   DMEMP      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  DMEMP      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  DMEMP      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   DMEMP      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   DMEMP      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   DMEMP      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   DMEMP      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  DMEMP      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   DMEMP      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   DMEMP      43
CEND MAP20                                                               DMEMP      44
      READ(IO,10) IN,IT,ITYPE,IBN,IP,IPRS,IMAT,ISDT,IMFI,LCDP,INX,       DMEMP      45
     1INP,ISHUF,ICOR,IBUN,IMES,IPIR,KHARD,IHARD,IYIT,ITAS,IAMB,IFBR,     DMEMP      46
     2G1,G2,G3,ACEL                                                      DMEMP      47
   10 FORMAT(2I4,I1,3I4,4I2,11I1,I5,I2,8X,3F5.4,E10.3)                   DMEMP      48
      IF (ITAS.NE.0) REWIND ITAS                                         DMEMP      49
      IERR=0                                                             DMEMP      50
      IF(IN.LT.8) IERR=IERR+1                                            DMEMP      51
      IF (IT.LE.0) IERR=IERR+1                                           DMEMP      52
      IF (ITYPE.GT.1) IERR=IERR+1                                        DMEMP      53
      IF(ITYPE.EQ.0 .AND. KHARD.EQ.0) IERR=IERR+1                        DMEMP      54
      IF (IMAT.LE.0) IERR=IERR+1                                         DMEMP      55
      IF ((INX.LT.0).OR.(INX.GT.4)) IERR=IERR+1                          DMEMP      56
      IF (INP.GT.2) IERR=IERR+1                                          DMEMP      57
      IF(ITYPE.EQ.0 .AND. IFBR.GT.0) IERR=IERR+1                         DMEMP      58
      NAA=15                                                             DMEMP      59
      IF(ITYPE.EQ.1) NAA=NAA+6                                           DMEMP      60
      IF(IFBR.GT.0) NAA=NAA+6                                            DMEMP      61
      IND=3*IN                                                           DMEMP      62
      IDS=12                                                             DMEMP      63
      IIS=400                                                            DMEMP      64
      J1=IIS+IDS*IDS                                                     DMEMP      65
      J2=J1+IT                                                           DMEMP      66
      J3=J2+IT                                                           DMEMP      67
      J4=J3+IT                                                           DMEMP      68
      J5=J4+IT                                                           DMEMP      69
      J6=J5+IT                                                           DMEMP      70
      J7=J6+IT                                                           DMEMP      71
      J8=J7+IT                                                           DMEMP      72
      J9=J8+IT                                                           DMEMP      73
      J10=J9+IT                                                          DMEMP      74
      IID=J10+IT                                                         DMEMP      75
      N1=2                                                               DMEMP      76
      N2=6                                                               DMEMP      77
      IF(ITYPE.NE.0) GO TO 20                                            DMEMP      78
      N1=1                                                               DMEMP      79
      N2=2                                                               DMEMP      80
   20 IIA=IID+N2*IMAT                                                    DMEMP      81
      LHD=IIA+N1*IMAT                                                    DMEMP      82
      NB=NAA                                                             DMEMP      83
      LB=LHD+IMAT*20*IHARD+IMAT*20*IYIT+2*IMAT-IT                        DMEMP      84
      DO 30 I=1,NB                                                       DMEMP      85
      LB=LB+IT                                                           DMEMP      86
   30 LLL(I)=LB                                                          DMEMP      87
      DO 40 I=NB,27                                                      DMEMP      88
   40 LLL(I)=LLL(NB)                                                     DMEMP      89
      NB=IT                                                              DMEMP      90
      LLD=LLL(27)+NB                                                     DMEMP      91
      IPR=LLD+2*LCDP                                                     DMEMP      92
      IDT=IPR+IPRS                                                       DMEMP      93
      ICFI=IDT+ISDT                                                      DMEMP      94
      IXX=ICFI+IMFI                                                      DMEMP      95
      IYY=IXX+IN                                                         DMEMP      96
      IZZ=IYY+IN                                                         DMEMP      97
      IIC=IZZ+IN                                                         DMEMP      98
      IBB=IIC+IND+IBN                                                    DMEMP      99
      IDEF=IBB+IND+IBN                                                   DMEMP     100
      JMMX=IDEF                                                          DMEMP     101
      JMMY=JMMX+IBN                                                      DMEMP     102
      JMMZ=JMMY+IBN                                                      DMEMP     103
      MF=JMMZ+IBN-ITY                                                    DMEMP     104
      IF (MF.GT.0) WRITE(MO,50) MF                                       DMEMP     105
   50 FORMAT(19H 4.  COMMON REQUEST,I6,28H TOO SHORT FOR DBC HANDLING.)  DMEMP     106
      IA(IIS)=JMMZ+IBN                                                   DMEMP     107
      IF (IERR.NE.0) WRITE (MO,60) IERR                                  DMEMP     108
   60 FORMAT (5H 5.  ,I3,37H ERROR(S) IN CONTROL CARD PARAMETERS.)       DMEMP     109
      DO 70 I=LHD,IPR                                                    DMEMP     110
   70 AA(I)=0.                                                           DMEMP     111
      RETURN                                                             DMEMP     112
      END                                                                DMEMP     113
*DECK EXCH
      SUBROUTINE EXCH                                                    EXCH        2
C     INTERCHANGES CONSEQUETIVE ROWS AND COLUMNS OF CONNECTIVITY MATRIX  EXCH        3
CMAP10                                                                   EXCH        4
      COMMON/COMEL/IN                                                    EXCH        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  EXCH        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     EXCH        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       EXCH        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   EXCH        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   EXCH       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   EXCH       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   EXCH       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   EXCH       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   EXCH       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   EXCH       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   EXCH       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   EXCH       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   EXCH       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   EXCH       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   EXCH       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   EXCH       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   EXCH       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   EXCH       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   EXCH       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   EXCH       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   EXCH       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   EXCH       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    EXCH       28
      EQUIVALENCE     (IA(401), S(1))                                    EXCH       29
CEND MAP10                                                               EXCH       30
CMAP30                                                                   EXCH       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              EXCH       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      EXCH       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  EXCH       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  EXCH       35
CEND MAP30                                                               EXCH       36
      IWORD = 32                                                         EXCH       37
      JMI=(MI-1)/IWORD+1                                                 EXCH       38
      JMX=(MX-1)/IWORD+1                                                 EXCH       39
      DO 100 K=JMI,JMX                                                   EXCH       40
      KIK=MBIN+(K-1)*IN+I                                                EXCH       41
      KXK=KIK+1                                                          EXCH       42
      ACH=AA(KIK)                                                        EXCH       43
      AA(KIK)=AA(KXK)                                                    EXCH       44
 100  AA(KXK)=ACH                                                        EXCH       45
      J=(I-1)/IWORD+1                                                    EXCH       46
      JB=I-IWORD*(J-1)                                                   EXCH       47
      JP=(IX-1)/IWORD+1                                                  EXCH       48
      JPB=IX-IWORD*(JP-1)                                                EXCH       49
      IF (J-JP) 150,250,150                                              EXCH       50
  150 DO 200 K=MI,MX                                                     EXCH       51
      KKJ=MBIN+(J-1)*IN+K                                                EXCH       52
      KKP=KKJ+IN                                                         EXCH       53
      ACH=AA(KKJ)                                                        EXCH       54
      BCH=AA(KKP)                                                        EXCH       55
      NCH=LEBIN(ACH,JB)                                                  EXCH       56
      NCT=LEBIN(BCH,JPB)                                                 EXCH       57
      CALL SEBIN (ACH,JB,NCT)                                            EXCH       58
      CALL SEBIN (BCH,JPB,NCH)                                           EXCH       59
      AA(KKJ)=ACH                                                        EXCH       60
 200  AA(KKP)=BCH                                                        EXCH       61
      GO TO 400                                                          EXCH       62
  250 DO 300 K=MI,MX                                                     EXCH       63
      KKJ=MBIN+(J-1)*IN+K                                                EXCH       64
      ACH=AA(KKJ)                                                        EXCH       65
      NCH=LEBIN(ACH,JB)                                                  EXCH       66
      NCT=LEBIN(ACH,JPB)                                                 EXCH       67
      CALL SEBIN (ACH,JB,NCT)                                            EXCH       68
      CALL SEBIN (ACH,JPB,NCH)                                           EXCH       69
 300  AA(KKJ)=ACH                                                        EXCH       70
  400 RETURN                                                             EXCH       71
      END                                                                EXCH       72
*DECK HARDP
      SUBROUTINE HARDP                                                   HARDP       2
C     TO INPUT PLASTICITY INFORMATION WHEN IHARD=0 (NO LONGER USED)      HARDP       3
      RETURN                                                             HARDP       4
      END                                                                HARDP       5
      FUNCTION LEBIN(A,J)                                                HARDP       6
      I = 49 - J                                                         HARDP       7
      IF(I.LT.48) GO TO 20                                               HARDP       8
      K = 4000000000000000B                                              HARDP       9
      GO TO 30                                                           HARDP      10
  20  K = 2**(I-1)                                                       HARDP      11
  30  K = K.AND.A                                                        HARDP      12
      IF(K) 40,50                                                        HARDP      13
  40  LEBIN = 1                                                          HARDP      14
      RETURN                                                             HARDP      15
  50  LEBIN = 0                                                          HARDP      16
      RETURN                                                             HARDP      17
      END                                                                HARDP      18
*DECK MESG
      SUBROUTINE MESG                                                    MESG        2
C                                                                        MESG        3
C     USER SUPPLED SUBROUTINE USED TO GENERATE AND STORE                 MESG        4
C     ELEMENT CONNECTIVITY AND DESCRIPTORS                               MESG        5
C                                                                        MESG        6
C   MEANING OF SYMBOLS%                                                  MESG        7
C                                                                        MESG        8
C     IA      ARRAY(S) IN COMMON,COMEL                                   MESG        9
C     B       PORTION OF COMMON AVAILABLE TO USERS                       MESG       10
C     IT      NUMBER OF ELEMENTS                                         MESG       11
C     J1W     = 100*IMET + JMFI                                          MESG       12
C     J2W     = 100*JPRS                                                 MESG       13
C     IMET    MATERIAL TYPE NUMBER                                       MESG       14
C     JMFI    FIBER ANGLE TYPE NUMBER                                    MESG       15
C     JPRS    PRESSURE LOADING TYPE NUMBER                               MESG       16
C     J3W  THRU J10W   NODE LABELS OF ELEMENT VERTICES 1-8               MESG       17
C     J1   THRU J10    POINTERS FOR J1W-J10W ARRAYS IN COMMON            MESG       18
C                                                                        MESG       19
      COMMON/COMEL/IA(401)                                               MESG       20
      DIMENSION B(50)                                                    MESG       21
      EQUIVALENCE (IA(3),IT),(IA(35),J1),(IA(36),J2),(IA(37),J3),        MESG       22
     1(IA(38),J4),(IA(39),J5),(IA(40),J6),(IA(41),J7),(IA(42),J8),       MESG       23
     2(IA(188),J10),(IA(189),J9),(IA(200),B(1))                          MESG       24
      RETURN                                                             MESG       25
      END                                                                MESG       26
*DECK MEST
      SUBROUTINE MEST                                                    MEST        2
C     READS AND STORES MESH TOPOLOGY DATA                                MEST        3
CMAP10                                                                   MEST        4
      COMMON/COMEL/IN                                                    MEST        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  MEST        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     MEST        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       MEST        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   MEST        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   MEST       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   MEST       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   MEST       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   MEST       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   MEST       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   MEST       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   MEST       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   MEST       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   MEST       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   MEST       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   MEST       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   MEST       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   MEST       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   MEST       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   MEST       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   MEST       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   MEST       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   MEST       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    MEST       28
      EQUIVALENCE     (IA(401), S(1))                                    MEST       29
CEND MAP10                                                               MEST       30
CMAP30                                                                   MEST       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              MEST       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      MEST       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  MEST       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  MEST       35
CEND MAP30                                                               MEST       36
      M=0                                                                MEST       37
      MT=0                                                               MEST       38
      L=0                                                                MEST       39
      NBE=-19                                                            MEST       40
      NFI=0                                                              MEST       41
 7910 L=L+1                                                              MEST       42
 7911 IF (L-NFI)7912,7912,7913                                           MEST       43
 7913 NBE=NBE+20                                                         MEST       44
      NFI=NFI+20                                                         MEST       45
      READ (IO,791)(ITAR1(I),I=NBE,NFI)                                  MEST       46
  791 FORMAT (20I4)                                                      MEST       47
 7912 IF (ITAR1(L)) 7921,7910,7924                                       MEST       48
 7921 IF (L-NFI) 7914,7913,7913                                          MEST       49
 7924 IF (IERR) 300,300,7925                                             MEST       50
 7925 L=L-1                                                              MEST       51
      MT=-1                                                              MEST       52
      IERR=0                                                             MEST       53
 7914 M=M+1                                                              MEST       54
      MT=MT+1                                                            MEST       55
      IF (MT-999) 7916,7915,300                                          MEST       56
 7915 IERR=1                                                             MEST       57
 7916 IF (MT+ITAR1(L)) 300,87,300                                        MEST       58
   87 JK=10                                                              MEST       59
      JN=8                                                               MEST       60
      LC=L                                                               MEST       61
      LJK=LC+JK                                                          MEST       62
      LJKP=LJK+1                                                         MEST       63
      IF (LJK-NFI) 7919,7919,7923                                        MEST       64
 7923 NBE=NBE+20                                                         MEST       65
      NFI=NFI+20                                                         MEST       66
      READ (IO,791)(ITAR1(I),I=NBE,NFI)                                  MEST       67
 7919 GO TO (70,69,68,67,66,65,64,63,62,61),JK                           MEST       68
 61   JM=J10+M                                                           MEST       69
      GO TO 72                                                           MEST       70
   62 JM=J9+M                                                            MEST       71
      GO TO 72                                                           MEST       72
 63   JM=J8+M                                                            MEST       73
      GO TO 72                                                           MEST       74
 64   JM=J7+M                                                            MEST       75
      GO TO 72                                                           MEST       76
 65   JM=J6+M                                                            MEST       77
      GO TO 72                                                           MEST       78
 66   JM=J5+M                                                            MEST       79
      GO TO 72                                                           MEST       80
 67   JM=J4+M                                                            MEST       81
      GO TO 72                                                           MEST       82
 68   JM=J3+M                                                            MEST       83
      GO TO 72                                                           MEST       84
 69   JM=J2+M                                                            MEST       85
      GO TO 72                                                           MEST       86
 70   JM=J1+M                                                            MEST       87
 72   L=L+1                                                              MEST       88
      LJK=LC+JK                                                          MEST       89
      IA(JM)=ITAR1(LJK)                                                  MEST       90
      JK=JK-1                                                            MEST       91
      IF (JK) 78,78,7919                                                 MEST       92
   78 DO 7800 J=1,JN                                                     MEST       93
      JL=LJKP-J                                                          MEST       94
      IF (ITAR1(JL)) 300,300,7800                                        MEST       95
 7800 CONTINUE                                                           MEST       96
      IF (M-IT) 7930,799,300                                             MEST       97
 7930 IF (NFI-20) 7910,7910,7932                                         MEST       98
 7932 NIE=NFI-20                                                         MEST       99
      DO 7940 I=1,20                                                     MEST      100
      II=I+NIE                                                           MEST      101
 7940 ITAR1(I)=ITAR1(II)                                                 MEST      102
      L=L-NIE                                                            MEST      103
      NBE=1                                                              MEST      104
      NFI=20                                                             MEST      105
      GO TO 7910                                                         MEST      106
 799  IERR=0                                                             MEST      107
   79 RETURN                                                             MEST      108
  300 IERR=1                                                             MEST      109
      GO TO 79                                                           MEST      110
      END                                                                MEST      111
*DECK MSTABP
      SUBROUTINE MTABP                                                   MTABP       2
C     TO READ AND TO PRINT THE MATERIAL TABLES                           MTABP       3
CMAP10                                                                   MTABP       4
      COMMON/COMEL/IN                                                    MTABP       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  MTABP       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     MTABP       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       MTABP       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   MTABP       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   MTABP      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   MTABP      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   MTABP      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   MTABP      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   MTABP      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   MTABP      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   MTABP      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   MTABP      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   MTABP      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   MTABP      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   MTABP      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   MTABP      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   MTABP      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   MTABP      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   MTABP      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   MTABP      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   MTABP      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   MTABP      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    MTABP      28
      EQUIVALENCE     (IA(401), S(1))                                    MTABP      29
CEND MAP10                                                               MTABP      30
CMAP20                                                                   MTABP      31
      DIMENSION LLL(27)                                                  MTABP      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   MTABP      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   MTABP      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  MTABP      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  MTABP      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   MTABP      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   MTABP      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   MTABP      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   MTABP      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  MTABP      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   MTABP      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   MTABP      43
CEND MAP20                                                               MTABP      44
      DATA STAR,SCALE,BLANK/1H*,4HSCAL,4H    /                           MTABP      45
      IF (INP-1) 2527,2526,2526                                          MTABP      46
 2526 WRITE (MO,356)                                                     MTABP      47
 356  FORMAT (1H1,19HMATERIAL PROPERTIES)                                MTABP      48
 2527 IF (ITYPE-1)4487,4388,4388                                         MTABP      49
 4487 IF (INP-1) 2501,2502,2502                                          MTABP      50
 2502 WRITE (MO,4486)                                                    MTABP      51
 4486 FORMAT (/2(1X,2HTP,5X,1HE,10X,1HU,8X,5HALPHA,3X)  )                MTABP      52
 2501 L=0                                                                MTABP      53
      LL=0                                                               MTABP      54
      DO 10 I=1,IMAT,6                                                   MTABP      55
      L=L+6                                                              MTABP      56
      IF (L-IMAT) 11,11,12                                               MTABP      57
 12   L=IMAT                                                             MTABP      58
 11   K=L-I+1                                                            MTABP      59
      READ (IO,13) (N(J),X(J),Y(J),Z(J),J=1,K)                           MTABP      60
 13   FORMAT (3(I2,3E8.5))                                               MTABP      61
      DO 14 J=1,K                                                        MTABP      62
      LL=LL+1                                                            MTABP      63
      IF (LL-N(J)) 16,15,16                                              MTABP      64
 16   WRITE (MO,17)LL                                                    MTABP      65
 17   FORMAT(29H 7.  THE MATERIAL IN POSITION,I5,2X,15HHAS WRONG LABEL)  MTABP      66
      IERR=1                                                             MTABP      67
      GO TO 14                                                           MTABP      68
 15   IIAI=IIA+LL                                                        MTABP      69
      IIDI=IID+(LL-1)*2+1                                                MTABP      70
      AA(IIDI)=X(J)                                                      MTABP      71
      AA(IIDI+1)=Y(J)                                                    MTABP      72
      AA(IIAI)=Z(J)                                                      MTABP      73
 14   CONTINUE                                                           MTABP      74
      IF (INP-1) 10,19,19                                                MTABP      75
 19   WRITE (MO,18)(N(J),X(J),Y(J),Z(J),J=1,K)                           MTABP      76
 18   FORMAT (2(I3,3E11.4))                                              MTABP      77
 10   CONTINUE                                                           MTABP      78
      GO TO 6219                                                         MTABP      79
 4388 IF (INP-1) 2504,2505,2505                                          MTABP      80
 2505 WRITE (MO,4386)                                                    MTABP      81
 4386 FORMAT(/3X,2HTP,5X,2HEM,9X,2HUM,9X,2HEF,9X,2HUF,9X,2HVF,7X,        MTABP      82
     12X,3HSFU,8X,3HSFT,7X,6H  EULT)                                     MTABP      83
 2504 DO 20 I=1,IMAT                                                     MTABP      84
      IIDI=IID+6*(I-1)                                                   MTABP      85
      IIAI=IIA+2*(I-1)+1                                                 MTABP      86
      READ(IO,21) N(1),(X(J),J=1,8)                                      MTABP      87
   21 FORMAT(I2,6E10.4,2E9.4)                                            MTABP      88
 23   IF (N(1)-I) 22,25,22                                               MTABP      89
 22   WRITE (MO,17)I                                                     MTABP      90
      IERR=1                                                             MTABP      91
      GO TO 27                                                           MTABP      92
 25   DO 26 J=1,6                                                        MTABP      93
      IIDJ=IIDI+J                                                        MTABP      94
 26   AA(IIDJ)=X(J)                                                      MTABP      95
      AA(IIAI)=X(7)                                                      MTABP      96
      AA(IIAI+1)=X(8)                                                    MTABP      97
 27   IF (INP-1) 20,29,29                                                MTABP      98
 29   WRITE (MO,28) N(1),(X(J),J=1,8)                                    MTABP      99
   28 FORMAT(I5,8E11.4)                                                  MTABP     100
 20   CONTINUE                                                           MTABP     101
 6219 IF(KHARD.EQ.0) GO TO 50                                            MTABP     102
      IF(IHARD.EQ.0) GO TO 52                                            MTABP     103
      JERR=0                                                             MTABP     104
      NB=20*IHARD                                                        MTABP     105
      N1=LHD+IMAT-NB                                                     MTABP     106
      MS=NB*IMAT+IMAT                                                    MTABP     107
      M1=N1+MS                                                           MTABP     108
      DO 40 I=1,IMAT                                                     MTABP     109
      N1=N1+NB                                                           MTABP     110
      N2=N1+10*IHARD                                                     MTABP     111
      READ (IO,41)MAT,MENTR,(AA(N1+K),AA(N2+K),K=1,MENTR)                MTABP     112
   41 FORMAT (2I3/(10E8.5))                                              MTABP     113
      IF(MENTR .LT. 2) JERR=JERR+1                                       MTABP     114
      IA(LHD+I)=MENTR                                                    MTABP     115
      AA(N1+1)=0.                                                        MTABP     116
      IF (MAT.NE.I) JERR=JERR+1                                          MTABP     117
      IF (INP.EQ.0) GO TO 40                                             MTABP     118
      IF(ITYPE.NE.0) GO TO 401                                           MTABP     119
      WRITE (MO,42)MAT,(AA(N1+K),AA(N2+K),K=1,MENTR)                     MTABP     120
   42 FORMAT  (///1X,39HHARDENING INFORMATION FOR MATERIAL TYPE,I4/      MTABP     121
     1           5(4X,9HEFF.P.STN ,1X,9HEFF.STRES)/5(3X,2E10.3))         MTABP     122
      GO TO 40                                                           MTABP     123
  401 WRITE(MO,402) MAT,(AA(N1+K),AA(N2+K),K=1,MENTR)                    MTABP     124
  402 FORMAT(///1X,44HHARDENING INFORMATION FOR MATRIX MATERIAL OF,      MTABP     125
     115H COMPOSITE TYPE,I4/5(4X,9HEFF.P.STN,1X,9HEFF.STRES)/5(3X,2E10.3 MTABP     126
     2))                                                                 MTABP     127
   40 CONTINUE                                                           MTABP     128
      IF(IYIT .EQ. 0) GO TO 44                                           MTABP     129
      DO 49 I=1,IMAT                                                     MTABP     130
C *** NOW READ INTO YIELD TEMPERATURE INFORMATION IF NECESSARY           MTABP     131
      M1=M1+NB                                                           MTABP     132
      M2=M1+10*IYIT                                                      MTABP     133
      READ(IO,41) MAT,MENTR,(AA(M1+K),AA(M2+K),K=1,MENTR)                MTABP     134
      IF(MENTR .LT. 2) JERR=JERR+1                                       MTABP     135
      IA(LHD+I+MS)=MENTR                                                 MTABP     136
      IF(MAT .NE.I) JERR=JERR+1                                          MTABP     137
      IF(INP .EQ. 0) GO TO 49                                            MTABP     138
      IF(ITYPE.NE.0) GO TO 406                                           MTABP     139
      WRITE(MO,46) MAT,(AA(M1+K),AA(M2+K),K=1,MENTR)                     MTABP     140
 46   FORMAT(///1X,67HTEMP. VS. NONDIMENSIONAL YIELD STRESS INFORMATION  MTABP     141
     1FOR MATERIAL TYPE,I4/5(4X,9HTEMP.     ,1X,9HYLD. STRS)/            MTABP     142
     25(3X,2E10.3))                                                      MTABP     143
      GO TO 49                                                           MTABP     144
  406 WRITE(MO,416) MAT,(AA(M1+K),AA(M2+K),K=1,MENTR)                    MTABP     145
  416 FORMAT(///1X,87HTEMP. VS. NONDIMENSIONAL YIELD STRESS INFORMATION  MTABP     146
     1FOR MATRIX MATERIAL OF COMPOSITE TYPE,I4/                          MTABP     147
     25(4X,9HTEMP.    ,1X,9HYLD. STRS)/5(3X,2E10.3))                     MTABP     148
 49   CONTINUE                                                           MTABP     149
 44   IF (JERR.NE.0) WRITE(MO,43) JERR                                   MTABP     150
   43 FORMAT (5H 8.  ,I3,41H ERRORS IN MATERIAL HARDENING INFORMATION)   MTABP     151
      IERR=IERR+JERR                                                     MTABP     152
      GO TO 60                                                           MTABP     153
   50 WRITE(MO,51)                                                       MTABP     154
   51 FORMAT(///1X,79HHARDENING INFORMATION % MATRIX MATERIAL OF ALL COM MTABP     155
     1POSITE TYPES IS NON-HARDENING)                                     MTABP     156
      GO TO 60                                                           MTABP     157
   52 CALL HARDP                                                         MTABP     158
      ENTRY RTABP                                                        MTABP     159
   60 KK=LCDP                                                            MTABP     160
      IF (LCDP.GT.25) KK=25                                              MTABP     161
      READ (IO,62) (IA(LLD+K),AA(LLD+KK+K),K=1,KK)                       MTABP     162
   62 FORMAT(8(I3,E7.5))                                                 MTABP     163
      IF (LCDP.LE.25) GO TO 65                                           MTABP     164
      K1=KK+1                                                            MTABP     165
      READ (IO,62) (N1,C,K=K1,LCDP)                                      MTABP     166
      LCDP=25                                                            MTABP     167
      WRITE (MO,63)                                                      MTABP     168
   63 FORMAT(59H 6.  THE FIRST 25 DATA POINTS ARE CONSIDERED FOR LOAD CU MTABP     169
     1RVE)                                                               MTABP     170
 65   W1=STAR                                                            MTABP     171
      W2=SCALE                                                           MTABP     172
      SW1=STAR                                                           MTABP     173
      SW2=SCALE                                                          MTABP     174
      AA26=AA(LLD+KK+1)                                                  MTABP     175
      IF(IA(LLD+1) .EQ.1) GO TO 73                                       MTABP     176
      WRITE(MO,70)                                                       MTABP     177
 70   FORMAT (/////20H LOADING INFORMATION,/                             MTABP     178
     1,1X,51HSCAL%MULTIPLIER OF INPUT LOADS FOR INITIAL YIELDING,/       MTABP     179
     2,1X,54HLOAD FACTOR%MULTIPLIER OF INPUT LOADS FOR CURRENT LOAD,/    MTABP     180
     3,1X,4HSTEP,4X,11HLOAD FACTOR)                                      MTABP     181
      IF(ISCAL) 72,71,72                                                 MTABP     182
 73   WRITE(MO,74) AA26                                                  MTABP     183
 74   FORMAT (/////20H LOADING INFORMATION,/                             MTABP     184
     1,1X,51HSCAL%MULTIPLIER OF INPUT LOADS FOR INITIAL YIELDING,/       MTABP     185
     2,1X,54HLOAD FACTOR%MULTIPLIER OF INPUT LOADS FOR CURRENT LOAD,/    MTABP     186
     3,1X,15HFIRST ORDINATE=,F4.1/                                       MTABP     187
     41X,*STEP*,4X,*LOAD FACTOR*)                                        MTABP     188
      AA26=1.                                                            MTABP     189
      IF(AA(LLD+KK+1).EQ.0.) GO TO 75                                    MTABP     190
      GO TO 72                                                           MTABP     191
 71   SW1=BLANK                                                          MTABP     192
      SW2=BLANK                                                          MTABP     193
 75   W1=BLANK                                                           MTABP     194
      W2=BLANK                                                           MTABP     195
 72   WRITE(MO,67) IA(LLD+1),AA26,SW1,SW2                                MTABP     196
 67   FORMAT(1X,I4,4X,1PE10.3,A1,A4)                                     MTABP     197
      IF (KK.LE.1) RETURN                                                MTABP     198
      WRITE (MO,67)(IA(LLD+K),AA(LLD+KK+K),W1,W2,K=2,KK)                 MTABP     199
      RETURN                                                             MTABP     200
      END                                                                MTABP     201
*DECK NASM
      SUBROUTINE NASM                                                    NASM        2
C     TO COMPUTE ASSEMBLY CONSTANTS                                      NASM        3
CMAP10                                                                   NASM        4
      COMMON/COMEL/IN                                                    NASM        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  NASM        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     NASM        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       NASM        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   NASM        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   NASM       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   NASM       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   NASM       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   NASM       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   NASM       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   NASM       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   NASM       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   NASM       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   NASM       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   NASM       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   NASM       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   NASM       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   NASM       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   NASM       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   NASM       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   NASM       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   NASM       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   NASM       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    NASM       28
      EQUIVALENCE     (IA(401), S(1))                                    NASM       29
CEND MAP10                                                               NASM       30
CMAP30                                                                   NASM       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              NASM       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      NASM       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  NASM       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  NASM       35
CEND MAP30                                                               NASM       36
      IND=3*IN                                                           NASM       37
      IDEG=3                                                             NASM       38
C     REPLACE THE ENTRIES OF IBB VECTOR WITH REDUCED LABELS.             NASM       39
C     SET II FOR THE FIRST UNKNOWN                                       NASM       40
      II=1                                                               NASM       41
C     PROCESS THE DIRECTIONS SEQUENTIALLY.                               NASM       42
      IND2=IND+2                                                         NASM       43
      DO 100 I=1,IN                                                      NASM       44
C     OBTAIN THE BETTER NODE LABEL                                       NASM       45
      KZ=MSIR+I                                                          NASM       46
      K=IA(KZ)                                                           NASM       47
C     PROCESS DEGREE OF FREEDOM DIRECTIONS OF THE NODE.                  NASM       48
      KI=(K-1)*IDEG                                                      NASM       49
      DO 10 J=1,IDEG                                                     NASM       50
      KI=KI+1                                                            NASM       51
C     SEE IF KI TH DIRECTION IS CONNECTED OR NOT.                        NASM       52
      KJ=IBB+KI                                                          NASM       53
      IF (IA(KJ)) 10,10,40                                               NASM       54
 40   IF (IA(KJ)-IND2) 10,60,60                                          NASM       55
C     UNCONNECTED AND RETAINED. ASSIGN II AS ITS REDUCED LABEL.          NASM       56
 60   IA(KJ)=II                                                          NASM       57
C     AUGMENT THE UNKNOWN COUNT, AND GO TO NEXT DIRECTION.               NASM       58
      II=II+1                                                            NASM       59
 10   CONTINUE                                                           NASM       60
 100  CONTINUE                                                           NASM       61
C     SET THE ORDER OF THE SYSTEM                                        NASM       62
      ISUM=II-1                                                          NASM       63
C     PROCESS THE NEGATIVE ENTRIES OF IBB VECTOR OF ORDER IBO.           NASM       64
      DO 200 I=1,IBO                                                     NASM       65
      KI=IBB+I                                                           NASM       66
      KJ=IA(KI)                                                          NASM       67
C     SEE IF THIS ENTRY IS NEGATIVE.                                     NASM       68
      IF (KJ) 110,150,200                                                NASM       69
C     ZERO ENTRY MEANS MULTIPLE CONNECTIVITY.                            NASM       70
C     FIND MULTIPLICITY AND POINTER IN JJ AND MEND, RESPECTIVELY.        NASM       71
 150  KS=KI-IBB+IIC                                                      NASM       72
      JJ=IA(KS)/100000                                                   NASM       73
      MEND=IA(KS)-100000*JJ                                              NASM       74
C     REPLACE THE NEGATIVE ENTRIES.                                      NASM       75
      KS=IBB+IND+MEND                                                    NASM       76
      DO 151 K=1,JJ                                                      NASM       77
      KS=KS+1                                                            NASM       78
      KJ=-IA(KS)                                                         NASM       79
      IF (KJ-IND) 152,152,153                                            NASM       80
 153  IA(KS)=KJ                                                          NASM       81
      GO TO 151                                                          NASM       82
 152  KL=IBB+KJ                                                          NASM       83
      IA(KS)=IA(KL)                                                      NASM       84
 151  CONTINUE                                                           NASM       85
      GO TO 200                                                          NASM       86
C     SINGLE CONNECTIVITY.                                               NASM       87
 110  KJ=-KJ                                                             NASM       88
      IF (KJ-IND) 111,111,112                                            NASM       89
 112  IA(KI)=KJ                                                          NASM       90
      GO TO 200                                                          NASM       91
 111  KL=IBB+KJ                                                          NASM       92
      IA(KI)=IA(KL)                                                      NASM       93
 200  CONTINUE                                                           NASM       94
      IF (INP.NE.2) GO TO 300                                            NASM       95
      WRITE(MO,2100)                                                     NASM       96
 2100 FORMAT (1H1,35HIBB AND IIC VECTORS IN REDUCED FORM//               NASM       97
     14(3X,2HNO,2X,3HIBB,3X,3HIIC,2X))                                   NASM       98
      DO 2101 I=1,IBO,4                                                  NASM       99
      J=IBB+I                                                            NASM      100
      K=IIC+I                                                            NASM      101
      I1=I+1                                                             NASM      102
      I2=I+2                                                             NASM      103
      I3=I+3                                                             NASM      104
      WRITE (MO,2102)(I,IA(J),AA(K),I1,IA(J+1),AA(K+1),I2,IA(J+2),       NASM      105
     1AA(K+2),I3,IA(J+3),AA(K+3))                                        NASM      106
 2102 FORMAT (4(2I5,F6.3,2X))                                            NASM      107
 2101 CONTINUE                                                           NASM      108
 300  RETURN                                                             NASM      109
      END                                                                NASM      110
*DECK NBON
      SUBROUTINE NBON                                                    NBON        2
C     READ, ORDER, OUTPUT, AND STORE DBC INPUT UNITS                     NBON        3
CMAP10                                                                   NBON        4
      COMMON/COMEL/IN                                                    NBON        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  NBON        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     NBON        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       NBON        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   NBON        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   NBON       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   NBON       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   NBON       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   NBON       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   NBON       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   NBON       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   NBON       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   NBON       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   NBON       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   NBON       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   NBON       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   NBON       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   NBON       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   NBON       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   NBON       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   NBON       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   NBON       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   NBON       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    NBON       28
      EQUIVALENCE     (IA(401), S(1))                                    NBON       29
CEND MAP10                                                               NBON       30
CMAP30                                                                   NBON       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              NBON       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      NBON       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  NBON       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  NBON       35
CEND MAP30                                                               NBON       36
      IND=3*IN                                                           NBON       37
      IDEG=3                                                             NBON       38
      MEND=0                                                             NBON       39
      IND1=IND+1                                                         NBON       40
      IND2=IND+2                                                         NBON       41
C     PREPARE VECTORS NECESSARY FOR IMPOSING BOUNDARY CONDITIONS         NBON       42
      K=IND+IBN                                                          NBON       43
      DO 6 I=1,K                                                         NBON       44
      IBBI=IBB+I                                                         NBON       45
      IICI=IIC+I                                                         NBON       46
      IA(IBBI)=IND2                                                      NBON       47
 6    AA(IICI)=1.                                                        NBON       48
C     REDEFINE JMMX,JMMY,JMMZ AS IN SUBROUTINE DMEM                      NBON       49
      JMMX=IDEF                                                          NBON       50
      JMMY=JMMX+IBN                                                      NBON       51
      JMMZ=JMMY+IBN                                                      NBON       52
      IF (IBN) 2999,2999,3                                               NBON       53
C     READ IN DBC INPUT UNITS                                            NBON       54
 3    IF (IBUN) 4,5,4                                                    NBON       55
 4    CALL BUNG                                                          NBON       56
      GO TO 30                                                           NBON       57
 5    JF=JMMX                                                            NBON       58
      JS=JMMY                                                            NBON       59
      JC=JMMZ                                                            NBON       60
      NN=1                                                               NBON       61
      DO 25 I=1,IBN,5                                                    NBON       62
      READ (IO,21)(ITAR1(J),ITAR2(J),X(J),J=1,5)                         NBON       63
 21   FORMAT (5(2I5,F6.5))                                               NBON       64
      DO 24 J=1,5                                                        NBON       65
      JF=JF+1                                                            NBON       66
      JS=JS+1                                                            NBON       67
      JC=JC+1                                                            NBON       68
      IA(JF)=ITAR1(J)                                                    NBON       69
      IA(JS)=ITAR2(J)                                                    NBON       70
      AA(JC)=X(J)                                                        NBON       71
      IF (NN-IBN) 23,30,30                                               NBON       72
 23   NN=NN+1                                                            NBON       73
 24   CONTINUE                                                           NBON       74
 25   CONTINUE                                                           NBON       75
C     CHECK DBC UNITS FOR VALIDITY                                       NBON       76
C     REPLACE INDEX PAIRS WITH DEGREE OF FREEDOM COUNTS                  NBON       77
 30   DO 20 I=1,IBN                                                      NBON       78
      JF=JMMX+I                                                          NBON       79
      NODE=IA(JF)/10                                                     NBON       80
      NDIR=IA(JF)-10*NODE                                                NBON       81
      IF (IA(JF)) 501,501,11                                             NBON       82
 11   IF (NDIR-IDEG) 12,12,501                                           NBON       83
 12   IF (NDIR) 501,501,13                                               NBON       84
 13   IA(JF)=(NODE-1)*IDEG+NDIR                                          NBON       85
      JS=JMMY+I                                                          NBON       86
      IF (IA(JS)) 501,501,15                                             NBON       87
 15   NODE=IA(JS)/10                                                     NBON       88
      NDIR=IA(JS)-10*NODE                                                NBON       89
      IF (NDIR-IDEG) 16,16,501                                           NBON       90
 16   IF (NDIR) 501,501,17                                               NBON       91
 17   IA(JS)=(NODE-1)*IDEG+NDIR                                          NBON       92
      GO TO 20                                                           NBON       93
 501  WRITE (MO,18)I                                                     NBON       94
 18   FORMAT (1X,21H9.  IN DBC INPUT UNIT,I5,2X,                         NBON       95
     147HEITHER NODE OR DIRECTION OR BOTH NOT ACCEPTABLE)                NBON       96
      IERR=1                                                             NBON       97
 20   CONTINUE                                                           NBON       98
C     SORT DBC INPUT UNIT WITH RESPECT TO THE FIRST INDEX PAIR           NBON       99
C     SORT IF IBN IS LARGER THAN ONE.                                    NBON      100
      IF (IBN-1) 100,110,110                                             NBON      101
 110  DO 120 I=2,IBN                                                     NBON      102
      IF = JMMX+I                                                        NBON      103
      IF1= IF-1                                                          NBON      104
      IF (IA(IF)-IA(IF1)) 111,120,120                                    NBON      105
 111  DO 115 J=2,I                                                       NBON      106
      JF=IF-J+2                                                          NBON      107
      JF1=JF-1                                                           NBON      108
      IF (IA(JF)-IA(JF1)) 112,115,115                                    NBON      109
 112  K=IA(JF1)                                                          NBON      110
      IA(JF1)=IA(JF)                                                     NBON      111
      IA(JF)=K                                                           NBON      112
      KI=JF-JMMX+JMMY                                                    NBON      113
      KI1=KI-1                                                           NBON      114
      K=IA(KI1)                                                          NBON      115
      IA(KI1)=IA(KI)                                                     NBON      116
      IA(KI)=K                                                           NBON      117
      KI=JF-JMMX+JMMZ                                                    NBON      118
      KI1=KI-1                                                           NBON      119
      C=AA(KI1)                                                          NBON      120
      AA(KI1)=AA(KI)                                                     NBON      121
      AA(KI)=C                                                           NBON      122
 115  CONTINUE                                                           NBON      123
 120  CONTINUE                                                           NBON      124
C     CHECK IF ANY OF THE SECOND INDEX PAIRS APPEARS AMONG THE FIRST.    NBON      125
 100  DO 140 I=1,IBN                                                     NBON      126
      KI=JMMY+I                                                          NBON      127
      DO 130 J=1,IBN                                                     NBON      128
      KJ=JMMX+J                                                          NBON      129
      IF (IA(KJ)-IA(KI)) 130,131,130                                     NBON      130
 131  IF (I-J) 502,132,502                                               NBON      131
 132  IA(KI)=IND1                                                        NBON      132
      GO TO 130                                                          NBON      133
 502  NODE=1+(IA(KJ)-1)/IDEG                                             NBON      134
      NDIR=IA(KJ)-(NODE-1)*IDEG                                          NBON      135
      WRITE (MO,503)NODE,NDIR                                            NBON      136
 503  FORMAT (1X,9H10.  NODE,I5,2X,4HDIR.,I3,2X,12HIS ILLEGALLY,         NBON      137
     137H REFERENCED AS 1ST AND 2ND INDEX PAIR)                          NBON      138
      IERR=1                                                             NBON      139
 130  CONTINUE                                                           NBON      140
 140  CONTINUE                                                           NBON      141
C     MODIFY IBB AND IIC VECTORS BY DBC INPUT UNITS                      NBON      142
      I=1                                                                NBON      143
      IF (IBN) 999,999,217                                               NBON      144
 217  KF=JMMX                                                            NBON      145
 212  KF=KF+1                                                            NBON      146
      KS=KF+1                                                            NBON      147
C     SEE IF MULTIPLE CONNECTIVITY                                       NBON      148
      IF (IA(KF)-IA(KS)) 211,220,211                                     NBON      149
C     SINGLE CONNECTIVITY. MODIFY IBB AND IIC VECTORS AT ROW IA(KF)      NBON      150
 211  KI=IA(KF)+IBB                                                      NBON      151
      KJ=KF-JMMX+JMMY                                                    NBON      152
      IA(KI)=-IA(KJ)                                                     NBON      153
      KI=KI-IBB+IIC                                                      NBON      154
      KJ=KF-JMMX+JMMZ                                                    NBON      155
      AA(KI)=AA(KJ)                                                      NBON      156
      I=I+1                                                              NBON      157
C     SEE IF THERE IS ANY UNPROCESSED DBC INPUT UNIT.                    NBON      158
 216  IF (I-IBN) 212,212,999                                             NBON      159
C     MULTIPLE CONNECTIVITY.  OBTAIN THE NUMBER OF MULTIPLICITY IN J.    NBON      160
 220  J=2                                                                NBON      161
 214  KS=KS+1                                                            NBON      162
      IF (IA(KF)-IA(KS)) 225,213,225                                     NBON      163
 213  J=J+1                                                              NBON      164
      GO TO 214                                                          NBON      165
C     SET IBB TO ZERO AND IIC TO 100000*J+MEND AT ROW IA(KF).            NBON      166
 225  K=100000*J+MEND                                                    NBON      167
      KI=IA(KF)+IBB                                                      NBON      168
      IA(KI)=0                                                           NBON      169
      KI=KI-IBB+IIC                                                      NBON      170
      IA(KI)=K                                                           NBON      171
C     STORE THE IMPLICATIONS OF MULTIPLE DBC*S WITH POINTER MEND.        NBON      172
      KI=IBB+IND+MEND                                                    NBON      173
      KF=KF-1                                                            NBON      174
      DO 215 K=1,J                                                       NBON      175
      KI=KI+1                                                            NBON      176
      KF=KF+1                                                            NBON      177
      KJ=KI-IBB+IIC                                                      NBON      178
      KS=KF-JMMX+JMMY                                                    NBON      179
      KC=KF-JMMX+JMMZ                                                    NBON      180
      IA(KI)=-IA(KS)                                                     NBON      181
      AA(KJ)=AA(KC)                                                      NBON      182
      I=I+1                                                              NBON      183
      IF (I-IBN) 215,215,298                                             NBON      184
 215  CONTINUE                                                           NBON      185
C     UPDATE THE RELATIVE POINTER MEND                                   NBON      186
      MEND=MEND+J                                                        NBON      187
C     GO TO NEXT DBC INPUT UNIT.                                         NBON      188
      GO TO 212                                                          NBON      189
C     ALL DBC INPUT UNITS ARE PROCESSED.                                 NBON      190
C     UPDATE THE ORDER OF IBB AND IIC VECTORS IN IBO                     NBON      191
 999  IBO=IND+MEND                                                       NBON      192
C     RELOCATE IBB VECTOR                                                NBON      193
      KB=MEND-IBN                                                        NBON      194
      IF (KB) 301,303,302                                                NBON      195
 302  WRITE (MO,304)                                                     NBON      196
 304  FORMAT (1X,35H11.  ERROR IN RELOCATING IBB VECTOR)                 NBON      197
      GO TO 303                                                          NBON      198
 301  DO 300 I=1,IBO                                                     NBON      199
      K1=IBB+I                                                           NBON      200
      K2=K1+KB                                                           NBON      201
 300  IA(K2)=IA(K1)                                                      NBON      202
C     RESET POINTERS IBB AND IDEF                                        NBON      203
 303  IBB=IIC+IND+MEND                                                   NBON      204
      IDEF=IBB+IND+MEND                                                  NBON      205
      GO TO 1999                                                         NBON      206
 298  MEND =MEND+K                                                       NBON      207
      GO TO 999                                                          NBON      208
C     PRINT OUT SORTED DBC INPUT UNITS, IF NECESSARY.                    NBON      209
 1999 IF (INP.NE.2) GO TO 2999                                           NBON      210
      WRITE (MO,2001)                                                    NBON      211
 2001 FORMAT (1H1,37HSORTED DEFLECTION BOUNDARY CONDITIONS//             NBON      212
     12(3X,2HNO,2X,8H1ST PAIR,1X,8H2ND PAIR,2X,8HCONSTANT,2X))           NBON      213
      DO 2002 I=1,IBN,2                                                  NBON      214
      KI=JMMX+I                                                          NBON      215
      KJ=JMMY+I                                                          NBON      216
      KC=JMMZ+I                                                          NBON      217
      NOD1=1+(IA(KI)-1)/IDEG                                             NBON      218
      IDR1=IA(KI)-(NOD1-1)*IDEG                                          NBON      219
      NOD2=1+(IA(KJ)-1)/IDEG                                             NBON      220
      IDR2=IA(KJ)-(NOD2-1)*IDEG                                          NBON      221
      C1=AA(KC)                                                          NBON      222
      IF (NOD2-IN) 2003,2003,2004                                        NBON      223
 2004 NOD2=NOD1                                                          NBON      224
      IDR2=IDR1                                                          NBON      225
 2003 IF (I-IBN) 2005,2006,2006                                          NBON      226
 2005 KI=KI+1                                                            NBON      227
      KJ=KJ+1                                                            NBON      228
      KC=KC+1                                                            NBON      229
      I1=I+1                                                             NBON      230
      NOD3=1+(IA(KI)-1)/IDEG                                             NBON      231
      IDR3=IA(KI)-(NOD3-1)*IDEG                                          NBON      232
      NOD4=1+(IA(KJ)-1)/IDEG                                             NBON      233
      IDR4=IA(KJ)-(NOD4-1)*IDEG                                          NBON      234
      C2=AA(KC)                                                          NBON      235
      IF (NOD4-IN) 2008,2008,2007                                        NBON      236
 2007 NOD4=NOD3                                                          NBON      237
      IDR4=IDR3                                                          NBON      238
      GO TO 2008                                                         NBON      239
 2006 I1=0                                                               NBON      240
      NOD3=0                                                             NBON      241
      NOD4=0                                                             NBON      242
      IDR3=0                                                             NBON      243
      IDR4=0                                                             NBON      244
      C2=0                                                               NBON      245
 2008 WRITE (MO,2009)I,NOD1,IDR1,NOD2,IDR2,C1,I1,NOD3,IDR3,NOD4,         NBON      246
     1IDR4,C2                                                            NBON      247
 2009 FORMAT(2(I5,I6,I2,I7,I2,E14.4))                                    NBON      248
 2002 CONTINUE                                                           NBON      249
      IF (INP.NE.2) GO TO 2999                                           NBON      250
      WRITE (MO,2100)                                                    NBON      251
 2100 FORMAT (1H1,37HIBB AND IIC VECTORS IN UNREDUCED FORM//             NBON      252
     14(3X,2HNO,2X,3HIBB,3X,3HIIC,2X))                                   NBON      253
      DO 2101 I=1,IBO,4                                                  NBON      254
      J=IBB+I                                                            NBON      255
      K=IIC+I                                                            NBON      256
      I1=I+1                                                             NBON      257
      I2=I+2                                                             NBON      258
      I3=I+3                                                             NBON      259
      WRITE (MO,2102)(I,IA(J),AA(K),I1,IA(J+1),AA(K+1),I2,IA(J+2),       NBON      260
     1AA(K+2),I3,IA(J+3),AA(K+3))                                        NBON      261
 2102 FORMAT (4(2I5,F6.3,2X))                                            NBON      262
 2101 CONTINUE                                                           NBON      263
 2999 RETURN                                                             NBON      264
      END                                                                NBON      265
*DECK NCOR
      SUBROUTINE NCOR                                                    NCOR        2
C     TO READ IN AND PRINT OUT NODAL COORDINATES                         NCOR        3
CMAP10                                                                   NCOR        4
      COMMON/COMEL/IN                                                    NCOR        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  NCOR        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     NCOR        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       NCOR        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   NCOR        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   NCOR       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   NCOR       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   NCOR       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   NCOR       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   NCOR       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   NCOR       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   NCOR       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   NCOR       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   NCOR       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   NCOR       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   NCOR       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   NCOR       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   NCOR       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   NCOR       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   NCOR       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   NCOR       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   NCOR       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   NCOR       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    NCOR       28
      EQUIVALENCE     (IA(401), S(1))                                    NCOR       29
CEND MAP10                                                               NCOR       30
      IF (ICOR) 8311,831,8311                                            NCOR       31
 8311 CALL CORG                                                          NCOR       32
      GO TO 5810                                                         NCOR       33
  831 CALL COOR                                                          NCOR       34
 5810 IF (INP-1) 5850,2519,2519                                          NCOR       35
 2519 WRITE (MO,10)                                                      NCOR       36
 10   FORMAT(1H1,17HNODAL COORDINATES////                                NCOR       37
     11X,*NODE*,5X,1HX,14X,1HY,14X,1HZ  )                                NCOR       38
      DO 20 I=1,IN                                                       NCOR       39
      IXXI=IXX+I                                                         NCOR       40
      IYYI=IYY+I                                                         NCOR       41
      IZZI=IZZ+I                                                         NCOR       42
      X(1)=AA(IXXI)                                                      NCOR       43
      X(2)=AA(IYYI)                                                      NCOR       44
      X(3)=AA(IZZI)                                                      NCOR       45
      WRITE (MO,24) I,X(1),X(2),X(3)                                     NCOR       46
 24   FORMAT (I5,3E15.5)                                                 NCOR       47
 20   CONTINUE                                                           NCOR       48
 5850 RETURN                                                             NCOR       49
      END                                                                NCOR       50
*DECK NLOD
      SUBROUTINE NLOD                                                    NLOD        2
C     READ, PRINT OUT, AND STORE CONCENTRATED LOAD INPUT UNITS.          NLOD        3
CMAP10                                                                   NLOD        4
      COMMON/COMEL/IN                                                    NLOD        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  NLOD        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     NLOD        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       NLOD        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   NLOD        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   NLOD       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   NLOD       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   NLOD       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   NLOD       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   NLOD       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   NLOD       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   NLOD       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   NLOD       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   NLOD       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   NLOD       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   NLOD       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   NLOD       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   NLOD       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   NLOD       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   NLOD       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   NLOD       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   NLOD       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   NLOD       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    NLOD       28
      EQUIVALENCE     (IA(401), S(1))                                    NLOD       29
CEND MAP10                                                               NLOD       30
CMAP30                                                                   NLOD       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              NLOD       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      NLOD       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  NLOD       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  NLOD       35
CEND MAP30                                                               NLOD       36
      IND=3*IN                                                           NLOD       37
      IDEG=3                                                             NLOD       38
      IND1=IND+1                                                         NLOD       39
      DO 2310 I=1,IND1                                                   NLOD       40
      IDEFI=IDEF+I                                                       NLOD       41
 2310 AA(IDEFI)=0.0                                                      NLOD       42
      IF (IP) 300,500,1                                                  NLOD       43
C     READ, CHECK, AND PRINT OUT CONCENTRATED LOAD INPUT UNITS.          NLOD       44
    1 IF (INP.EQ.0) GO TO 13                                             NLOD       45
      WRITE (MO,2)                                                       NLOD       46
 2    FORMAT(1H1,51HLIST OF CONCENTRATED LOADS (OR CONCENTRATED MASSES)/ NLOD       47
     13(4X,5HINDEX,4X,5HVALUE,4X)  )                                     NLOD       48
 13   DO 90 I=1,IP,5                                                     NLOD       49
      KJ=5                                                               NLOD       50
      IF (I+KJ-1-IP) 3,3,4                                               NLOD       51
 4    KJ=IP-I+1                                                          NLOD       52
 3    READ (IO,121)(ITAR1(J),ITAR2(J),X(J),J=1,KJ)                       NLOD       53
 121  FORMAT (5(I4,I1,E11.5))                                            NLOD       54
      DO 5 J=1,KJ                                                        NLOD       55
      N(J)=I+J-1                                                         NLOD       56
      IF (ITAR1(J)) 501,501,6                                            NLOD       57
 6    IF (ITAR1(J)-IN) 7,7,501                                           NLOD       58
 7    IF (ITAR2(J)) 501,501,8                                            NLOD       59
 8    IF (ITAR2(J)-IDEG) 5,5,501                                         NLOD       60
 501  WRITE (MO,502)N(J)                                                 NLOD       61
 502  FORMAT (1X,42H12.  ERROR IN CONCENTRATED LOAD INPUT UNIT,I5)       NLOD       62
      IERR=1                                                             NLOD       63
 5    CONTINUE                                                           NLOD       64
      IF (INP-1) 10,11,11                                                NLOD       65
 11   WRITE (MO,9) (ITAR1(J),ITAR2(J),X(J),J=1,KJ)                       NLOD       66
 9    FORMAT (3(I7,I2,E13.4))                                            NLOD       67
C     ASSEMBLE CONCENTRATED LOADS                                        NLOD       68
 10   DO 15 J=1,KJ                                                       NLOD       69
      NODE=ITAR1(J)                                                      NLOD       70
      IDIR=ITAR2(J)                                                      NLOD       71
      KI=(NODE-1)*IDEG+IDIR+IBB                                          NLOD       72
      KS=IA(KI)                                                          NLOD       73
      IF(KS) 15,50,16                                                    NLOD       74
C     SINGLE CONNECTION                                                  NLOD       75
 16   IDEFI=IDEF+KS                                                      NLOD       76
      KC=KI-IBB+IIC                                                      NLOD       77
      AA(IDEFI)=AA(IDEFI)+AA(KC)*X(J)                                    NLOD       78
      GO TO 15                                                           NLOD       79
C     MULTIPLE CONNECTION.                                               NLOD       80
C     FIND MULTIPLICITY AND POINTER IN JJ AND MEND, RESPECTIVELY.        NLOD       81
 50   KI=KI-IBB+IIC                                                      NLOD       82
      JJ=IA(KI)/100000                                                   NLOD       83
      MEND=IA(KI)-100000*JJ                                              NLOD       84
C     PROCESS EACH CONNECTION.                                           NLOD       85
      KI=IBB+IND+MEND                                                    NLOD       86
      DO 60 K=1,JJ                                                       NLOD       87
      KS=KI+K                                                            NLOD       88
      KK=IA(KS)                                                          NLOD       89
      IDEFI=IDEF+KK                                                      NLOD       90
      KC=KS-IBB+IIC                                                      NLOD       91
 60   AA(IDEFI)=AA(IDEFI)+AA(KC)*X(J)                                    NLOD       92
 15   CONTINUE                                                           NLOD       93
 90   CONTINUE                                                           NLOD       94
 500  RETURN                                                             NLOD       95
 300  IERR=1                                                             NLOD       96
      GO TO 500                                                          NLOD       97
      END                                                                NLOD       98
*DECK NMES
      SUBROUTINE NMES                                                    NMES        2
C     TO READ IN AND PRINT OUT THE MESH INFORMATION                      NMES        3
CMAP10                                                                   NMES        4
      COMMON/COMEL/IN                                                    NMES        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  NMES        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     NMES        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       NMES        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   NMES        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   NMES       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   NMES       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   NMES       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   NMES       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   NMES       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   NMES       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   NMES       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   NMES       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   NMES       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   NMES       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   NMES       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   NMES       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   NMES       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   NMES       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   NMES       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   NMES       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   NMES       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   NMES       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    NMES       28
      EQUIVALENCE     (IA(401), S(1))                                    NMES       29
CEND MAP10                                                               NMES       30
      IF (INP.EQ.0) GO TO 7717                                           NMES       31
      WRITE (MO,21)                                                      NMES       32
 21   FORMAT (1H1,18HELEMENT PROPERTIES//20H  NO  N1  N2  N3  N4         NMES       33
     130H  N5  N6  N7  N8  MA  PR  FI  )                                 NMES       34
 7717 IF (IMES) 7908,7909,7908                                           NMES       35
 7908 CALL MESG                                                          NMES       36
      GO TO 79                                                           NMES       37
 7909 CALL MEST                                                          NMES       38
   79 DO 9000 M=1,IT                                                     NMES       39
      CALL TOPO                                                          NMES       40
      IF (INP.EQ.0) GO TO 9000                                           NMES       41
      WRITE (MO,23) M,(N(I),I=1,8),IMET,JPRS,JMFI                        NMES       42
   23 FORMAT(13I4)                                                       NMES       43
 9000 CONTINUE                                                           NMES       44
      RETURN                                                             NMES       45
      END                                                                NMES       46
*DECK OUTPT
      SUBROUTINE OUTPT                                                   OUTPT       2
C     WRITES INFORMATION RELATED WITH RELABELLING                        OUTPT       3
CMAP10                                                                   OUTPT       4
      COMMON/COMEL/IN                                                    OUTPT       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  OUTPT       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     OUTPT       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       OUTPT       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   OUTPT       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   OUTPT      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   OUTPT      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   OUTPT      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   OUTPT      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   OUTPT      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   OUTPT      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   OUTPT      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   OUTPT      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   OUTPT      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   OUTPT      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   OUTPT      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   OUTPT      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   OUTPT      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   OUTPT      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   OUTPT      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   OUTPT      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   OUTPT      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   OUTPT      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    OUTPT      28
      EQUIVALENCE     (IA(401), S(1))                                    OUTPT      29
CEND MAP10                                                               OUTPT      30
CMAP30                                                                   OUTPT      31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              OUTPT      32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      OUTPT      33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  OUTPT      34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  OUTPT      35
CEND MAP30                                                               OUTPT      36
      WRITE (MO,16)                                                      OUTPT      37
   16 FORMAT (1H1,5H  NO.,6H  ISIR,6H  IMIN,6H  IMAX,                    OUTPT      38
     17X,34HCONNECTIVITY MATRIX IN HEXADECIMAL//)                        OUTPT      39
      IKB=1                                                              OUTPT      40
      IKE=10                                                             OUTPT      41
      IKUR=ISUR+2                                                        OUTPT      42
      DO 3 J=1,10                                                        OUTPT      43
      X(J)=0.                                                            OUTPT      44
 3    CONTINUE                                                           OUTPT      45
      IF (ISUR-IKE) 22,21,21                                             OUTPT      46
 22   IKE=ISUR                                                           OUTPT      47
 21   DO 4 I=1,IN                                                        OUTPT      48
      KXS=MSIR+I                                                         OUTPT      49
      KXN=MMIN+I                                                         OUTPT      50
      KXM=MMAX+I                                                         OUTPT      51
      L=0                                                                OUTPT      52
      DO 2 J=IKB,IKE                                                     OUTPT      53
      L=L+1                                                              OUTPT      54
      KX=MBIN+(J-1)*IN+I                                                 OUTPT      55
 2    X(L)=AA(KX)                                                        OUTPT      56
      WRITE (MO,17)I,IA(KXS),IA(KXN),IA(KXM),(X(J),J=1,L)                OUTPT      57
 4    CONTINUE                                                           OUTPT      58
 17   FORMAT(4I6,6X,10Z9)                                                OUTPT      59
 15   IKUR=IKUR-12                                                       OUTPT      60
      IF (IKUR) 120,120,9                                                OUTPT      61
 9    IKB=IKE+1                                                          OUTPT      62
      IKE=IKE+12                                                         OUTPT      63
      IF (ISUR-IKE) 8,10,10                                              OUTPT      64
 8    IKE=ISUR                                                           OUTPT      65
 10   WRITE (MO,11)                                                      OUTPT      66
 11   FORMAT (1H1,5H  NO.,6H  ISIR//)                                    OUTPT      67
      DO 13 J=1,12                                                       OUTPT      68
 13   X(J)=0.                                                            OUTPT      69
      DO 14 I=1,IN                                                       OUTPT      70
      KXS=MSIR+I                                                         OUTPT      71
      L=0                                                                OUTPT      72
      DO 12 J=IKB,IKE                                                    OUTPT      73
      L=L+1                                                              OUTPT      74
      KX=MBIN+(J-1)*IN+I                                                 OUTPT      75
 12   X(L)=AA(KX)                                                        OUTPT      76
      WRITE (MO,18)I,IA(KXS),(X(J),J=1,L)                                OUTPT      77
 14   CONTINUE                                                           OUTPT      78
      GO TO 15                                                           OUTPT      79
 18   FORMAT (2I6,12Z9)                                                  OUTPT      80
  120 RETURN                                                             OUTPT      81
      END                                                                OUTPT      82
*DECK PTAB
      SUBROUTINE PTAB(KIK)                                               PTAB        2
C     TO READ IN AND TO PRINT OUT PHYSICAL PROPERTY TABLES               PTAB        3
CMAP10                                                                   PTAB        4
      COMMON/COMEL/IN                                                    PTAB        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PTAB        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PTAB        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       PTAB        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PTAB        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PTAB       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PTAB       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PTAB       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PTAB       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PTAB       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PTAB       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PTAB       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PTAB       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PTAB       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PTAB       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PTAB       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PTAB       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PTAB       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PTAB       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PTAB       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PTAB       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PTAB       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PTAB       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PTAB       28
      EQUIVALENCE     (IA(401), S(1))                                    PTAB       29
CEND MAP10                                                               PTAB       30
CMAP30                                                                   PTAB       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              PTAB       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      PTAB       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  PTAB       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  PTAB       35
CEND MAP30                                                               PTAB       36
      DIMENSION DAT(8)                                                   PTAB       37
C     PREPARE FOR THE TABLES                                             PTAB       38
      DATA DAT/10HPRESSURE T,10HYPES      ,10HTEMPERATUR,10HE INCREASE,  PTAB       39
     110H TYPES    ,10HFIBER ORIE,10HNTATION TY,10HPES       /           PTAB       40
      IF(KIK.GT.2) GO TO 20                                              PTAB       41
C     PRESSURES                                                          PTAB       42
      IF (IPRS) 20,20,10                                                 PTAB       43
   10 JMMX=1                                                             PTAB       44
      JMMY=2                                                             PTAB       45
      JMMZ=IPRS                                                          PTAB       46
      JMFI=IPR                                                           PTAB       47
      CALL TOOL(DAT)                                                     PTAB       48
   20 IF(KIK.EQ.2) GO TO 40                                              PTAB       49
C     TEMPERATURE INCREASES                                              PTAB       50
      IF(ISDT) 40,40,30                                                  PTAB       51
   30 JMMX=3                                                             PTAB       52
      JMMY=5                                                             PTAB       53
      JMMZ=ISDT                                                          PTAB       54
      JMFI=IDT                                                           PTAB       55
      CALL TOOL(DAT)                                                     PTAB       56
   40 IF(KIK.NE.1) GO TO 60                                              PTAB       57
C     FIBER ANGLES                                                       PTAB       58
      IF(IMFI) 60,60,50                                                  PTAB       59
   50 JMMX=6                                                             PTAB       60
      JMMY=8                                                             PTAB       61
      JMMZ=IMFI                                                          PTAB       62
      JMFI=ICFI                                                          PTAB       63
      CALL TOOL(DAT)                                                     PTAB       64
   60 RETURN                                                             PTAB       65
      END                                                                PTAB       66
*DECK SEBIN
      SUBROUTINE SEBIN(A,J,N)                                            SEBIN       2
      I = 49 - J                                                         SEBIN       3
      IF(J.LT.48) GO TO20                                                SEBIN       4
      IF(N.EQ.1) GO TO 10                                                SEBIN       5
      K = 3777777777777777B                                              SEBIN       6
      A = A.AND.K                                                        SEBIN       7
      RETURN                                                             SEBIN       8
 10   K = 4000000000000000B                                              SEBIN       9
      A = A.AND.K                                                        SEBIN      10
      RETURN                                                             SEBIN      11
 20   K = 2**(I-1)                                                       SEBIN      12
      IF(N.EQ.0) GO TO 30                                                SEBIN      13
      A = A.OR.K                                                         SEBIN      14
      RETURN                                                             SEBIN      15
 30   K = .NOT.K                                                         SEBIN      16
      A = A.AND.K                                                        SEBIN      17
      RETURN                                                             SEBIN      18
      END                                                                SEBIN      19
*DECK SRATP
      SUBROUTINE SRATP                                                   SRATP       2
C     GENERATES CONNECTIVITY MATRIX AND DESCRIBES TOPOLOGY OF STIFF.MAT. SRATP       3
CMAP10                                                                   SRATP       4
      COMMON/COMEL/IN                                                    SRATP       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  SRATP       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     SRATP       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       SRATP       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   SRATP       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   SRATP      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   SRATP      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   SRATP      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   SRATP      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   SRATP      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   SRATP      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   SRATP      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   SRATP      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   SRATP      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   SRATP      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   SRATP      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   SRATP      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   SRATP      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   SRATP      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   SRATP      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   SRATP      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   SRATP      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   SRATP      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    SRATP      28
      EQUIVALENCE     (IA(401), S(1))                                    SRATP      29
CEND MAP10                                                               SRATP      30
CMAP30                                                                   SRATP      31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              SRATP      32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      SRATP      33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  SRATP      34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  SRATP      35
     3 , (IA(380),ITAX)                                                  SRATP      36
      DATA IWORD,IELM,IRELC/32,13,1706/                                  SRATP      37
CEND MAP30                                                               SRATP      38
C     SET POINTERS AND CHECK FOR STORAGE SHORTAGE                        SRATP      39
      IND=3*IN                                                           SRATP      40
      IU=IDEF+IND+1                                                      SRATP      41
      IST=IU+IND                                                         SRATP      42
      MBAN=IDEF                                                          SRATP      43
      MBIN=IDEF                                                          SRATP      44
      ISUR=(IN-1)/IWORD+1                                                SRATP      45
      MSIR=MBIN+ISUR*IN                                                  SRATP      46
      IF (2*IND+2-ISUR*IN) 28,28,27                                      SRATP      47
 27   MSIR=MBIN+2*IND+2                                                  SRATP      48
 28   MMAX=MSIR+IN                                                       SRATP      49
      MMIN=MMAX+IN                                                       SRATP      50
      MF=MMIN+IN-ITY                                                     SRATP      51
      IF (MF) 2,2,3                                                      SRATP      52
 3    WRITE (MO,4)MF                                                     SRATP      53
 4    FORMAT (1X,19H13.  COMMON REQUEST,I5,2X,19HWORDS TOO SHORT FOR     SRATP      54
     1,30H STIFF.MAT.POINTER COMP/LINK 1)                                SRATP      55
 2    IF (IA(IIS)-MMIN-IN) 5,6,6                                         SRATP      56
 5    IA(IIS)=MMIN+IN                                                    SRATP      57
    6 DO 22 I=1,IN                                                       SRATP      58
      KX=MSIR+I                                                          SRATP      59
 22   IA(KX)=I                                                           SRATP      60
C     GENERATE ABIN BINARY MATRIX                                        SRATP      61
      CALL BNRY                                                          SRATP      62
C     GENERATE IMAX AND REGENERATE ISIR (IF NEEDED) VECTORS              SRATP      63
      CALL ARAN                                                          SRATP      64
C     GENERATE IBAND VECTOR                                              SRATP      65
 1100 CALL BAND                                                          SRATP      66
C     COMPUTE STIFFNESS STORAGE                                          SRATP      67
 812  ISUM1=ISUM+1                                                       SRATP      68
      IUI=IU+ISUM1                                                       SRATP      69
      IORD=IA(IUI)-1                                                     SRATP      70
      IORD1=IORD+1                                                       SRATP      71
C     UPDATE IST POINTER                                                 SRATP      72
      IST=IU+ISUM1                                                       SRATP      73
C     OUTPUT STIFFNESS MATRIX ROW POINTERS IF REQUESTED.                 SRATP      74
      IF (INP.NE.2) GO TO 813                                            SRATP      75
      WRITE (MO,422)                                                     SRATP      76
 422  FORMAT (1H1, 37HPOINTERS FOR ROWS OF RETAINED PORTION,             SRATP      77
     128H OF REDUCED STIFFNESS MATRIX, //)                               SRATP      78
      L=0                                                                SRATP      79
      DO 30 I=1,ISUM1,5                                                  SRATP      80
      L=L+5                                                              SRATP      81
      IF (L-ISUM1) 31,31,32                                              SRATP      82
 32   L=ISUM1                                                            SRATP      83
 31   K=0                                                                SRATP      84
      DO 33 J=I,L                                                        SRATP      85
      K=K+1                                                              SRATP      86
      KX=IU+J                                                            SRATP      87
      ITAR1(K)=J                                                         SRATP      88
 33   ITAR2(K)=IA(KX)                                                    SRATP      89
      WRITE (MO,423)(ITAR1(J),ITAR2(J),J=1,K)                            SRATP      90
 423  FORMAT (5(I4,I6,4X))                                               SRATP      91
 30   CONTINUE                                                           SRATP      92
C     PRINT OUT COMMON SIZE INFORMATION                                  SRATP      93
 813  WRITE (MO,7)IORD                                                   SRATP      94
 7    FORMAT (26H1STIFFNESS MATRIX REQUIRES,I6,2X,16HWORDS OF STORAGE)   SRATP      95
      WRITE (MO,16)ITY                                                   SRATP      96
 16   FORMAT (1X,20HTOTAL COMMON REQUEST,I7,3X,5HWORDS)                  SRATP      97
      N(1)=IA(IIS)                                                       SRATP      98
      N(2)=IST+IORD1                                                     SRATP      99
      I=IORD1+ISUM1                                                      SRATP     100
      J=IND                                                              SRATP     101
      ITAP=0                                                             SRATP     102
      IF (ITAP-10) 17,18,18                                              SRATP     103
 18   N(3)=0                                                             SRATP     104
      N(4)=0                                                             SRATP     105
      N(5)=405+2*IBO+4*IND+ISUM+IORD                                     SRATP     106
      GO TO 19                                                           SRATP     107
 17   K=IELM*IN+IND-2*IBO-ISUM1                                          SRATP     108
      IF (I-J) 8,9,9                                                     SRATP     109
 8    IF (J-K) 10,11,11                                                  SRATP     110
 9    IF (I-K) 10,12,12                                                  SRATP     111
 10   N(3)=IST+K                                                         SRATP     112
      GO TO 13                                                           SRATP     113
 11   N(3)=IST+J                                                         SRATP     114
      GO TO 13                                                           SRATP     115
 12   N(3)=IST+I                                                         SRATP     116
 13   N(4)=IST+2*ISUM+1+6*IT                                             SRATP     117
      IF(ITAX .GT. 0) N(4)=N(4)+6*IT+2*IND                               SRATP     118
      N(5)=0                                                             SRATP     119
 19   DO 15 I=1,5                                                        SRATP     120
      J=ITY-N(I)                                                         SRATP     121
      WRITE (MO,14) J,I                                                  SRATP     122
 14   FORMAT (16H  COMMON REQUEST,I6,2X,24HWORDS MORE THAN REQUIRED,     SRATP     123
     19H FOR LINK,I3)                                                    SRATP     124
 15   CONTINUE                                                           SRATP     125
      RETURN                                                             SRATP     126
      END                                                                SRATP     127
*DECK TABLP
      SUBROUTINE TABLP                                                   TABLP       2
C     TO PRINT THE FIRST OUTPUT ITEM                                     TABLP       3
CMAP10                                                                   TABLP       4
      COMMON/COMEL/IN                                                    TABLP       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TABLP       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TABLP       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TABLP       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TABLP       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TABLP      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TABLP      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TABLP      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TABLP      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TABLP      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TABLP      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TABLP      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TABLP      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TABLP      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TABLP      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TABLP      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TABLP      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TABLP      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TABLP      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TABLP      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TABLP      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TABLP      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TABLP      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TABLP      28
      EQUIVALENCE     (IA(401), S(1))                                    TABLP      29
CEND MAP10                                                               TABLP      30
CMAP20                                                                   TABLP      31
      DIMENSION LLL(27)                                                  TABLP      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   TABLP      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   TABLP      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  TABLP      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  TABLP      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   TABLP      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   TABLP      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   TABLP      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   TABLP      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  TABLP      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   TABLP      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   TABLP      43
CEND MAP20                                                               TABLP      44
CMAP30                                                                   TABLP      45
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              TABLP      46
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      TABLP      47
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  TABLP      48
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  TABLP      49
CEND MAP30                                                               TABLP      50
      WRITE(MO,10) (AA(I+250),I=1,20)                                    TABLP      51
   10 FORMAT(1H1,34H****PAFAC PROGRAM/MAY  01.1980****///1X,20A4)        TABLP      52
      IF(ITYPE.NE.0) GO TO 30                                            TABLP      53
      WRITE(MO,20)                                                       TABLP      54
   20 FORMAT(//1X,13HPROBLEM TYPE%,5X,49HEQUILIBRIUM ELASTO-PLASTIC OF I TABLP      55
     1SOTROPIC MATERIALS)                                                TABLP      56
      GO TO 50                                                           TABLP      57
   30 WRITE(MO,40)                                                       TABLP      58
   40 FORMAT(//1X,13HPROBLEM TYPE%,5X,49HEQUILIBRIUM ELASTO-PLASTIC OF C TABLP      59
     1OMPOSITE MATERIALS)                                                TABLP      60
   50 IF(ITAS-9) 70,60,70                                                TABLP      61
   60 IF(INP-1) 90,70,70                                                 TABLP      62
   70 WRITE(MO,80) IN,IBUN,IT,ICOR,IMES,IHARD,IBN,IYIT,IP,KHARD,IMAT,    TABLP      63
     1INP,IPRS,INX                                                       TABLP      64
   80 FORMAT(/                                                           TABLP      65
     133H TOTAL NUMBER OF NODES           ,I5,2X,                        TABLP      66
     236H IBUN  DBC INPUT INDICATOR          ,I2/                        TABLP      67
     333H TOTAL NUMBER OF ELEMENTS        ,I5,2X,                        TABLP      68
     436H ICOR  COORDINATE INPUT INDICATOR   ,I2/                        TABLP      69
     538H DEGREES OF FREEDOM PER NODE         3,2X,                      TABLP      70
     636H IMES  MESH INPUT INDICATOR         ,I2/                        TABLP      71
     738H NUMBER OF VERTICES PER ELEMENT      8,2X,                      TABLP      72
     836H IHARD STRAIN-HARD. INPUT INDICATOR ,I2/                        TABLP      73
     933H NUMBER OF DBC INPUT UNITS       ,I5,2X,                        TABLP      74
     A36H IYIT  MAT. TEMP. DEP. INDICATOR    ,I2/                        TABLP      75
     B33H NUMBER OF C.LOAD INPUT UNITS    ,I5,2X,                        TABLP      76
     C36H KHARD KINEMATIC-HARD. INDICATOR    ,I2/                        TABLP      77
     D33H NUMBER OF MATERIAL TYPES        ,I5,2X,                        TABLP      78
     E36H INP   PRINTOUT LEVEL INDICATOR     ,I2/                        TABLP      79
     F33H NUMBER OF PRESSURE TYPES        ,I5,2X,                        TABLP      80
     G36H INX   NUMBER OF LAST LINK XQTED    ,I2)                        TABLP      81
      WRITE(MO,85) ISDT,IPIR,IAMB,ITYPE,IMFI,ISHUF,IFBR,ITAS,AA(251),IO, TABLP      82
     1MO,ACEL,G1,G2,G3                                                   TABLP      83
   85 FORMAT(                                                            TABLP      84
     H33H NUMBER OF TEMP.CHANGE TYPES     ,I5,2X,                        TABLP      85
     I36H IPIR  INDICATOR FOR SAVE            ,I2/                       TABLP      86
     J34H IFL MAT TYPE NO. FOR FAILED ELT  ,I4,2X,                       TABLP      87
     K36H ITYPE MATERIAL TYPE INDICATOR       ,I2/                       TABLP      88
     L33H NUMBER OF FIBER ANGLE TYPES     ,I5,2X,                        TABLP      89
     M36H ISHUF TEMPORARY UNIT NUMBER         ,I2/                       TABLP      90
     N33H IFBR INDICATOR FOR FIBER STRESS ,I5,2X,                        TABLP      91
     O36H ITAS  SCRATCH UNIT NUMBER           ,I2/                       TABLP      92
     P34H JOB IDENTIFIER                   ,A4,2X,                       TABLP      93
     Q36H IO    INPUT UNIT NUMBER             ,I2/40X,                   TABLP      94
     R36H MO    OUTPUT UNIT NUMBER            ,I2/                       TABLP      95
     S22H ACCELERATION*UNITMASS,E13.4,5X,                                TABLP      96
     T17H ACCL.DIR.COSINES,3F6.3)                                        TABLP      97
   90 RETURN                                                             TABLP      98
      END                                                                TABLP      99
*DECK TOOL
      SUBROUTINE TOOL(DAT)                                               TOOL        2
C     TO READ AND TO PRINT PROPERTIES                                    TOOL        3
CMAP10                                                                   TOOL        4
      COMMON/COMEL/IN                                                    TOOL        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TOOL        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TOOL        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TOOL        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TOOL        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TOOL       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TOOL       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TOOL       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TOOL       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TOOL       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TOOL       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TOOL       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TOOL       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TOOL       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TOOL       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TOOL       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TOOL       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TOOL       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TOOL       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TOOL       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TOOL       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TOOL       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TOOL       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TOOL       28
      EQUIVALENCE     (IA(401), S(1))                                    TOOL       29
CEND MAP10                                                               TOOL       30
CMAP30                                                                   TOOL       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              TOOL       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      TOOL       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  TOOL       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  TOOL       35
CEND MAP30                                                               TOOL       36
      DIMENSION DAT(8)                                                   TOOL       37
      K1=JMMX                                                            TOOL       38
      K2=JMMY                                                            TOOL       39
      KN=JMMZ                                                            TOOL       40
      KP=JMFI                                                            TOOL       41
      IF (INP) 30,30,31                                                  TOOL       42
 31   WRITE (MO,1) (DAT(I),I=K1,K2)                                      TOOL       43
 1    FORMAT (//,1X,7A10)                                                TOOL       44
 30   L=0                                                                TOOL       45
      DO 10 I=1,KN,40                                                    TOOL       46
      L=L+40                                                             TOOL       47
      IF (L-KN) 12,12,11                                                 TOOL       48
 11   L=KN                                                               TOOL       49
 12   K=L-I+1                                                            TOOL       50
      READ (IO,13)(ITAR1(J),TAR(J),J=1,K)                                TOOL       51
 13   FORMAT (8(I2,E8.5))                                                TOOL       52
      LL=I-1                                                             TOOL       53
      DO 14 J=1,K                                                        TOOL       54
      LL=LL+1                                                            TOOL       55
      IF (ITAR1(J)-LL) 15,16,15                                          TOOL       56
 15   WRITE (MO,17)LL                                                    TOOL       57
 17   FORMAT(28H 14.  A PROPERTY IN POSITION,I5,2X,15HHAS WRONG LABEL)   TOOL       58
      IERR=1                                                             TOOL       59
      GO TO 14                                                           TOOL       60
 16   KPJ=KP+J                                                           TOOL       61
      AA(KPJ)=TAR(J)                                                     TOOL       62
 14   CONTINUE                                                           TOOL       63
      IF (INP-1) 10,18,18                                                TOOL       64
 18   WRITE (MO,19)(ITAR1(J),TAR(J),J=1,K)                               TOOL       65
 19   FORMAT (5(I3,E11.4)/)                                              TOOL       66
 10   KP=KPJ                                                             TOOL       67
      RETURN                                                             TOOL       68
      END                                                                TOOL       69
*DECK TOPO
      SUBROUTINE TOPO                                                    TOPO        2
C     PREPARES ELEMENT PROPERTIES AND CHECKS                             TOPO        3
CMAP10                                                                   TOPO        4
      COMMON/COMEL/IN                                                    TOPO        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TOPO        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TOPO        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TOPO        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TOPO        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TOPO       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TOPO       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TOPO       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TOPO       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TOPO       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TOPO       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TOPO       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TOPO       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TOPO       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TOPO       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TOPO       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TOPO       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TOPO       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TOPO       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TOPO       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TOPO       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TOPO       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TOPO       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TOPO       28
      EQUIVALENCE     (IA(401), S(1))                                    TOPO       29
CEND MAP10                                                               TOPO       30
CMAP30                                                                   TOPO       31
      DIMENSION ITAR1(30),ITAR2(30),TAR(40)                              TOPO       32
      EQUIVALENCE (CONS,MSIR),(IORD1,MMIN),(IORD,MMAX),(IPBG,MBIN),      TOPO       33
     1(IPEN,MBAN),(IA(62),ITAR1(1)),(IA(92),ITAR2(1)),(IA(102),TAR(1)),  TOPO       34
     2(IA(301),ISUR),(IA(302),MI),(IA(303),MX),(IA(304),I),(IA(305),IX)  TOPO       35
CEND MAP30                                                               TOPO       36
      IMET=0                                                             TOPO       37
      JPRS=0                                                             TOPO       38
      ITEM=0                                                             TOPO       39
      JMFI=0                                                             TOPO       40
      DO 10 I=1,8                                                        TOPO       41
   10 N(I)=0                                                             TOPO       42
C     PREPARE ELEMENT PROPERTIES                                         TOPO       43
      JM=J1+M                                                            TOPO       44
      IMET=IA(JM)/100                                                    TOPO       45
      JMFI=IA(JM)-100*IMET                                               TOPO       46
      JM=J2+M                                                            TOPO       47
      JPRS=IA(JM)/100                                                    TOPO       48
      ITEM=IA(JM)-100*JPRS                                               TOPO       49
      I=1                                                                TOPO       50
      JM=J3+M                                                            TOPO       51
      N(I)=IA(JM)                                                        TOPO       52
      I=I+1                                                              TOPO       53
      JM=J4+M                                                            TOPO       54
      N(I)=IA(JM)                                                        TOPO       55
      I=I+1                                                              TOPO       56
      JM=J5+M                                                            TOPO       57
      N(I)=IA(JM)                                                        TOPO       58
      I=I+1                                                              TOPO       59
      JM=J6+M                                                            TOPO       60
      N(I)=IA(JM)                                                        TOPO       61
      I=I+1                                                              TOPO       62
      JM=J7+M                                                            TOPO       63
      N(I)=IA(JM)                                                        TOPO       64
      I=I+1                                                              TOPO       65
      JM=J8+M                                                            TOPO       66
      N(I)=IA(JM)                                                        TOPO       67
      I=I+1                                                              TOPO       68
      JM=J9+M                                                            TOPO       69
      N(I)=IA(JM)                                                        TOPO       70
      I=I+1                                                              TOPO       71
      JM=J10+M                                                           TOPO       72
      N(I)=IA(JM)                                                        TOPO       73
C     CHECK ELEMENT PROPERTIES                                           TOPO       74
      DO 20 J=1,8                                                        TOPO       75
      IF(N(J)-IN) 20,20,30                                               TOPO       76
   20 CONTINUE                                                           TOPO       77
      GO TO 50                                                           TOPO       78
   30 WRITE(MO,40) M                                                     TOPO       79
   40 FORMAT(16H 15.  IN ELEMENT,I5,36H  ERROR IN MESH TOPOLOGY INFORMAT TOPO       80
     +ION)                                                               TOPO       81
   50 NDX=0                                                              TOPO       82
      IF(IMET*(IMET-IMAT-1)) 70,60,60                                    TOPO       83
   60 IMET=IMAT                                                          TOPO       84
      JM=J1+M                                                            TOPO       85
      L=IA(JM)-(IA(JM)/100)*100                                          TOPO       86
      IA(JM)=100*IMET+L                                                  TOPO       87
      NDX=NDX+1                                                          TOPO       88
   70 IF((JPRS+1)*(JPRS-IPRS-1)) 90,80,80                                TOPO       89
   80 JPRS=IPRS                                                          TOPO       90
      JM=J2+M                                                            TOPO       91
      L=IA(JM)-(IA(JM)/100)*100                                          TOPO       92
      IA(JM)=100*JPRS+L                                                  TOPO       93
      NDX=NDX+1                                                          TOPO       94
   90 IF((ITEM+1)*(ITEM-ISDT-1)) 110,100,100                             TOPO       95
  100 ITEM=ISDT                                                          TOPO       96
      JM=J2+M                                                            TOPO       97
      L=IA(JM)/100                                                       TOPO       98
      IA(JM)=100*L+ITEM                                                  TOPO       99
      NDX=NDX+1                                                          TOPO      100
  110 IF((JMFI+1)*(JMFI-IMFI-1)) 130,120,120                             TOPO      101
  120 JMFI=IMFI                                                          TOPO      102
      JM=J1+M                                                            TOPO      103
      L=IA(JM)/100                                                       TOPO      104
      IA(JM)=100*L+JMFI                                                  TOPO      105
      NDX=NDX+1                                                          TOPO      106
  130 IF(NDX) 160,160,140                                                TOPO      107
  140 WRITE(MO,150) M,NDX                                                TOPO      108
  150 FORMAT(16H 16.  IN ELEMENT,I5,2X,1H,,I5,1X,                        TOPO      109
     144HPROP. TYPE NO. OUT OF RANGE. LARGEST ASSUMED)                   TOPO      110
  160 RETURN                                                             TOPO      111
      END                                                                TOPO      112
*DECK PAC2
      SUBROUTINE PAC2(IFLG)                                              PAC2        2
C     MAIN SUBROUTINE OF THE GENRATION LINK                              PAC2        3
C     GENERATES GOVERNING EQUATIONS                                      PAC2        4
CMAP10                                                                   PAC2        5
      COMMON/COMEL/IN                                                    PAC2        6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PAC2        7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PAC2        8
      EQUIVALENCE (IN,IA(1),AA(1))                                       PAC2        9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PAC2       10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PAC2       11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PAC2       12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PAC2       13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PAC2       14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PAC2       15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PAC2       16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PAC2       17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PAC2       18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PAC2       19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PAC2       20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PAC2       21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PAC2       22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PAC2       23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PAC2       24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PAC2       25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PAC2       26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PAC2       27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PAC2       28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PAC2       29
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           PAC2       30
CEND MAP10                                                               PAC2       31
CMAP20                                                                   PAC2       32
      DIMENSION LLL(27)                                                  PAC2       33
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PAC2       34
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PAC2       35
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PAC2       36
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PAC2       37
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PAC2       38
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PAC2       39
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PAC2       40
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PAC2       41
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PAC2       42
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PAC2       43
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PAC2       44
CEND MAP20                                                               PAC2       45
CMAP40                                                                   PAC2       46
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            PAC2       47
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       PAC2       48
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), PAC2       49
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         PAC2       50
CEND MAP40                                                               PAC2       51
      CALL RESET                                                         PAC2       52
      INPT=INP                                                           PAC2       53
      JTY=0                                                              PAC2       54
C     CLEAR STIFFNESS ARRAY                                              PAC2       55
      DO 132 I=1,IORD1                                                   PAC2       56
      ISTI=IST+I                                                         PAC2       57
 132  AA(ISTI)=0.                                                        PAC2       58
C     GENERATE ELEMENTAL MATRICES AND ASSEMBLE                           PAC2       59
      DO 99 M=1,IT                                                       PAC2       60
      INP=INPT                                                           PAC2       61
      CALL CAS2                                                          PAC2       62
      IERR=0                                                             PAC2       63
      DO 133 I=1,8                                                       PAC2       64
      N(I)=0                                                             PAC2       65
      X(I)=0.                                                            PAC2       66
      Y(I)=0.                                                            PAC2       67
 133  Z(I)=0.                                                            PAC2       68
C     CLEAR AREA OF P,UV,X,Y,Z,XD,YD,ZD                                  PAC2       69
      DO 134 I=83,178                                                    PAC2       70
  134 AA(I)=0.                                                           PAC2       71
C     CLEAR GENERAL USAGE AREA                                           PAC2       72
      DO 135 I=200,324                                                   PAC2       73
  135 AA(I)=0.                                                           PAC2       74
      DT=0.                                                              PAC2       75
      PRES=0.                                                            PAC2       76
      CFE=1.                                                             PAC2       77
      NAV=1                                                              PAC2       78
      ITTT=0                                                             PAC2       79
      CALL TOPO2                                                         PAC2       80
      DO 98 I=1,8                                                        PAC2       81
      NOO(I)=N(I)                                                        PAC2       82
      IF(N(I)) 9800,9800,98                                              PAC2       83
 98   CONTINUE                                                           PAC2       84
      GO TO 2                                                            PAC2       85
 9800 IERR=2                                                             PAC2       86
 1    WRITE (MO,111)M                                                    PAC2       87
 111  FORMAT(13H 18.  ELEMENT,1I4,2X,29HIS IN ERROR. ELEMENT IGNORED.)   PAC2       88
      JTY=JTY+1                                                          PAC2       89
      IERR=0                                                             PAC2       90
      GO TO 999                                                          PAC2       91
C     GENERATE MATERIAL CONSTANTS REFERRED TO OVERALL AXES               PAC2       92
 2    CALL ELMT2P                                                        PAC2       93
C     GENERATE ELEMENT PROPERTIES OTHER THAN COORDINATES AND MATERIAL    PAC2       94
      CALL ELPTY                                                         PAC2       95
C     CUT THE HEXAHEDRAL ELEMENT TO 5 TETRAHEDRONS IN ONE OR TWO WAY     PAC2       96
C     ACCORDING TO IDIV PARAMETER                                        PAC2       97
      DO 4901 I=1,4                                                      PAC2       98
 4901 NOT(I)=N(I)                                                        PAC2       99
 4902 CALL CUTE                                                          PAC2      100
      IF(IDIV.EQ.0) CFE=0.5                                              PAC2      101
 5100 JI=4*ITTT                                                          PAC2      102
      PRCO=0.                                                            PAC2      103
      ITTT=ITTT+1                                                        PAC2      104
C     GENERATE THE COORDINATES OF THE VERTICES OF TETRAHEDRON NO. ITTT   PAC2      105
      CALL ELCOR(JI)                                                     PAC2      106
      IF (IERR) 1,5600,1                                                 PAC2      107
 5600 DO 6 I=1,12                                                        PAC2      108
      P(I)=0.                                                            PAC2      109
 6    UV(I)=0.                                                           PAC2      110
      DO 7 I=1,144                                                       PAC2      111
 7    S(I)=0.                                                            PAC2      112
      JERR=0                                                             PAC2      113
      IF (DT) 82,83,82                                                   PAC2      114
C     COMPUTE DEFLECTIONS DUE TO ELASTIC PORTION OF THERMAL STRAINS      PAC2      115
   82 IF(ITYPE.EQ.0) GO TO 802                                           PAC2      116
      CALL TDEF                                                          PAC2      117
      GO TO 83                                                           PAC2      118
  802 DO 84 I=1,4                                                        PAC2      119
      I1=I+4                                                             PAC2      120
      I2=I1+4                                                            PAC2      121
      UV(I)=X(I)*DT*AL1                                                  PAC2      122
      UV(I1)=Y(I)*DT*AL2                                                 PAC2      123
 84   UV(I2)=Z(I)*DT*AL3                                                 PAC2      124
   83 CALL TETRA                                                         PAC2      125
      IF (IERR.EQ.0) GO TO 5041                                          PAC2      126
      JERR=JERR+1                                                        PAC2      127
      IERR=0                                                             PAC2      128
      GO TO 999                                                          PAC2      129
 5041 IF (INP-1) 86,86,85                                                PAC2      130
   85 WRITE(MO,87) M,ITTT,ITER,(N(I),I=1,4),IMET,ITEM,JPRS,JMFI,         PAC2      131
     1(X(I),I=1,4),(Y(I),I=1,4),(Z(I),I=1,4),(I,S(I),I=1,144)            PAC2      132
   87 FORMAT(/////1X,7HELEMENT,I5,11H/SUBELEMENT,I5,2X,16HSTIFFNESS MATR PAC2      133
     1IX,2X,5HSTEP%,I4//1X,19HVERTEX NODE LABELS%,4I5,10X,5HIMET%,I3,5X, PAC2      134
     25HITEM%,I3,5X,5HJPRS%,I3,5X,5HJMFI%,I3/1X,21HX(W.R.T. GEOM CENTR)% PAC2      135
     3,4E14.6/1X,21HY(W.R.T. GEOM CENTR)%,4E14.6/1X,21HZ(W.R.T. GEOM CEN PAC2      136
     4TR)%,4E14.6//(5(I5,E15.6)))                                        PAC2      137
 86   IF (IERR) 1,951,1                                                  PAC2      138
  951 IF(DT) 952,953,952                                                 PAC2      139
C     ADD THERMAL EFFECT TO LOAD VECTOR                                  PAC2      140
 952  CALL DMM (S,UV,12,P)                                               PAC2      141
 953  IF (IPBG) 957,957,958                                              PAC2      142
C     ADD PRESSURE AND GRAVITY EFFECTS TO LOAD VECTOR                    PAC2      143
 958  IF (IPBG-IPEN) 959,959,957                                         PAC2      144
 959  DO 955 I=IPBG,IPEN                                                 PAC2      145
      DELP=CONS*G1(I)                                                    PAC2      146
      CPRS=PRCO*PD(I)                                                    PAC2      147
      IJ=(I-IPBG)*4                                                      PAC2      148
      DO 956 J=1,4                                                       PAC2      149
      IJ=IJ+1                                                            PAC2      150
 956  P(IJ)=P(IJ)+DELP+CPRS                                              PAC2      151
 955  CONTINUE                                                           PAC2      152
  957 IF (INP.NE.2) GO TO 9532                                           PAC2      153
      WRITE (MO,9533) M,ITTT,ITER,(I,P(I),I=1,12)                        PAC2      154
 9533 FORMAT(////1X,7HELEMENT,I5,11H/SUBELEMENT,I5,2X,11HLOAD VECTOR,2X, PAC2      155
     14HSTEP,I4//(5(I5,E15.5)))                                          PAC2      156
C     ASSEMBLE ELEMENTAL MATRICES                                        PAC2      157
 9532 CALL ASMEL                                                         PAC2      158
      IF(IERR) 1,999,1                                                   PAC2      159
  999 IF(ITTT-5) 5100,9990,9990                                          PAC2      160
 9990 IF(IDIV.NE.0) GO TO 99                                             PAC2      161
      IF(NAV.NE.2) GO TO 99                                              PAC2      162
      ITTT=0                                                             PAC2      163
      DO 4890 I=1,4                                                      PAC2      164
 4890 N(I)=NOT(I)                                                        PAC2      165
      GO TO 4902                                                         PAC2      166
 99   CONTINUE                                                           PAC2      167
      INP=INPT                                                           PAC2      168
      CALL CAS2                                                          PAC2      169
      IF (INP.NE.2) GO TO 232                                            PAC2      170
      IEND=IST+IORD                                                      PAC2      171
      IST1=IST+1                                                         PAC2      172
      WRITE(MO,871) ITER,(I,AA(I),I=IST1,IEND)                           PAC2      173
 871  FORMAT(//////1X,41HROW LISTED UPPER REDUCED STIFFNESS MATRIX,2X,   PAC2      174
     15HSTEP%,I5/1X,61HFOR LOCATION OF MAIN DIAGONAL ELEMENTS SEE THE PO PAC2      175
     2INTERS TABLE//(5(I5,E15.6)))                                       PAC2      176
      IDEF1=IDEF+1                                                       PAC2      177
      IEND=IDEF+ISUM                                                     PAC2      178
      WRITE(MO,8711) ITER,(I,AA(I),I=IDEF1,IEND)                         PAC2      179
 8711 FORMAT(///1X,19HREDUCED LOAD VECTOR,5X,5HSTEP%,I4//(5(I5,E15.6)))  PAC2      180
 232  IERR=IU                                                            PAC2      181
      PNORMB=0.                                                          PAC2      182
      DO 42 I=1,ISUM                                                     PAC2      183
      L=IDEF+I                                                           PAC2      184
   42 PNORMB=PNORMB+ABS(AA(L))                                           PAC2      185
      INP=INPT                                                           PAC2      186
      IF (JERR.NE.0) WRITE(MO,41)JERR                                    PAC2      187
   41 FORMAT(17H 20.  MATRICES OF,I4,33H NUMBER OF ELEMENTS NOT GENERATE PAC2      188
     +D)                                                                 PAC2      189
      CALL TIMEO (C2T)                                                   PAC2      190
      WRITE (MO,5555)C2T                                                 PAC2      191
 5555 FORMAT (    21H GENERATION LINK TOOK,F7.2,10H  SECONDS.)           PAC2      192
      IF ((INX.GT.2).AND.(JERR.EQ.0))RETURN                              PAC2      193
      IFLG = 1                                                           PAC2      194
      RETURN                                                             PAC2      195
      END                                                                PAC2      196
*DECK ADM
      SUBROUTINE ADM (S,IDS,A,M,IB,JB,C)                                 ADM         2
C     ADDS SUBMATRICES TO FORM STIFFNESS MATRIX                          ADM         3
      DIMENSION A(4,4),S(1)                                              ADM         4
      DO 10 I=1,M                                                        ADM         5
      IS=IB+I-1                                                          ADM         6
      IF (IB-JB) 12,11,12                                                ADM         7
 11   JI=I                                                               ADM         8
      GO TO 13                                                           ADM         9
 12   JI=1                                                               ADM        10
 13   DO 90 J=JI,M                                                       ADM        11
      JS=JB+J-1                                                          ADM        12
      ISS=(JS-1)*IDS+IS                                                  ADM        13
      S(ISS)=S(ISS)+A(I,J)*C                                             ADM        14
      ISR=(IS-1)*IDS+JS                                                  ADM        15
      S(ISR)=S(ISS)                                                      ADM        16
 90   CONTINUE                                                           ADM        17
 10   CONTINUE                                                           ADM        18
      RETURN                                                             ADM        19
      END                                                                ADM        20
*DECK ASMEL
      SUBROUTINE ASMEL                                                   ASMEL       2
C     TO ASSEMBLE ELEMENTAL STIFFNESS AND LOAD MATRICES                  ASMEL       3
CMAP10                                                                   ASMEL       4
      COMMON/COMEL/IN                                                    ASMEL       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ASMEL       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ASMEL       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       ASMEL       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ASMEL       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ASMEL      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ASMEL      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ASMEL      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ASMEL      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ASMEL      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ASMEL      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ASMEL      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ASMEL      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ASMEL      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ASMEL      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ASMEL      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ASMEL      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ASMEL      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ASMEL      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ASMEL      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ASMEL      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ASMEL      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ASMEL      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ASMEL      28
      EQUIVALENCE     (IA(401), S(1))                                    ASMEL      29
CEND MAP10                                                               ASMEL      30
CMAP40                                                                   ASMEL      31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            ASMEL      32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       ASMEL      33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), ASMEL      34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         ASMEL      35
CEND MAP40                                                               ASMEL      36
      IDEG=3                                                             ASMEL      37
      IMS=4                                                              ASMEL      38
      IND=3*IN                                                           ASMEL      39
      IDS=12                                                             ASMEL      40
      DO 95 I=1,IDEG                                                     ASMEL      41
      DO 94 K=1,IMS                                                      ASMEL      42
      IE=IMS*(I-1)+K                                                     ASMEL      43
      IS=IDEG*(N(K)-1)+I                                                 ASMEL      44
      ISE=IE-IDS                                                         ASMEL      45
      IQE=1                                                              ASMEL      46
      IBBI=IS+IBB                                                        ASMEL      47
      IF (IA(IBBI)) 307,100,308                                          ASMEL      48
 308  IBBI=IBBI-1                                                        ASMEL      49
      GO TO 309                                                          ASMEL      50
C     MULTIPLE CONNECTION                                                ASMEL      51
 100  IBBI=IBBI-IBB+IIC                                                  ASMEL      52
      IQE=IA(IBBI)/100000                                                ASMEL      53
      IBBI=IA(IBBI)-100000*IQE+IND+IBB                                   ASMEL      54
      GO TO 309                                                          ASMEL      55
 307  IERR=6                                                             ASMEL      56
      GO TO 96                                                           ASMEL      57
 309  DO 393 IQ=1,IQE                                                    ASMEL      58
      IBBI=IBBI+1                                                        ASMEL      59
      IICI=IBBI-IBB+IIC                                                  ASMEL      60
      ISS=ISE                                                            ASMEL      61
      CCURI=AA(IICI)*CFE                                                 ASMEL      62
      IB=IA(IBBI)                                                        ASMEL      63
      IF (CCURI) 912,911,912                                             ASMEL      64
 912  IDEFI=IDEF+IB                                                      ASMEL      65
      AA(IDEFI)=AA(IDEFI)+CCURI*P(IE)                                    ASMEL      66
 911  DO 93 J=1,IDEG                                                     ASMEL      67
      DO 92 L=1,IMS                                                      ASMEL      68
      ISS=ISS+IDS                                                        ASMEL      69
      JE=IMS*(J-1)+L                                                     ASMEL      70
      JS=IDEG*(N(L)-1)+J                                                 ASMEL      71
      JQE=1                                                              ASMEL      72
      JBBI=JS+IBB                                                        ASMEL      73
      IF (IA(JBBI)) 307,200,408                                          ASMEL      74
 408  JBBI=JBBI-1                                                        ASMEL      75
      GO TO 409                                                          ASMEL      76
C     MULTIPLE CONNECTION                                                ASMEL      77
 200  JBBI=JBBI-IBB+IIC                                                  ASMEL      78
      JQE=IA(JBBI)/100000                                                ASMEL      79
      JBBI=IA(JBBI)-100000*JQE+IND+IBB                                   ASMEL      80
 409  DO 392 JQ=1,JQE                                                    ASMEL      81
      JBBI=JBBI+1                                                        ASMEL      82
      JJCI=JBBI-IBB+IIC                                                  ASMEL      83
      CCURJ=AA(JJCI)                                                     ASMEL      84
      JB=IA(JBBI)                                                        ASMEL      85
      F=CCURI*CCURJ                                                      ASMEL      86
      IF (F) 913,392,913                                                 ASMEL      87
 913  IF (JB-IND) 914,914,915                                            ASMEL      88
 915  AA(IDEFI)=AA(IDEFI)-F*S(ISS)                                       ASMEL      89
      GO TO 392                                                          ASMEL      90
 914  IF (JB-IB) 392,916,916                                             ASMEL      91
 916  IUI=IU+IB                                                          ASMEL      92
      ISTI=IST+IA(IUI)+JB-IB                                             ASMEL      93
      AA(ISTI)=AA(ISTI)+F*S(ISS)                                         ASMEL      94
 392  CONTINUE                                                           ASMEL      95
 92   CONTINUE                                                           ASMEL      96
 93   CONTINUE                                                           ASMEL      97
 393  CONTINUE                                                           ASMEL      98
 94   CONTINUE                                                           ASMEL      99
 95   CONTINUE                                                           ASMEL     100
 96   RETURN                                                             ASMEL     101
      END                                                                ASMEL     102
*DECK CAS2
      SUBROUTINE CAS2                                                    CAS2        2
C     USER SUPPLIED SUBROUTINE USED TO REDEFINE THE PRINTOUT             CAS2        3
C     INDICATOR (INP) FOR SELECTIVE PRINTING                             CAS2        4
C                                                                        CAS2        5
C   MEANING OF SYMBOLS%                                                  CAS2        6
C                                                                        CAS2        7
C     IA     ARRAY(S) IN COMMON,COMEL                                    CAS2        8
C     INP    PRINT OUT INDICATOR(SET EQUAL TO 2 FOR MAX OUTPUT)          CAS2        9
C     M      CURRENT ELEMENT IDENTIFIER                                  CAS2       10
C     NN     ELEMENT FOR WHICH INP IS TO BE CHANGED                      CAS2       11
C                                                                        CAS2       12
      COMMON /COMEL/ IA(401)                                             CAS2       13
      EQUIVALENCE (IA(18),M),(IA(27),INP)                                CAS2       14
      RETURN                                                             CAS2       15
      END                                                                CAS2       16
*DECK CODI
      SUBROUTINE CODI                                                    CODI        2
C     OBTAINS MATRIX OF DIRECTION COSINES OF LAMINA-OVERALL AXES         CODI        3
CMAP10                                                                   CODI        4
      COMMON/COMEL/IN                                                    CODI        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  CODI        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     CODI        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       CODI        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   CODI        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   CODI       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   CODI       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   CODI       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   CODI       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   CODI       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   CODI       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   CODI       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   CODI       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   CODI       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   CODI       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   CODI       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   CODI       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   CODI       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   CODI       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   CODI       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   CODI       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   CODI       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   CODI       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    CODI       28
      EQUIVALENCE     (IA(401), S(1))                                    CODI       29
CEND MAP10                                                               CODI       30
CMAP40                                                                   CODI       31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            CODI       32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       CODI       33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), CODI       34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         CODI       35
CEND MAP40                                                               CODI       36
      DO 10 I=1,3                                                        CODI       37
      J=N(I)                                                             CODI       38
      IXXJ=IXX+J                                                         CODI       39
      IYYJ=IYY+J                                                         CODI       40
      IZZJ=IZZ+J                                                         CODI       41
      X(I)=AA(IXXJ)                                                      CODI       42
      Y(I)=AA(IYYJ)                                                      CODI       43
   10 Z(I)=AA(IZZJ)                                                      CODI       44
      X21=X(2)-X(1)                                                      CODI       45
      Y21=Y(2)-Y(1)                                                      CODI       46
      Z21=Z(2)-Z(1)                                                      CODI       47
      X31=X(3)-X(1)                                                      CODI       48
      Y31=Y(3)-Y(1)                                                      CODI       49
      Z31=Z(3)-Z(1)                                                      CODI       50
      DIR(2,1)=Y21*Z31-Y31*Z21                                           CODI       51
      DIR(2,2)=X31*Z21-X21*Z31                                           CODI       52
      DIR(2,3)=X21*Y31-X31*Y21                                           CODI       53
      XL=SQRT(DIR(2,1)**2+DIR(2,2)**2+DIR(2,3)**2)                       CODI       54
      DIR(2,1)=DIR(2,1)/XL                                               CODI       55
      DIR(2,2)=DIR(2,2)/XL                                               CODI       56
      DIR(2,3)=DIR(2,3)/XL                                               CODI       57
      IF(JMFI) 1010,1010,20                                              CODI       58
   20 ICFIJ=ICFI+JMFI                                                    CODI       59
      ANG=AA(ICFIJ)                                                      CODI       60
      IF(ABS(ANG)-90.) 50,50,30                                          CODI       61
   30 ANG=90.                                                            CODI       62
      IF(AA(ICFIJ)) 40,50,50                                             CODI       63
   40 ANG=-90.                                                           CODI       64
   50 FI=ANG*0.01745329252                                               CODI       65
      IF(FI) 60,60,70                                                    CODI       66
   60 SIGNFI=-1.0                                                        CODI       67
      GO TO 80                                                           CODI       68
   70 SIGNFI=1.0                                                         CODI       69
   80 IF(ABS(DIR(2,1))-.1E-3) 90,90,100                                  CODI       70
   90 IF(ABS(DIR(2,3))-.1E-3) 140,140,130                                CODI       71
  100 DIR(3,2)=COS(FI)                                                   CODI       72
      ASQ=DIR(2,1)*DIR(2,1)                                              CODI       73
      AX=1.0+DIR(2,3)*DIR(2,3)/ASQ                                       CODI       74
      BX=DIR(2,2)*DIR(2,3)*DIR(3,2)/ASQ                                  CODI       75
      CX=DIR(3,2)*DIR(3,2)+DIR(2,2)*DIR(2,2)*DIR(3,2)*DIR(3,2)/ASQ-1.0   CODI       76
      CULP=BX*BX-AX*CX                                                   CODI       77
      IF(CULP) 110,120,120                                               CODI       78
  110 CULP=0.                                                            CODI       79
  120 DIR(3,3)=(-BX+SIGNFI*SQRT(CULP))/AX                                CODI       80
      DIR(3,1)=(-DIR(2,2)*DIR(3,2)-DIR(2,3)*DIR(3,3))/DIR(2,1)           CODI       81
      GO TO 150                                                          CODI       82
  130 DIR(3,2)=COS(FI)                                                   CODI       83
      DIR(3,3)=-DIR(2,2)*DIR(3,2)/DIR(2,3)                               CODI       84
      DIR(3,1)=SIGNFI*SQRT(1.0-DIR(3,2)*DIR(3,2)-DIR(3,3)*DIR(3,3))      CODI       85
      GO TO 150                                                          CODI       86
  140 DIR(3,3)=COS(FI)                                                   CODI       87
      DIR(3,2)=0.0                                                       CODI       88
      DIR(3,1)=SIGNFI*SQRT(1.0-DIR(3,3)*DIR(3,3))                        CODI       89
  150 DIR(1,1)=DIR(2,2)*DIR(3,3)-DIR(2,3)*DIR(3,2)                       CODI       90
      DIR(1,2)=-DIR(2,1)*DIR(3,3)+DIR(2,3)*DIR(3,1)                      CODI       91
      DIR(1,3)=DIR(2,1)*DIR(3,2)-DIR(2,2)*DIR(3,1)                       CODI       92
 1000 RETURN                                                             CODI       93
 1010 IERR=1                                                             CODI       94
      GO TO 1000                                                         CODI       95
      END                                                                CODI       96
*DECK COMMAT
      SUBROUTINE COMMAT                                                  COMMAT      2
C     TO COMPUTE CURRENT MATERIAL MATRIX FOR COMPOSITE ELEMENTS IN D21   COMMAT      3
C     REFERRED TO OVERALL AXES                                           COMMAT      4
C     FIND ELASTIC THERMAL EXPANSION COEFFICIENTS REFERRED TO LAMINA AXE COMMAT      5
CMAP10                                                                   COMMAT      6
      COMMON/COMEL/IN                                                    COMMAT      7
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  COMMAT      8
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     COMMAT      9
      EQUIVALENCE (IN,IA(1),AA(1))                                       COMMAT     10
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   COMMAT     11
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   COMMAT     12
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   COMMAT     13
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   COMMAT     14
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   COMMAT     15
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   COMMAT     16
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   COMMAT     17
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   COMMAT     18
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   COMMAT     19
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   COMMAT     20
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   COMMAT     21
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   COMMAT     22
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   COMMAT     23
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   COMMAT     24
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   COMMAT     25
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   COMMAT     26
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   COMMAT     27
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   COMMAT     28
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   COMMAT     29
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    COMMAT     30
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           COMMAT     31
CEND MAP10                                                               COMMAT     32
CMAP20                                                                   COMMAT     33
      DIMENSION LLL(27)                                                  COMMAT     34
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   COMMAT     35
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   COMMAT     36
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  COMMAT     37
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  COMMAT     38
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   COMMAT     39
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   COMMAT     40
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   COMMAT     41
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   COMMAT     42
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  COMMAT     43
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   COMMAT     44
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   COMMAT     45
CEND MAP20                                                               COMMAT     46
CMAP40                                                                   COMMAT     47
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            COMMAT     48
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       COMMAT     49
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), COMMAT     50
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         COMMAT     51
CEND MAP40                                                               COMMAT     52
      DIMENSION S66(6,6)                                                 COMMAT     53
      IIAI=IIA+2*(IMET-1)                                                COMMAT     54
      ALM=AA(IIAI+1)                                                     COMMAT     55
      ALF=AA(IIAI+2)                                                     COMMAT     56
      IIDI=IID+6*(IMET-1)                                                COMMAT     57
      VF=AA(IIDI+5)                                                      COMMAT     58
C IF VF=0., CURRENT ELEMENT IS ISOTROPIC                                 COMMAT     59
      IF(VF.EQ.0.) GO TO 70                                              COMMAT     60
      EM=AA(IIDI+1)                                                      COMMAT     61
      UM=AA(IIDI+2)                                                      COMMAT     62
      EF=AA(IIDI+3)                                                      COMMAT     63
      UF=AA(IIDI+4)                                                      COMMAT     64
      VM=1.-VF                                                           COMMAT     65
      PA=UM*EF-UF*EM                                                     COMMAT     66
      EC=VM*EM+VF*EF                                                     COMMAT     67
      AL1=VM*ALM+VF*ALF-VF*VM*PA*(ALF-ALM)/EC                            COMMAT     68
      AL2=AL1                                                            COMMAT     69
      AL3=(ALF*VF*EF+ALM*VM*EM)/EC                                       COMMAT     70
C     COMPUTE LAMINA AXES DIRECTION COSINES W.R.T. OVERALL AXES IN DIR   COMMAT     71
      CALL CODI                                                          COMMAT     72
      IF(INP.NE.2) GO TO 5                                               COMMAT     73
      IF(ITER.GT.1) GO TO 5                                              COMMAT     74
      WRITE(MO,1) M,((DIR(I,J),J=1,3),I=1,3)                             COMMAT     75
    1 FORMAT(//45H DIRECTION COSINES OF LAMINA AXES FOR ELEMENT,I5/      COMMAT     76
     18H AXIS-1%,3E15.6/8H AXIS-2%,3E15.6/8H AXIS-3%,3E15.6)             COMMAT     77
    5 IF(ITER.EQ.1 .AND. IYEL.GE.0) GO TO 10                             COMMAT     78
      YP=AA(LLL(7)+M)                                                    COMMAT     79
      IF(YP.GE.0.) GO TO 10                                              COMMAT     80
C     COMPUTE ELASTIC-PLASTIC COMPLIANCE MATRIX IN LAMINA AXES AN A      COMMAT     81
      CALL COMYEL                                                        COMMAT     82
      GO TO 30                                                           COMMAT     83
C     COMPUTE ELASTIC COMPLIANCE MATRIX IN LAMINA AXES IN A              COMMAT     84
   10 DO 20 I=1,6                                                        COMMAT     85
      DO 20 J=1,6                                                        COMMAT     86
   20 A(I,J)=0.                                                          COMMAT     87
      GM=EM/2./(1.+UM)                                                   COMMAT     88
      GF=EF/2./(1.+UF)                                                   COMMAT     89
      GC=VM/GM+VF/GF                                                     COMMAT     90
      UC=VM*UM+VF*UF                                                     COMMAT     91
      ET=VM/EM+VF/EF                                                     COMMAT     92
      A(1,1)=ET-VM*VF*PA*PA/EM/EF/EC                                     COMMAT     93
      A(2,2)=A(1,1)                                                      COMMAT     94
      A(3,3)=1./EC                                                       COMMAT     95
      A(1,2)=-VM*UM/EM-VF*UF/EF-VM*VF*PA*PA/EM/EF/EC                     COMMAT     96
      A(2,1)=A(1,2)                                                      COMMAT     97
      A(1,3)=-UC/EC                                                      COMMAT     98
      A(3,1)=A(1,3)                                                      COMMAT     99
      A(2,3)=-UC/EC                                                      COMMAT    100
      A(3,2)=A(2,3)                                                      COMMAT    101
      A(4,4)=GC                                                          COMMAT    102
      A(5,5)=GC                                                          COMMAT    103
      A(6,6)=GC                                                          COMMAT    104
C     COMPUTE COMPLIANCE MATRIX IN OVERALL COORDINATES                   COMMAT    105
   30 CALL TRANS                                                         COMMAT    106
      DO 40 I=1,6                                                        COMMAT    107
      DO 40 J=1,6                                                        COMMAT    108
      S66(I,J)=0.                                                        COMMAT    109
      DO 40 K=1,6                                                        COMMAT    110
   40 S66(I,J)=S66(I,J)+A(I,K)*E66(K,J)                                  COMMAT    111
      DO 50 I=1,6                                                        COMMAT    112
      DO 50 J=1,6                                                        COMMAT    113
      A(I,J)=0.                                                          COMMAT    114
      DO 50 K=1,6                                                        COMMAT    115
   50 A(I,J)=A(I,J)+E66(K,I)*S66(K,J)                                    COMMAT    116
C     COMPUTE MATERIAL MATRIX IN OVERALL AXES IN D21                     COMMAT    117
      CALL INV8(A,6,DETERM)                                              COMMAT    118
      K=0                                                                COMMAT    119
      DO 60 I=1,6                                                        COMMAT    120
      DO 60 J=I,6                                                        COMMAT    121
      K=K+1                                                              COMMAT    122
   60 D21(K)=A(I,J)                                                      COMMAT    123
      RETURN                                                             COMMAT    124
   70 CALL ISOMAT                                                        COMMAT    125
      RETURN                                                             COMMAT    126
      END                                                                COMMAT    127
*DECK COMYEL
      SUBROUTINE COMYEL                                                  COMYEL      2
C     TO COMPUTE ELASTIC-PLASTIC COMPLIANCE MATRIX IN LAMINA COOR IN A   COMYEL      3
CMAP10                                                                   COMYEL      4
      COMMON/COMEL/IN                                                    COMYEL      5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  COMYEL      6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     COMYEL      7
      EQUIVALENCE (IN,IA(1),AA(1))                                       COMYEL      8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   COMYEL      9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   COMYEL     10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   COMYEL     11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   COMYEL     12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   COMYEL     13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   COMYEL     14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   COMYEL     15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   COMYEL     16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   COMYEL     17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   COMYEL     18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   COMYEL     19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   COMYEL     20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   COMYEL     21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   COMYEL     22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   COMYEL     23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   COMYEL     24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   COMYEL     25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   COMYEL     26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   COMYEL     27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    COMYEL     28
      EQUIVALENCE     (IA(401), S(1))                                    COMYEL     29
CEND MAP10                                                               COMYEL     30
CMAP20                                                                   COMYEL     31
      DIMENSION LLL(27)                                                  COMYEL     32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   COMYEL     33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   COMYEL     34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  COMYEL     35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  COMYEL     36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   COMYEL     37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   COMYEL     38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   COMYEL     39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   COMYEL     40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  COMYEL     41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   COMYEL     42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   COMYEL     43
CEND MAP20                                                               COMYEL     44
CMAP40                                                                   COMYEL     45
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            COMYEL     46
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       COMYEL     47
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), COMYEL     48
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         COMYEL     49
CEND MAP40                                                               COMYEL     50
      DIMENSION SP(6),AS(6)                                              COMYEL     51
      YP=AA(LLL(7)+M)                                                    COMYEL     52
      NI=NI+1                                                            COMYEL     53
      IIDI=IID+6*(IMET-1)                                                COMYEL     54
      VF=AA(IIDI+5)                                                      COMYEL     55
      EM=AA(IIDI+1)                                                      COMYEL     56
      UM=AA(IIDI+2)                                                      COMYEL     57
      EF=AA(IIDI+3)                                                      COMYEL     58
      UF=AA(IIDI+4)                                                      COMYEL     59
      VM=1.-VF                                                           COMYEL     60
      PA=UM*EF-UF*EM                                                     COMYEL     61
      EC=VM*EM+VF*EF                                                     COMYEL     62
      GM=EM/2./(1.+UM)                                                   COMYEL     63
      GF=EF/2./(1.+UF)                                                   COMYEL     64
      GC=VM/GM+VF/GF                                                     COMYEL     65
      UC=VM*UM+VF*UF                                                     COMYEL     66
      ET=VM/EM+VF/EF                                                     COMYEL     67
      ES=AA(LLL(8)+M)                                                    COMYEL     68
      DO 10 I=1,6                                                        COMYEL     69
      SP(I)=AA(LLL(9+I)+M)                                               COMYEL     70
   10 AS(I)=AA(LLL(15+I)+M)                                              COMYEL     71
      IF(KHARD.NE.0) GO TO 20                                            COMYEL     72
      H=0.                                                               COMYEL     73
      GO TO 60                                                           COMYEL     74
   20 IF(IHARD.NE.0) GO TO 30                                            COMYEL     75
      CALL YHAR2P (ES,IMET,H)                                            COMYEL     76
      GO TO 60                                                           COMYEL     77
   30 KS=LHD+IMAT+(IMET-1)*20*IHARD+10*IHARD                             COMYEL     78
      K=IA(LHD+IMET)                                                     COMYEL     79
      KE=KS-10*IHARD                                                     COMYEL     80
      DO 40 I=2,K                                                        COMYEL     81
   40 IF(ES.LT.AA(KS+I)) GO TO 50                                        COMYEL     82
      I=I-1                                                              COMYEL     83
   50 H=(AA(KS+I)-AA(KS+I-1))/(AA(KE+I)-AA(KE+I-1))                      COMYEL     84
   60 Q=2.*(SP(3)-AS(3))-(SP(1)-AS(1))-(SP(2)-AS(2))                     COMYEL     85
      Q=Q/6./(YP*YP+3.*((SP(4)-AS(4))**2+(SP(5)-AS(5))**2+(SP(6)-AS(6))  COMYEL     86
     1**2))                                                              COMYEL     87
      Q1=Q*(2.*(SP(1)-AS(1))-(SP(2)-AS(2))-(SP(3)-AS(3)))                COMYEL     88
      Q2=Q*(2.*(SP(2)-AS(2))-(SP(1)-AS(1))-(SP(3)-AS(3)))                COMYEL     89
      Q3=Q*(2.*(SP(3)-AS(3))-(SP(1)-AS(1))-(SP(2)-AS(2)))                COMYEL     90
      Q4=Q*6.*(SP(4)-AS(4))                                              COMYEL     91
      Q5=Q*6.*(SP(5)-AS(5))                                              COMYEL     92
      Q6=Q*6.*(SP(6)-AS(6))                                              COMYEL     93
      RR=H*EC+VF*EF*EM*Q3                                                COMYEL     94
      R11=VF*(H*PA-EF*EM*Q1)/RR                                          COMYEL     95
      R22=VF*(H*PA-EF*EM*Q2)/RR                                          COMYEL     96
      R33=H*EM/RR                                                        COMYEL     97
      R12=-VF*EF*EM*Q4/RR                                                COMYEL     98
      R13=-VF*EF*EM*Q5/RR                                                COMYEL     99
      R23=-VF*EF*EM*Q6/RR                                                COMYEL    100
      A(1,1)=ET-VM*PA*R11/EF/EM+VM*Q1*(VF*PA-EC*R11)/VF/EF/EM/Q3         COMYEL    101
      A(1,2)=-VM*UM/EM-VF*UF/EF-VM*PA*R11/EF/EM+VM*Q2*(VF*PA-EC*R11)/    COMYEL    102
     1VF/EF/EM/Q3                                                        COMYEL    103
      A(1,3)=-UF/EF-VM*R11/VF/EF                                         COMYEL    104
      A(1,4)=VM*Q4*(VF*PA-EC*R11)/VF/EF/EM/Q3                            COMYEL    105
      A(1,5)=A(1,4)*Q5/Q4                                                COMYEL    106
      A(1,6)=A(1,4)*Q6/Q4                                                COMYEL    107
      A(2,2)=ET-VM*PA*R22/EF/EM+VM*Q2*(VF*PA-EC*R22)/VF/EF/EM/Q3         COMYEL    108
      A(2,3)=-UF/EF-VM*R22/VF/EF                                         COMYEL    109
      A(2,4)=VM*Q4*(VF*PA-EC*R22)/VF/EF/EM/Q3                            COMYEL    110
      A(2,5)=A(2,4)*Q5/Q4                                                COMYEL    111
      A(2,6)=A(2,4)*Q6/Q4                                                COMYEL    112
      A(3,3)=(1.-VM*R33)/VF/EF                                           COMYEL    113
      A(3,4)=VM*Q4*(EM-EC*R33)/VF/EF/EM/Q3                               COMYEL    114
      A(3,5)=A(3,4)*Q5/Q4                                                COMYEL    115
      A(3,6)=A(3,4)*Q6/Q4                                                COMYEL    116
      A(4,4)=GC-VM*EC*Q4*R12/VF/EF/EM/Q3                                 COMYEL    117
      A(4,5)=-VM*EC*Q5*R12/VF/EF/EM/Q3                                   COMYEL    118
      A(4,6)=A(4,5)*Q6/Q5                                                COMYEL    119
      A(5,5)=GC-VM*EC*Q5*R13/VF/EF/EM/Q3                                 COMYEL    120
      A(5,6)=-VM*EC*Q6*R13/VF/EF/EM/Q3                                   COMYEL    121
      A(6,6)=GC-VM*EC*Q6*R23/VF/EF/EM/Q3                                 COMYEL    122
      DO 70 I=2,6                                                        COMYEL    123
      I1=I-1                                                             COMYEL    124
      DO 70 J=1,I1                                                       COMYEL    125
   70 A(I,J)=A(J,I)                                                      COMYEL    126
      RETURN                                                             COMYEL    127
      END                                                                COMYEL    128
*DECK CUTE
      SUBROUTINE CUTE                                                    CUTE        2
C     CUTS HEXAHEDRONS INTO TETRAHEDRONS                                 CUTE        3
CMAP10                                                                   CUTE        4
      COMMON/COMEL/IN                                                    CUTE        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  CUTE        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     CUTE        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       CUTE        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   CUTE        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   CUTE       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   CUTE       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   CUTE       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   CUTE       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   CUTE       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   CUTE       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   CUTE       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   CUTE       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   CUTE       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   CUTE       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   CUTE       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   CUTE       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   CUTE       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   CUTE       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   CUTE       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   CUTE       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   CUTE       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   CUTE       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    CUTE       28
      EQUIVALENCE     (IA(401), S(1))                                    CUTE       29
CEND MAP10                                                               CUTE       30
CMAP40                                                                   CUTE       31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            CUTE       32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       CUTE       33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), CUTE       34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         CUTE       35
CEND MAP40                                                               CUTE       36
      NAV=NAV+1                                                          CUTE       37
      KBAS=0                                                             CUTE       38
      KNOO=0                                                             CUTE       39
      IF (NAV.LE.2) GO TO 130                                            CUTE       40
      KBAS=4                                                             CUTE       41
  130 DO 400 J=1,20                                                      CUTE       42
      KNOOJ=KNOO+J                                                       CUTE       43
      GO TO (210,240,220,270,230,220,240,250,240,280,250,270,220,250,260 CUTE       44
     1,270,220,240,250,270),J                                            CUTE       45
  210 KBASJ=KBAS+1                                                       CUTE       46
      GO TO 310                                                          CUTE       47
  220 KBASJ=KBAS+2                                                       CUTE       48
      GO TO 310                                                          CUTE       49
  230 KBASJ=KBAS+3                                                       CUTE       50
      GO TO 310                                                          CUTE       51
  240 KBASJ=KBAS+4                                                       CUTE       52
      GO TO 310                                                          CUTE       53
  250 KBASJ=KBAS+5                                                       CUTE       54
      GO TO 310                                                          CUTE       55
  260 KBASJ=KBAS+6                                                       CUTE       56
      GO TO 310                                                          CUTE       57
  270 KBASJ=KBAS+7                                                       CUTE       58
      GO TO 310                                                          CUTE       59
  280 KBASJ=KBAS+8                                                       CUTE       60
  310 IF(KBASJ-8) 330,330,320                                            CUTE       61
  320 KBASJ=KBASJ-8                                                      CUTE       62
      GO TO 310                                                          CUTE       63
  330 NOO(KNOOJ)=N(KBASJ)                                                CUTE       64
  400 CONTINUE                                                           CUTE       65
      RETURN                                                             CUTE       66
      END                                                                CUTE       67
*DECK DMM
      SUBROUTINE DMM (A,B,M,C)                                           DMM         2
C     OBTAINS THE PRODUCT OF ELEMENT STIFFNESS MATRIX TIMES A VECTOR     DMM         3
      DIMENSION A(1),B(1),C(1)                                           DMM         4
      DO 10 I=1,M                                                        DMM         5
      ISS=I-M                                                            DMM         6
      DO 9 K=1,M                                                         DMM         7
      ISS=ISS+M                                                          DMM         8
 9    C(I)=C(I)+A(ISS)*B(K)                                              DMM         9
 10   CONTINUE                                                           DMM        10
      RETURN                                                             DMM        11
      END                                                                DMM        12
*DECK ELCOR
      SUBROUTINE ELCOR(JI)                                               ELCOR       2
C     TO GENERATE ELEMENT VERTEX COORDINATES OF THE 5 TETRAHEDRONS       ELCOR       3
C     FORMING THE HEXAHEDRAL ELEMENT                                     ELCOR       4
C     JI=POINTER FOR VERTEX LABELS OF THE CURRENT TETRAHEDRON IN         ELCOR       5
C     ARRAY NOO                                                          ELCOR       6
CMAP10                                                                   ELCOR       7
      COMMON/COMEL/IN                                                    ELCOR       8
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ELCOR       9
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ELCOR      10
      EQUIVALENCE (IN,IA(1),AA(1))                                       ELCOR      11
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ELCOR      12
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ELCOR      13
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ELCOR      14
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ELCOR      15
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ELCOR      16
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ELCOR      17
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ELCOR      18
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ELCOR      19
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ELCOR      20
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ELCOR      21
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ELCOR      22
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ELCOR      23
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ELCOR      24
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ELCOR      25
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ELCOR      26
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ELCOR      27
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ELCOR      28
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ELCOR      29
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ELCOR      30
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ELCOR      31
      EQUIVALENCE     (IA(401), S(1))                                    ELCOR      32
CEND MAP10                                                               ELCOR      33
CMAP40                                                                   ELCOR      34
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            ELCOR      35
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       ELCOR      36
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), ELCOR      37
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         ELCOR      38
CEND MAP40                                                               ELCOR      39
      CX=0.                                                              ELCOR      40
      CY=0.                                                              ELCOR      41
      CZ=0.                                                              ELCOR      42
      DO 5500 I=1,4                                                      ELCOR      43
      JII=JI+I                                                           ELCOR      44
      J=NOO(JII)                                                         ELCOR      45
      N(I)=J                                                             ELCOR      46
      IF (J) 1,1,5450                                                    ELCOR      47
 5450 IXXJ=IXX+J                                                         ELCOR      48
      IYYJ=IYY+J                                                         ELCOR      49
      IZZJ=IZZ+J                                                         ELCOR      50
      X(I)=AA(IXXJ)                                                      ELCOR      51
      Y(I)=AA(IYYJ)                                                      ELCOR      52
      Z(I)=AA(IZZJ)                                                      ELCOR      53
      CX=CX+X(I)                                                         ELCOR      54
      CY=CY+Y(I)                                                         ELCOR      55
      CZ=CZ+Z(I)                                                         ELCOR      56
      IF (I-1) 5500,5500,5460                                            ELCOR      57
 5460 XD(I-1)=X(I)-X(1)                                                  ELCOR      58
      YD(I-1)=Y(I)-Y(1)                                                  ELCOR      59
      ZD(I-1)=Z(I)-Z(1)                                                  ELCOR      60
 5500 CONTINUE                                                           ELCOR      61
C     FIND COORDINATES W.R.T. AXES AT THE GEOMETRIC CENTER OF THE        ELCOR      62
C     TETRAHEDRON AND PARALLEL TO OVERALL AXES                           ELCOR      63
      CX=CX/4.0                                                          ELCOR      64
      CY=CY/4.0                                                          ELCOR      65
      CZ=CZ/4.0                                                          ELCOR      66
      DO 5501 I=1,4                                                      ELCOR      67
      X(I)=X(I)-CX                                                       ELCOR      68
      Y(I)=Y(I)-CY                                                       ELCOR      69
 5501 Z(I)=Z(I)-CZ                                                       ELCOR      70
 5600 RETURN                                                             ELCOR      71
 1    IERR=2                                                             ELCOR      72
      GO TO 5600                                                         ELCOR      73
      END                                                                ELCOR      74
*DECK ELMT2P
      SUBROUTINE ELMT2P                                                  ELMT2P      2
C     TO COMPUTE CURRENT MATERIAL MATRIX IN D21                          ELMT2P      3
CMAP10                                                                   ELMT2P      4
      COMMON/COMEL/IN                                                    ELMT2P      5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ELMT2P      6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ELMT2P      7
      EQUIVALENCE (IN,IA(1),AA(1))                                       ELMT2P      8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ELMT2P      9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ELMT2P     10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ELMT2P     11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ELMT2P     12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ELMT2P     13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ELMT2P     14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ELMT2P     15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ELMT2P     16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ELMT2P     17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ELMT2P     18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ELMT2P     19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ELMT2P     20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ELMT2P     21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ELMT2P     22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ELMT2P     23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ELMT2P     24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ELMT2P     25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ELMT2P     26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ELMT2P     27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ELMT2P     28
      EQUIVALENCE     (IA(401), S(1))                                    ELMT2P     29
CEND MAP10                                                               ELMT2P     30
CMAP20                                                                   ELMT2P     31
      DIMENSION LLL(27)                                                  ELMT2P     32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   ELMT2P     33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   ELMT2P     34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  ELMT2P     35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  ELMT2P     36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   ELMT2P     37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   ELMT2P     38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   ELMT2P     39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   ELMT2P     40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  ELMT2P     41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   ELMT2P     42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   ELMT2P     43
CEND MAP20                                                               ELMT2P     44
CMAP40                                                                   ELMT2P     45
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            ELMT2P     46
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       ELMT2P     47
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), ELMT2P     48
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         ELMT2P     49
CEND MAP40                                                               ELMT2P     50
      IF(ITYPE-1) 10,20,20                                               ELMT2P     51
   10 CALL ISOMAT                                                        ELMT2P     52
      GO TO 30                                                           ELMT2P     53
   20 CALL COMMAT                                                        ELMT2P     54
   30 IF (INP.NE.2) RETURN                                               ELMT2P     55
      WRITE(MO,40) M,ITER,(D21(I),I=1,21)                                ELMT2P     56
   40 FORMAT(///1X,27HMATERIAL MATRIX FOR ELEMENT,I5,2X,5HSTEP%,I4,      ELMT2P     57
     12X,33H(FOR STIFFNESS MATRIX GENERATION)/6E15.6/15X,5E15.6/30X,     ELMT2P     58
     24E15.6/45X,3E15.6/60X,2E15.6/75X,E15.6)                            ELMT2P     59
      RETURN                                                             ELMT2P     60
      END                                                                ELMT2P     61
*DECK ELPTY
      SUBROUTINE ELPTY                                                   ELPTY       2
C     TO GENERATE ELEMENT PROPERTIES OTHER THAN COORS. AND MATERIAL      ELPTY       3
CMAP10                                                                   ELPTY       4
      COMMON/COMEL/IN                                                    ELPTY       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ELPTY       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ELPTY       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       ELPTY       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ELPTY       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ELPTY      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ELPTY      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ELPTY      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ELPTY      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ELPTY      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ELPTY      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ELPTY      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ELPTY      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ELPTY      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ELPTY      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ELPTY      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ELPTY      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ELPTY      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ELPTY      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ELPTY      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ELPTY      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ELPTY      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ELPTY      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ELPTY      28
      EQUIVALENCE     (IA(401), S(1))                                    ELPTY      29
CEND MAP10                                                               ELPTY      30
      IF (ITEM) 972,972,971                                              ELPTY      31
  971 IDTI=IDT+ITEM                                                      ELPTY      32
      DT=AA(IDTI)                                                        ELPTY      33
  972 IF(JPRS) 979,979,977                                               ELPTY      34
  977 IPRI=IPR+JPRS                                                      ELPTY      35
      PRES=AA(IPRI)                                                      ELPTY      36
 979  RETURN                                                             ELPTY      37
      END                                                                ELPTY      38
*DECK INV8
      SUBROUTINE INV8 (A,N,DETERM)                                       INV8        2
C     INVERTS MATRICES OF ORDER 6 BY GAUSS ELIMINATION                   INV8        3
      DIMENSION IPIVOT(6),A(6,6),INDEX(6,2),PIVOT(6)                     INV8        4
      EQUIVALENCE (IROW,JROW),(ICOLUM,JCOLUM),(AMAX,T,SWAP)              INV8        5
C                                                                        INV8        6
C     INITIALIZATION                                                     INV8        7
C                                                                        INV8        8
      DETERM=1.0                                                         INV8        9
      DO 20 J=1,N                                                        INV8       10
   20 IPIVOT(J)=0                                                        INV8       11
      BB=1.E-30                                                          INV8       12
      GO TO 9003                                                         INV8       13
 9002 DETERM=0.0                                                         INV8       14
      GO TO 740                                                          INV8       15
 9003 CONTINUE                                                           INV8       16
      DO 550 I=1,N                                                       INV8       17
C                                                                        INV8       18
C     SEARCH FOR PIVOT ELEMENT                                           INV8       19
C                                                                        INV8       20
      AMAX=0.0                                                           INV8       21
      DO 105 J=1,N                                                       INV8       22
      IF(IPIVOT(J)-1) 60,105,60                                          INV8       23
   60 DO 100 K=1,N                                                       INV8       24
      IF(IPIVOT(K)-1) 80,100,9002                                        INV8       25
   80 IF(ABS(AMAX)-ABS(A(J,K))) 85,100,100                               INV8       26
   85 IROW=J                                                             INV8       27
      ICOLUM=K                                                           INV8       28
      AMAX=A(J,K)                                                        INV8       29
  100 CONTINUE                                                           INV8       30
  105 CONTINUE                                                           INV8       31
      IF(ABS(AMAX)-BB) 9002,9002,110                                     INV8       32
  110 IPIVOT(ICOLUM)=IPIVOT(ICOLUM)+1                                    INV8       33
C                                                                        INV8       34
C     INTERCHANGE ROWS TO PUT PIVOT ELEMENT ON DIAGONAL                  INV8       35
C                                                                        INV8       36
      IF(IROW-ICOLUM) 140,260,140                                        INV8       37
  140 DETERM=-DETERM                                                     INV8       38
      DO 200 L=1,N                                                       INV8       39
      SWAP=A(IROW,L)                                                     INV8       40
      A(IROW,L)=A(ICOLUM,L)                                              INV8       41
  200 A(ICOLUM,L)=SWAP                                                   INV8       42
  260 INDEX(I,1)=IROW                                                    INV8       43
      INDEX(I,2)=ICOLUM                                                  INV8       44
      PIVOT(I)=A(ICOLUM,ICOLUM)                                          INV8       45
      DETERM=DETERM*PIVOT(I)                                             INV8       46
C                                                                        INV8       47
C     DIVIDE PIVOT ROW BY PIVOT ELEMENT                                  INV8       48
C                                                                        INV8       49
      A(ICOLUM,ICOLUM)=1.0                                               INV8       50
      DO 350 L=1,N                                                       INV8       51
  350 A(ICOLUM,L)=A(ICOLUM,L)/PIVOT(I)                                   INV8       52
C                                                                        INV8       53
C     REDUCE NON-PIVOT ROWS                                              INV8       54
C                                                                        INV8       55
      DO 550 L1=1,N                                                      INV8       56
      IF(L1-ICOLUM) 400,550,400                                          INV8       57
  400 T=A(L1,ICOLUM)                                                     INV8       58
      A(L1,ICOLUM)=0.0                                                   INV8       59
      DO 450 L=1,N                                                       INV8       60
  450 A(L1,L)=A(L1,L)-A(ICOLUM,L)*T                                      INV8       61
  550 CONTINUE                                                           INV8       62
C                                                                        INV8       63
C     INTERCHANGE COLUMNS                                                INV8       64
C                                                                        INV8       65
      DO 710 I=1,N                                                       INV8       66
      L=N+1-I                                                            INV8       67
      IF(INDEX(L,1)-INDEX(L,2)) 630,710,630                              INV8       68
  630 JROW=INDEX(L,1)                                                    INV8       69
      JCOLUM=INDEX(L,2)                                                  INV8       70
      DO 705 K=1,N                                                       INV8       71
      SWAP=A(K,JROW)                                                     INV8       72
      A(K,JROW)=A(K,JCOLUM)                                              INV8       73
      A(K,JCOLUM)=SWAP                                                   INV8       74
  705 CONTINUE                                                           INV8       75
  710 CONTINUE                                                           INV8       76
  740 RETURN                                                             INV8       77
      END                                                                INV8       78
*DECK ISOMAT
      SUBROUTINE ISOMAT                                                  ISOMAT      2
C     TO COMPUTE CURRENT MATERIAL MATRIX FOR ISOTROPIC ELEMENTS IN D21   ISOMAT      3
C     FIND ELASTIC THERMAL EXPANSION COEFFICIENTS                        ISOMAT      4
CMAP10                                                                   ISOMAT      5
      COMMON/COMEL/IN                                                    ISOMAT      6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ISOMAT      7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ISOMAT      8
      EQUIVALENCE (IN,IA(1),AA(1))                                       ISOMAT      9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ISOMAT     10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ISOMAT     11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ISOMAT     12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ISOMAT     13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ISOMAT     14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ISOMAT     15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ISOMAT     16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ISOMAT     17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ISOMAT     18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ISOMAT     19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ISOMAT     20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ISOMAT     21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ISOMAT     22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ISOMAT     23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ISOMAT     24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ISOMAT     25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ISOMAT     26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ISOMAT     27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ISOMAT     28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ISOMAT     29
      EQUIVALENCE     (IA(401), S(1))                                    ISOMAT     30
CEND MAP10                                                               ISOMAT     31
CMAP20                                                                   ISOMAT     32
      DIMENSION LLL(27)                                                  ISOMAT     33
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   ISOMAT     34
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   ISOMAT     35
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  ISOMAT     36
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  ISOMAT     37
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   ISOMAT     38
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   ISOMAT     39
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   ISOMAT     40
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   ISOMAT     41
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  ISOMAT     42
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   ISOMAT     43
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   ISOMAT     44
CEND MAP20                                                               ISOMAT     45
      AL1=AA(IIA+IMET)                                                   ISOMAT     46
      AL2=AL1                                                            ISOMAT     47
      AL3=AL1                                                            ISOMAT     48
      IF(ITER.EQ.1 .AND. IYEL.GE.0) GO TO 10                             ISOMAT     49
      YP=AA(LLL(7)+M)                                                    ISOMAT     50
      IF(YP.GE.0.) GO TO 10                                              ISOMAT     51
C     COMPUTE ELASTIC-PLASTIC MATERIAL MATRIX                            ISOMAT     52
      CALL ISOYEL                                                        ISOMAT     53
      RETURN                                                             ISOMAT     54
C     COMPUTE ELASTIC MATERIAL MATRIX                                    ISOMAT     55
   10 N2=2                                                               ISOMAT     56
      IF(ITYPE.EQ.1) N2=6                                                ISOMAT     57
      IIDI=IID+(IMET-1)*N2                                               ISOMAT     58
      EE=AA(IIDI+1)                                                      ISOMAT     59
      PU=AA(IIDI+2)                                                      ISOMAT     60
      GG=EE/2./(1.+PU)                                                   ISOMAT     61
      DO 20 I=1,21                                                       ISOMAT     62
   20 D21(I)=0.                                                          ISOMAT     63
      D21(1)=2.*GG*(1.-PU)/(1.-2.*PU)                                    ISOMAT     64
      D21(2)=D21(1)*PU/(1.-PU)                                           ISOMAT     65
      D21(3)=D21(2)                                                      ISOMAT     66
      D21(7)=D21(1)                                                      ISOMAT     67
      D21(8)=D21(2)                                                      ISOMAT     68
      D21(12)=D21(1)                                                     ISOMAT     69
      D21(16)=GG                                                         ISOMAT     70
      D21(19)=GG                                                         ISOMAT     71
      D21(21)=GG                                                         ISOMAT     72
      RETURN                                                             ISOMAT     73
      END                                                                ISOMAT     74
*DECK ISOYEL
      SUBROUTINE ISOYEL                                                  ISOYEL      2
C     TO COMPUTE CURRENT ELASTIC-PLASTIC MATERIAL MATRIX FOR ISOTROPIC   ISOYEL      3
C     ELEMENTS IN D21                                                    ISOYEL      4
CMAP10                                                                   ISOYEL      5
      COMMON/COMEL/IN                                                    ISOYEL      6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ISOYEL      7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ISOYEL      8
      EQUIVALENCE (IN,IA(1),AA(1))                                       ISOYEL      9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ISOYEL     10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ISOYEL     11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ISOYEL     12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ISOYEL     13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ISOYEL     14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ISOYEL     15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ISOYEL     16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ISOYEL     17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ISOYEL     18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ISOYEL     19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ISOYEL     20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ISOYEL     21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ISOYEL     22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ISOYEL     23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ISOYEL     24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ISOYEL     25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ISOYEL     26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ISOYEL     27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ISOYEL     28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ISOYEL     29
      EQUIVALENCE     (IA(401), S(1))                                    ISOYEL     30
CEND MAP10                                                               ISOYEL     31
CMAP20                                                                   ISOYEL     32
      DIMENSION LLL(27)                                                  ISOYEL     33
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   ISOYEL     34
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   ISOYEL     35
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  ISOYEL     36
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  ISOYEL     37
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   ISOYEL     38
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   ISOYEL     39
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   ISOYEL     40
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   ISOYEL     41
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  ISOYEL     42
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   ISOYEL     43
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   ISOYEL     44
CEND MAP20                                                               ISOYEL     45
CMAP40                                                                   ISOYEL     46
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            ISOYEL     47
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       ISOYEL     48
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), ISOYEL     49
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         ISOYEL     50
CEND MAP40                                                               ISOYEL     51
      DIMENSION SP(6),AS(6)                                              ISOYEL     52
      YP=AA(LLL(7)+M)                                                    ISOYEL     53
      NI=NI+1                                                            ISOYEL     54
      N2=2                                                               ISOYEL     55
      IF(ITYPE.EQ.1) N2=6                                                ISOYEL     56
      IIDI=IID+(IMET-1)*N2                                               ISOYEL     57
      EE=AA(IIDI+1)                                                      ISOYEL     58
      PU=AA(IIDI+2)                                                      ISOYEL     59
      GG=EE/2./(1.+PU)                                                   ISOYEL     60
      ES=AA(LLL(8)+M)                                                    ISOYEL     61
      DO 10 I=1,6                                                        ISOYEL     62
      SP(I)=AA(LLL(I)+M)                                                 ISOYEL     63
   10 AS(I)=AA(LLL(9+I)+M)                                               ISOYEL     64
      IF(IHARD.NE.0) GO TO 20                                            ISOYEL     65
      CALL YHAR2P (ES,IMET,H)                                            ISOYEL     66
      GO TO 50                                                           ISOYEL     67
   20 KS=LHD+IMAT+(IMET-1)*20*IHARD+10*IHARD                             ISOYEL     68
      K=IA(LHD+IMET)                                                     ISOYEL     69
      KE=KS-10*IHARD                                                     ISOYEL     70
      DO 30 I=2,K                                                        ISOYEL     71
   30 IF(ES.LT.AA(KS+I)) GO TO 40                                        ISOYEL     72
      I=I-1                                                              ISOYEL     73
   40 H=(AA(KS+I)-AA(KS+I-1))/(AA(KE+I)-AA(KE+I-1))                      ISOYEL     74
   50 Q=2.*(SP(3)-AS(3))-(SP(1)-AS(1))-(SP(2)-AS(2))                     ISOYEL     75
      Q=Q/6./(YP*YP+3.*((SP(4)-AS(4))**2+(SP(5)-AS(5))**2+(SP(6)-AS(6))  ISOYEL     76
     1**2))                                                              ISOYEL     77
      Q1=Q*(2.*(SP(1)-AS(1))-(SP(2)-AS(2))-(SP(3)-AS(3)))                ISOYEL     78
      Q2=Q*(2.*(SP(2)-AS(2))-(SP(1)-AS(1))-(SP(3)-AS(3)))                ISOYEL     79
      Q3=Q*(2.*(SP(3)-AS(3))-(SP(1)-AS(1))-(SP(2)-AS(2)))                ISOYEL     80
      Q4=Q*6.*(SP(4)-AS(4))                                              ISOYEL     81
      Q5=Q*6.*(SP(5)-AS(5))                                              ISOYEL     82
      Q6=Q*6.*(SP(6)-AS(6))                                              ISOYEL     83
      A(1,1)=Q1**2/Q3/H+1./EE                                            ISOYEL     84
      A(1,2)=Q1*Q2/Q3/H-PU/EE                                            ISOYEL     85
      A(1,3)=Q1/H-PU/EE                                                  ISOYEL     86
      A(1,4)=Q1*Q4/Q3/H                                                  ISOYEL     87
      A(1,5)=Q1*Q5/Q3/H                                                  ISOYEL     88
      A(1,6)=Q1*Q6/Q3/H                                                  ISOYEL     89
      A(2,2)=Q2**2/Q3/H+1./EE                                            ISOYEL     90
      A(2,3)=Q2/H-PU/EE                                                  ISOYEL     91
      A(2,4)=Q2*Q4/Q3/H                                                  ISOYEL     92
      A(2,5)=Q2*Q5/Q3/H                                                  ISOYEL     93
      A(2,6)=Q2*Q6/Q3/H                                                  ISOYEL     94
      A(3,3)=Q3/H+1./EE                                                  ISOYEL     95
      A(3,4)=Q4/H                                                        ISOYEL     96
      A(3,5)=Q5/H                                                        ISOYEL     97
      A(3,6)=Q6/H                                                        ISOYEL     98
      A(4,4)=Q4**2/Q3/H+1./GG                                            ISOYEL     99
      A(4,5)=Q4*Q5/Q3/H                                                  ISOYEL    100
      A(4,6)=Q4*Q6/Q3/H                                                  ISOYEL    101
      A(5,5)=Q5**2/Q3/H+1./GG                                            ISOYEL    102
      A(5,6)=Q5*Q6/Q3/H                                                  ISOYEL    103
      A(6,6)=Q6**2/Q3/H+1./GG                                            ISOYEL    104
      DO 60 I=2,6                                                        ISOYEL    105
      I1=I-1                                                             ISOYEL    106
      DO 60 J=1,I1                                                       ISOYEL    107
   60 A(I,J)=A(J,I)                                                      ISOYEL    108
      CALL INV8(A,6,DETERM)                                              ISOYEL    109
      K=0                                                                ISOYEL    110
      DO 70 I=1,6                                                        ISOYEL    111
      DO 70 J=I,6                                                        ISOYEL    112
      K=K+1                                                              ISOYEL    113
   70 D21(K)=A(I,J)                                                      ISOYEL    114
      RETURN                                                             ISOYEL    115
      END                                                                ISOYEL    116
*DECK TDEF
      SUBROUTINE TDEF                                                    TDEF        2
C     TO COMPUTE DEFLECTIONS DUE TO ELASTIC PORTION OF THERMAL STRAINS   TDEF        3
C     FOR COMPOSITE TETRAHEDRONS IN OVERALL AXES                         TDEF        4
CMAP10                                                                   TDEF        5
      COMMON/COMEL/IN                                                    TDEF        6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TDEF        7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TDEF        8
      EQUIVALENCE (IN,IA(1),AA(1))                                       TDEF        9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TDEF       10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TDEF       11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TDEF       12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TDEF       13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TDEF       14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TDEF       15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TDEF       16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TDEF       17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TDEF       18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TDEF       19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TDEF       20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TDEF       21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TDEF       22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TDEF       23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TDEF       24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TDEF       25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TDEF       26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TDEF       27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TDEF       28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TDEF       29
      EQUIVALENCE     (IA(401), S(1))                                    TDEF       30
CEND MAP10                                                               TDEF       31
CMAP40                                                                   TDEF       32
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            TDEF       33
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       TDEF       34
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), TDEF       35
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         TDEF       36
CEND MAP40                                                               TDEF       37
      DO 10 I=1,4                                                        TDEF       38
      I1=I+4                                                             TDEF       39
      I2=I1+4                                                            TDEF       40
      UV(12+I)=(DIR(1,1)*X(I)+DIR(1,2)*Y(I)+DIR(1,3)*Z(I))*DT*AL1        TDEF       41
      UV(12+I1)=(DIR(2,1)*X(I)+DIR(2,2)*Y(I)+DIR(2,3)*Z(I))*DT*AL2       TDEF       42
      UV(12+I2)=(DIR(3,1)*X(I)+DIR(3,2)*Y(I)+DIR(3,3)*Z(I))*DT*AL3       TDEF       43
      UV(I)=DIR(1,1)*UV(12+I)+DIR(2,1)*UV(12+I1)+DIR(3,1)*UV(12+I2)      TDEF       44
      UV(I1)=DIR(1,2)*UV(12+I)+DIR(2,2)*UV(12+I1)+DIR(3,2)*UV(12+I2)     TDEF       45
      UV(I2)=DIR(1,3)*UV(12+I)+DIR(2,3)*UV(12+I1)+DIR(3,3)*UV(12+I2)     TDEF       46
   10 CONTINUE                                                           TDEF       47
      RETURN                                                             TDEF       48
      END                                                                TDEF       49
*DECK TETRA
      SUBROUTINE TETRA                                                   TETRA       2
C     GENERATES STIFFNESS AND LOAD MATRICES FOR TETRAHEDRAL ELEMENTS     TETRA       3
CMAP10                                                                   TETRA       4
      COMMON/COMEL/IN                                                    TETRA       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TETRA       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TETRA       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TETRA       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TETRA       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TETRA      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TETRA      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TETRA      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TETRA      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TETRA      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TETRA      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TETRA      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TETRA      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TETRA      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TETRA      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TETRA      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TETRA      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TETRA      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TETRA      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TETRA      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TETRA      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TETRA      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TETRA      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TETRA      28
      EQUIVALENCE     (IA(401), S(1))                                    TETRA      29
CEND MAP10                                                               TETRA      30
CMAP40                                                                   TETRA      31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            TETRA      32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       TETRA      33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), TETRA      34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         TETRA      35
CEND MAP40                                                               TETRA      36
      DIMENSION AT(4,4),B(3,3),Q(4,4)                                    TETRA      37
      DIMENSION NN(3,6)                                                  TETRA      38
      DATA NN/ 010405,041617,051719, 040206,160918,171020,               TETRA      39
     1         050603,171813,192014, 160918,090711,181121,               TETRA      40
     2         171813,101108,202115, 192014,202115,141512 /              TETRA      41
      DET=-XD(1)*(YD(2)*ZD(3)-YD(3)*ZD(2))+YD(1)*(XD(2)*ZD(3)-XD(3)*ZD(2 TETRA      42
     1))-ZD(1)*(XD(2)*YD(3)-XD(3)*YD(2))                                 TETRA      43
      IF (DET) 1010,1010,720                                             TETRA      44
  720 VOL=1.0/(6.0*DET)                                                  TETRA      45
      AT(1,1)=((YD(2)-YD(1))*(ZD(3)-ZD(1))-(YD(3)-YD(1))*(ZD(2)-ZD(1)))  TETRA      46
      AT(1,2)=(-YD(2)*ZD(3)+YD(3)*ZD(2))                                 TETRA      47
      AT(1,3)=( YD(1)*ZD(3)-YD(3)*ZD(1))                                 TETRA      48
      AT(1,4)=(-YD(1)*ZD(2)+YD(2)*ZD(1))                                 TETRA      49
      AT(2,1)=(-(XD(2)-XD(1))*(ZD(3)-ZD(1))+(XD(3)-XD(1))*(ZD(2)-ZD(1))) TETRA      50
      AT(2,2)=( XD(2)*ZD(3)-XD(3)*ZD(2))                                 TETRA      51
      AT(2,3)=(-XD(1)*ZD(3)+XD(3)*ZD(1))                                 TETRA      52
      AT(2,4)=( XD(1)*ZD(2)-XD(2)*ZD(1))                                 TETRA      53
      AT(3,1)=((XD(2)-XD(1))*(YD(3)-YD(1))-(XD(3)-XD(1))*(YD(2)-YD(1)))  TETRA      54
      AT(3,2)=(-XD(2)*YD(3)+XD(3)*YD(2))                                 TETRA      55
      AT(3,3)=( XD(1)*YD(3)-XD(3)*YD(1))                                 TETRA      56
      AT(3,4)=(-XD(1)*YD(2)+XD(2)*YD(1))                                 TETRA      57
      IPBG=0                                                             TETRA      58
      IF (JPRS) 725,735,725                                              TETRA      59
  725 IF ((ITTT-1)*(ITTT-2)) 735,726,735                                 TETRA      60
  726 KAV=NAV                                                            TETRA      61
      IF (KAV.GT.2) GO TO 735                                            TETRA      62
      PD(1)=YD(1)*ZD(2)-YD(2)*ZD(1)                                      TETRA      63
      PD(2)=-XD(1)*ZD(2)+XD(2)*ZD(1)                                     TETRA      64
      PD(3)=XD(1)*YD(2)-XD(2)*YD(1)                                      TETRA      65
      PRCO=PRES/(6.0*CFE)                                                TETRA      66
      IF (NAV-2) 729,731,735                                             TETRA      67
 731  DO 737 I=1,3                                                       TETRA      68
      II=I-4                                                             TETRA      69
      DO 736 J=1,3                                                       TETRA      70
      II=II+4                                                            TETRA      71
      IF (I.GT.1) GO TO 733                                              TETRA      72
      P(II)=PRCO*PD(J)/2.0                                               TETRA      73
      GO TO 736                                                          TETRA      74
 733  P(II)=-PRCO*PD(J)/4.0                                              TETRA      75
 736  CONTINUE                                                           TETRA      76
 737  CONTINUE                                                           TETRA      77
 729  DO 730 I=1,3                                                       TETRA      78
      I4=4*I                                                             TETRA      79
  730 P(I4)=-PRCO*PD(I)                                                  TETRA      80
      IPBG=1                                                             TETRA      81
      IPEN=3                                                             TETRA      82
  735 IF (ACEL) 738,740,738                                              TETRA      83
  738 CONS=DET*ACEL/24.0                                                 TETRA      84
      IPBG=1                                                             TETRA      85
      IPEN=3                                                             TETRA      86
  740 TX=0.0                                                             TETRA      87
      DO 745 I=1,3                                                       TETRA      88
  745 TX=XD(I)*XD(I)+YD(I)*YD(I)+ZD(I)*ZD(I)+TX                          TETRA      89
      TX=SQRT(TX)                                                        TETRA      90
      TX=1.E-6*TX**3                                                     TETRA      91
      IF (DET-TX) 747,747,750                                            TETRA      92
 747  WRITE (MO,1)M,ITTT,DET                                             TETRA      93
    1 FORMAT(27H 19.  THE VOLUME OF ELEMENT,I4,12H SUBELEMENT ,I4,       TETRA      94
     129HIS TOO SMALL. ELEMENT IGNORED,/,14HDETERMINANT = ,E12.4)        TETRA      95
      GO TO 1000                                                         TETRA      96
  750 L=0                                                                TETRA      97
      DO 780 I=1,3                                                       TETRA      98
      DO 780 J=I,3                                                       TETRA      99
      L=L+1                                                              TETRA     100
      DO 10 K=1,3                                                        TETRA     101
      I3=NN(K,L)                                                         TETRA     102
      I1=I3/10000                                                        TETRA     103
      I3=I3-I1*10000                                                     TETRA     104
      I2=I3/100                                                          TETRA     105
      I3=I3-I2*100                                                       TETRA     106
      B(K,1)=D21(I1)                                                     TETRA     107
      B(K,2)=D21(I2)                                                     TETRA     108
   10 B(K,3)=D21(I3)                                                     TETRA     109
  775 CALL TRM (B(1,1),AT(1,1),Q(1,1),3,4)                               TETRA     110
      IR=4*I-3                                                           TETRA     111
      JC=4*J-3                                                           TETRA     112
      CALL ADM(S(1), 12,Q(1,1),4,IR,JC,VOL)                              TETRA     113
  780 CONTINUE                                                           TETRA     114
 1000 RETURN                                                             TETRA     115
 1010 IERR=1                                                             TETRA     116
      GO TO 1000                                                         TETRA     117
      END                                                                TETRA     118
*DECK TOPO2
      SUBROUTINE TOPO2                                                   TOPO2       2
C     PREPARES ELEMENT PROPERTIES                                        TOPO2       3
CMAP10                                                                   TOPO2       4
      COMMON/COMEL/IN                                                    TOPO2       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TOPO2       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TOPO2       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TOPO2       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TOPO2       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TOPO2      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TOPO2      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TOPO2      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TOPO2      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TOPO2      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TOPO2      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TOPO2      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TOPO2      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TOPO2      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TOPO2      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TOPO2      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TOPO2      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TOPO2      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TOPO2      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TOPO2      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TOPO2      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TOPO2      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TOPO2      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TOPO2      28
      EQUIVALENCE     (IA(401), S(1))                                    TOPO2      29
CEND MAP10                                                               TOPO2      30
      IMET=0                                                             TOPO2      31
      JPRS=0                                                             TOPO2      32
      ITEM=0                                                             TOPO2      33
      JMFI=0                                                             TOPO2      34
      DO 10 I=1,8                                                        TOPO2      35
   10 N(I)=0                                                             TOPO2      36
      JM=J1+M                                                            TOPO2      37
      IMET=IA(JM)/100                                                    TOPO2      38
      JMFI=IA(JM)-100*IMET                                               TOPO2      39
      JM=J2+M                                                            TOPO2      40
      JPRS=IA(JM)/100                                                    TOPO2      41
      ITEM=IA(JM)-100*JPRS                                               TOPO2      42
      I=1                                                                TOPO2      43
      JM=J3+M                                                            TOPO2      44
      N(I)=IA(JM)                                                        TOPO2      45
      I=I+1                                                              TOPO2      46
      JM=J4+M                                                            TOPO2      47
      N(I)=IA(JM)                                                        TOPO2      48
      I=I+1                                                              TOPO2      49
      JM=J5+M                                                            TOPO2      50
      N(I)=IA(JM)                                                        TOPO2      51
      I=I+1                                                              TOPO2      52
      JM=J6+M                                                            TOPO2      53
      N(I)=IA(JM)                                                        TOPO2      54
      I=I+1                                                              TOPO2      55
      JM=J7+M                                                            TOPO2      56
      N(I)=IA(JM)                                                        TOPO2      57
      I=I+1                                                              TOPO2      58
      JM=J8+M                                                            TOPO2      59
      N(I)=IA(JM)                                                        TOPO2      60
      I=I+1                                                              TOPO2      61
      JM=J9+M                                                            TOPO2      62
      N(I)=IA(JM)                                                        TOPO2      63
      I=I+1                                                              TOPO2      64
      JM=J10+M                                                           TOPO2      65
      N(I)=IA(JM)                                                        TOPO2      66
      RETURN                                                             TOPO2      67
      END                                                                TOPO2      68
*DECK TRANS
      SUBROUTINE TRANS                                                   TRANS       2
C     TO COMPUTE STRESS TRANSFORMATION MATRIX OF THE LAMINA IN E66       TRANS       3
CMAP10                                                                   TRANS       4
      COMMON/COMEL/IN                                                    TRANS       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TRANS       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TRANS       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TRANS       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TRANS       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TRANS      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TRANS      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TRANS      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TRANS      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TRANS      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TRANS      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TRANS      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TRANS      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TRANS      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TRANS      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TRANS      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TRANS      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TRANS      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TRANS      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TRANS      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TRANS      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TRANS      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TRANS      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TRANS      28
      EQUIVALENCE     (IA(401), S(1))                                    TRANS      29
CEND MAP10                                                               TRANS      30
CMAP40                                                                   TRANS      31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            TRANS      32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       TRANS      33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), TRANS      34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         TRANS      35
CEND MAP40                                                               TRANS      36
      DO 10 I=1,3                                                        TRANS      37
      DO 10 J=1,3                                                        TRANS      38
   10 E66(I,J)=DIR(I,J)**2                                               TRANS      39
      E66(1,4)=2.*DIR(1,1)*DIR(1,2)                                      TRANS      40
      E66(1,5)=2.*DIR(1,1)*DIR(1,3)                                      TRANS      41
      E66(1,6)=2.*DIR(1,2)*DIR(1,3)                                      TRANS      42
      E66(2,4)=2.*DIR(2,1)*DIR(2,2)                                      TRANS      43
      E66(2,5)=2.*DIR(2,1)*DIR(2,3)                                      TRANS      44
      E66(2,6)=2.*DIR(2,2)*DIR(2,3)                                      TRANS      45
      E66(3,4)=2.*DIR(3,1)*DIR(3,2)                                      TRANS      46
      E66(3,5)=2.*DIR(3,1)*DIR(3,3)                                      TRANS      47
      E66(3,6)=2.*DIR(3,2)*DIR(3,3)                                      TRANS      48
      E66(4,1)=DIR(1,1)*DIR(2,1)                                         TRANS      49
      E66(5,1)=DIR(1,1)*DIR(3,1)                                         TRANS      50
      E66(6,1)=DIR(2,1)*DIR(3,1)                                         TRANS      51
      E66(4,2)=DIR(1,2)*DIR(2,2)                                         TRANS      52
      E66(5,2)=DIR(1,2)*DIR(3,2)                                         TRANS      53
      E66(6,2)=DIR(2,2)*DIR(3,2)                                         TRANS      54
      E66(4,3)=DIR(1,3)*DIR(2,3)                                         TRANS      55
      E66(5,3)=DIR(1,3)*DIR(3,3)                                         TRANS      56
      E66(6,3)=DIR(2,3)*DIR(3,3)                                         TRANS      57
      E66(4,4)=DIR(1,1)*DIR(2,2)+DIR(1,2)*DIR(2,1)                       TRANS      58
      E66(5,4)=DIR(1,1)*DIR(3,2)+DIR(1,2)*DIR(3,1)                       TRANS      59
      E66(6,4)=DIR(2,1)*DIR(3,2)+DIR(2,2)*DIR(3,1)                       TRANS      60
      E66(4,5)=DIR(1,1)*DIR(2,3)+DIR(1,3)*DIR(2,1)                       TRANS      61
      E66(5,5)=DIR(1,1)*DIR(3,3)+DIR(1,3)*DIR(3,1)                       TRANS      62
      E66(6,5)=DIR(2,1)*DIR(3,3)+DIR(2,3)*DIR(3,1)                       TRANS      63
      E66(4,6)=DIR(1,2)*DIR(2,3)+DIR(1,3)*DIR(2,2)                       TRANS      64
      E66(5,6)=DIR(1,2)*DIR(3,3)+DIR(1,3)*DIR(3,2)                       TRANS      65
      E66(6,6)=DIR(2,2)*DIR(3,3)+DIR(2,3)*DIR(3,2)                       TRANS      66
      RETURN                                                             TRANS      67
      END                                                                TRANS      68
*DECK TRM
       SUBROUTINE TRM(A,B,C,M,N1)                                        TRM         2
C     PERFORMS TRIPLE MATRIX PRODUCT OF ORDER 3.                         TRM         3
      DIMENSION A(3,3),B(4,4),C(4,4),D(4,4)                              TRM         4
       N=N1                                                              TRM         5
      IF (N) 2,1,1                                                       TRM         6
 2    N=-N                                                               TRM         7
      GO TO 8                                                            TRM         8
 1    DO 3 I=1,M                                                         TRM         9
      DO 3 J=1,N                                                         TRM        10
 3    C(I,J)=B(I,J)                                                      TRM        11
 8    DO 4 I=1,N                                                         TRM        12
      DO 4 J=1,M                                                         TRM        13
      D(I,J)=0.0                                                         TRM        14
      DO 5 K=1,M                                                         TRM        15
 5    D(I,J)=D(I,J)+C(K,I)*A(K,J)                                        TRM        16
 4    CONTINUE                                                           TRM        17
      DO 6 I=1,N                                                         TRM        18
      DO 6 J=1,N                                                         TRM        19
      C(I,J)=0.0                                                         TRM        20
      DO 7 K=1,M                                                         TRM        21
 7    C(I,J)=C(I,J)+D(I,K)*B(K,J)                                        TRM        22
 6    CONTINUE                                                           TRM        23
      RETURN                                                             TRM        24
      END                                                                TRM        25
*DECK YHAR2P
      SUBROUTINE YHAR2P (ES,IMET,H)                                      YHAR2P      2
C     USER SUPPLIED SUBROUTINE USED TO OBTAIN SLOPE OF                   YHAR2P      3
C     EFFECTIVE STRESS - EFFECTIVE PLASTIC STRAIN CURVE                  YHAR2P      4
C     (WHEN IHARD=0) FOR GIVEN STRESS LEVEL AND MATERIAL                 YHAR2P      5
C     TYPE                                                               YHAR2P      6
C                                                                        YHAR2P      7
C   MEANING OF SYMBOLS%                                                  YHAR2P      8
C                                                                        YHAR2P      9
C     ES    CURRENT EFFECTIVE STRESS (OF MATRIX IF COMPOSITE)            YHAR2P     10
C     IMET  MATERIAL TYPE NUMBER                                         YHAR2P     11
C     H     SLOPE OF EFFECTIVE STRESS-EFFECTIVE PLASTIC STRAIN CURVE     YHAR2P     12
C                                                                        YHAR2P     13
      RETURN                                                             YHAR2P     14
      END                                                                YHAR2P     15
*DECK PAC3
      SUBROUTINE PAC3(IFLG)                                              PAC3        2
C     MAIN SUBROUTINE OF THE DEFLECTION LINK                             PAC3        3
CMAP10                                                                   PAC3        4
      COMMON/COMEL/IN                                                    PAC3        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PAC3        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PAC3        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       PAC3        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PAC3        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PAC3       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PAC3       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PAC3       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PAC3       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PAC3       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PAC3       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PAC3       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PAC3       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PAC3       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PAC3       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PAC3       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PAC3       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PAC3       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PAC3       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PAC3       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PAC3       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PAC3       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PAC3       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PAC3       28
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           PAC3       29
CEND MAP10                                                               PAC3       30
CMAP20                                                                   PAC3       31
      DIMENSION LLL(27)                                                  PAC3       32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PAC3       33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PAC3       34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PAC3       35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PAC3       36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PAC3       37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PAC3       38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PAC3       39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PAC3       40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PAC3       41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PAC3       42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PAC3       43
CEND MAP20                                                               PAC3       44
      CALL RESET                                                         PAC3       45
      IDEG=3                                                             PAC3       46
      IND=3*IN                                                           PAC3       47
      JTERS=KTERS+1                                                      PAC3       48
      IF(IYEL .GE. 0) GO TO 60                                           PAC3       49
      READ(ITAS) (AA(IDEF+I),I=1,ISUM)                                   PAC3       50
      BACKSPACE ITAS                                                     PAC3       51
      BACKSPACE ITAS                                                     PAC3       52
   60 IF (INP.LT.2) GO TO 15                                             PAC3       53
      WRITE(MO,19) ITER,JTERS,(I,AA(IDEF+I),I=1,ISUM)                    PAC3       54
 19   FORMAT(/////1X,51HRIGHT HAND SIDE VECTOR BEFORE FORWARD CHOLESKY P PAC3       55
     1ASS,2X,5HSTEP%,I4,2X,8HSUBSTEP%,I4/(5(I5,E15.6)))                  PAC3       56
 15   KKX=IORD1+ISUM+1                                                   PAC3       57
      IF (ITERS.GT.0) GO TO 5                                            PAC3       58
      IF(ISUM-1) 301,3,1                                                 PAC3       59
    1 JERR=IU                                                            PAC3       60
      CALL DECOM(ISUM,JERR,IST)                                          PAC3       61
      IF(INP .EQ. 2) WRITE(MO,119) ITER,(I,AA(IST+I),I=1,IORD1)          PAC3       62
 119  FORMAT(/////25H DECOMPOSED MATRIX  STEP%,I4/(5(I5,E15.6)))         PAC3       63
      IF (JERR.EQ.0) GO TO 3                                             PAC3       64
      IERR=JERR                                                          PAC3       65
      GO TO 302                                                          PAC3       66
 3    WRITE (ITAS)(AA(IST+I),I=1,KKX)                                    PAC3       67
      WRITE(ITAS) (AA(IDEF+I),I=1,ISUM)                                  PAC3       68
      BACKSPACE ITAS                                                     PAC3       69
    5 IF(ISUM-1) 301,6,7                                                 PAC3       70
    6 AA(IDEF+1)=AA(IDEF+1)/AA(IST+1)                                    PAC3       71
      GO TO 8                                                            PAC3       72
    7 CALL FORWD (ISUM,IU,IST,IDEF)                                      PAC3       73
      CALL BACWD (ISUM,IU,IST,IDEF)                                      PAC3       74
    8 IF (INP.EQ.2) WRITE (MO,9) ITER,(I,AA(IDEF+I),I=1,ISUM)            PAC3       75
 9    FORMAT(////33H REDUCED DEFLECTION VECTOR  STEP%,I4/(5(I5,E15.6)))  PAC3       76
   10 CALL NCOMP                                                         PAC3       77
      IERR=0                                                             PAC3       78
      CALL TIMEO (C1T)                                                   PAC3       79
      WRITE(MO,50) C1T,ITER,JTERS                                        PAC3       80
 50   FORMAT(1X,20HDEFLECTION LINK TOOK,F7.2,19H  SECONDS FOR STEP%,I4,2 PAC3       81
     1X,8HSUBSTEP%,I4)                                                   PAC3       82
      IF(INX.LT.4) IFLG = 1                                              PAC3       83
      RETURN                                                             PAC3       84
  301 WRITE (MO,300)                                                     PAC3       85
  300 FORMAT(29H 21.  NO UNKNOWN DEFLECTIONS.)                           PAC3       86
      GO TO 10                                                           PAC3       87
 302  DO 76 I=1,IND                                                      PAC3       88
      K1=IBB+I                                                           PAC3       89
      K1=IA(K1)                                                          PAC3       90
      IF (K1) 71,71,73                                                   PAC3       91
 71   K2=IIC+I                                                           PAC3       92
      K2=IA(K2)                                                          PAC3       93
      LZ=K2/100000                                                       PAC3       94
      K2=K2-100000*LZ+IBB+IND                                            PAC3       95
      DO 72 L=1,LZ                                                       PAC3       96
      K2=K2+1                                                            PAC3       97
      IF (K2-IERR) 72,74,72                                              PAC3       98
 72   CONTINUE                                                           PAC3       99
      GO TO 76                                                           PAC3      100
 73   IF (K1-IERR) 76,74,76                                              PAC3      101
 74   J=(I -1)/IDEG+1                                                    PAC3      102
      K=I-(J-1)*IDEG                                                     PAC3      103
      WRITE (MO,75) IERR,J,K                                             PAC3      104
 75   FORMAT (1X,47H22.  INDEFINITE MATRIX INDICATION FROM EQUATION,     PAC3      105
     1I5,2X,4HNODE,I5,2X,9HDIRECTION,I3)                                 PAC3      106
 76   CONTINUE                                                           PAC3      107
      WRITE (MO,77) IERR                                                 PAC3      108
 77   FORMAT (1X,47H23.  INDEFINITE MATRIX INDICATION FROM EQUATION,I5)  PAC3      109
      CALL TIMEO (C1T)                                                   PAC3      110
      WRITE(MO,50) C1T,ITER,KTERS                                        PAC3      111
      IFLG = 1                                                           PAC3      112
      RETURN                                                             PAC3      113
      END                                                                PAC3      114
*DECK BACWD
      SUBROUTINE BACWD (N,IU,IST,IDEF)                                   BACWD       2
C     FOR BACKWARD SWEEP OF CHOLESKY                                     BACWD       3
      DIMENSION A(1),IA(1)                                               BACWD       4
      COMMON/COMEL/IA                                                    BACWD       5
      EQUIVALENCE (A(1),IA(1))                                           BACWD       6
      IUI=IU+N                                                           BACWD       7
      IM=IA(IUI)+IST                                                     BACWD       8
      MAX=IA(IUI+1)+IST                                                  BACWD       9
      L=IDEF+N                                                           BACWD      10
      N1=N+1                                                             BACWD      11
      A(L)=A(L)/(A(IM))                                                  BACWD      12
C     THEN THE REST OF B IN BACKWARD DIRECTION.                          BACWD      13
      DO 31 L=2,N                                                        BACWD      14
      I=N1-L                                                             BACWD      15
      J=I+IDEF                                                           BACWD      16
      J1=J-1                                                             BACWD      17
      I1=I+1                                                             BACWD      18
      IUI=IU+I                                                           BACWD      19
      ID=IA(IUI)                                                         BACWD      20
      IDE=IA(IUI+1)                                                      BACWD      21
      JMX=IDE-ID                                                         BACWD      22
      ID=ID+IST                                                          BACWD      23
      ID1=ID-1                                                           BACWD      24
      IF (JMX-1)  31,31,321                                              BACWD      25
 321  DO 32 K=2,JMX                                                      BACWD      26
      M=J1+K                                                             BACWD      27
      IK=ID1+K                                                           BACWD      28
 32   A(J)=A(J)-A(M)*A(IK)                                               BACWD      29
   31 A(J)=A(J)/(A(ID))                                                  BACWD      30
      RETURN                                                             BACWD      31
      END                                                                BACWD      32
*DECK DECOM
      SUBROUTINE DECOM (N,IU,IST)                                        DECOM       2
C     CHOLESKY DECOMPOSITION                                             DECOM       3
      COMMON/COMEL/IN                                                    DECOM       4
      DIMENSION IA(401),A(401)                                           DECOM       5
      EQUIVALENCE (A(1),IA(1),IN)                                        DECOM       6
      EQUIVALENCE (IA(365),ITER),(IA(366),ITERS),(IA(327),MO),           DECOM       7
     1(IA(44),IBB),(IA(53),IIC),(IA(387),KTERS)                          DECOM       8
      ICATH=0                                                            DECOM       9
      IJ=IST+1                                                           DECOM      10
      I=1                                                                DECOM      11
      IF (A(IJ).GT.0.0) GO TO 10                                         DECOM      12
      ICATH=1                                                            DECOM      13
      A(IJ)=-SQRT(-A(IJ))                                                DECOM      14
      GO TO 110                                                          DECOM      15
 10   A(IJ)=SQRT(A(IJ))                                                  DECOM      16
  110 SRMIN=1.0                                                          DECOM      17
      IYB=1                                                              DECOM      18
      IUI=IU+2                                                           DECOM      19
      IW=IA(IUI)-1                                                       DECOM      20
      IF (IW-1) 1312,1312,1313                                           DECOM      21
 1313 DO 1311 J=2,IW                                                     DECOM      22
      IJ=IST+J                                                           DECOM      23
 1311 A(IJ)=A(IJ)/ABS(A(IST+1))                                          DECOM      24
C     OBTAIN THE OTHER ROWS OF U SEQUENTIALLY.                           DECOM      25
 1312 IUI=IU+N+1                                                         DECOM      26
      MAX=IA(IUI)+IST                                                    DECOM      27
      DO 701 J=1,N                                                       DECOM      28
      JJ=MAX+J                                                           DECOM      29
 701  IA(JJ)=0                                                           DECOM      30
      DO 11 I=2,N                                                        DECOM      31
C     PREPARE FOR THE I TH ROW.                                          DECOM      32
      IUI=IU+I                                                           DECOM      33
      ID=IA(IUI)                                                         DECOM      34
      IDE=IA(IUI+1)                                                      DECOM      35
      JMX=IDE-ID+I-1                                                     DECOM      36
      ID=ID+IST                                                          DECOM      37
      II=ID-I                                                            DECOM      38
      IF (IW-I) 15,16,16                                                 DECOM      39
 16   DO 702 J=I,IW                                                      DECOM      40
      JJ=MAX+J                                                           DECOM      41
 702  IA(JJ)=IA(JJ)+1                                                    DECOM      42
 15   IW=JMX                                                             DECOM      43
      IE1=I-1                                                            DECOM      44
      DO 112 J=I,JMX                                                     DECOM      45
      IJ=II+J                                                            DECOM      46
      JJ=MAX+J                                                           DECOM      47
      KB=I-IA(JJ)                                                        DECOM      48
      E=0.                                                               DECOM      49
      IF (KB-I) 1162,13,13                                               DECOM      50
 1162 DO 131 K=KB,IE1                                                    DECOM      51
      IUK=IU+K                                                           DECOM      52
      KD=IA(IUK)+IST                                                     DECOM      53
      IK=KD+I-K                                                          DECOM      54
      JK=KD+J-K                                                          DECOM      55
  131 E=E+(A(IK)*A(JK))*SIGN(1.0,A(KD))                                  DECOM      56
      IF (J-I) 12,12,13                                                  DECOM      57
   12 YKII=A(ID)                                                         DECOM      58
      IF (A(IJ)-E.GT.0.0) GO TO 122                                      DECOM      59
      ICATH=1                                                            DECOM      60
      A(ID)=-SQRT(E-A(ID))                                               DECOM      61
      GO TO 1222                                                         DECOM      62
  122 A(ID)=SQRT(A(ID)-E)                                                DECOM      63
 1222 YDII=A(ID)*A(ID)                                                   DECOM      64
      SR=YDII/YKII                                                       DECOM      65
      IF(SR.GE.SRMIN) GO TO 112                                          DECOM      66
      SRMIN=SR                                                           DECOM      67
      IYB=I                                                              DECOM      68
      GO TO 112                                                          DECOM      69
   13 A(IJ)=(A(IJ)-E)/ABS(A(ID))                                         DECOM      70
 112  CONTINUE                                                           DECOM      71
 11   CONTINUE                                                           DECOM      72
C     U IS NOW AVAILABLE COMPLETELY, COMPUTE NODE & DIR OF SMALLEST      DECOM      73
C     SINGULARITY RATIO                                                  DECOM      74
      IU=0                                                               DECOM      75
      IND=3*IN                                                           DECOM      76
      DO 76 I=1,IND                                                      DECOM      77
      K1=IBB+I                                                           DECOM      78
      K1=IA(K1)                                                          DECOM      79
      IF(K1) 71,71,73                                                    DECOM      80
   71 K2=IIC+I                                                           DECOM      81
      K2=IA(K2)                                                          DECOM      82
      LZ=K2/100000                                                       DECOM      83
      K2=K2-100000*LZ+IBB+IND                                            DECOM      84
      DO 72 L=1,LZ                                                       DECOM      85
      K2=K2+1                                                            DECOM      86
      IF(K2-IYB) 72,74,72                                                DECOM      87
   72 CONTINUE                                                           DECOM      88
      GO TO 76                                                           DECOM      89
   73 IF(K1-IYB) 76,74,76                                                DECOM      90
   74 J=(I-1)/3+1                                                        DECOM      91
      K=I-(J-1)*3                                                        DECOM      92
      JTERS=KTERS+1                                                      DECOM      93
      WRITE(MO,53) ITER,JTERS,SRMIN,IYB,J,K                              DECOM      94
   53 FORMAT (/,6H STEP%,I5,9H SUBSTEP%,I5,/,41H SMALLEST SINGULARITY RA DECOM      95
     +TIO (DII/KII) IS ,E15.6,17H AT EQUATION NO. ,I5,6H NODE ,I5,       DECOM      96
     +11H DIRECTION ,I2,/)                                               DECOM      97
   76 CONTINUE                                                           DECOM      98
      IF (ICATH.EQ.1) WRITE (MO,105)                                     DECOM      99
  105 FORMAT (/,5X,42HINDEFINITE MATRIX, MODIFIED CHOLESKY USED ,/)      DECOM     100
 106  RETURN                                                             DECOM     101
      END                                                                DECOM     102
*DECK FORWD
      SUBROUTINE FORWD (N,IU,IST,IDEF)                                   FORWD       2
C     FOR FORWARD SWEEP OF CHOLESKY                                      FORWD       3
      DIMENSION A(1),IA(1)                                               FORWD       4
      COMMON/COMEL/IA                                                    FORWD       5
      EQUIVALENCE (A(1),IA(1))                                           FORWD       6
      IUI=IU+N+1                                                         FORWD       7
      MAX=IA(IUI)+IST                                                    FORWD       8
      A(IDEF+1)=A(IDEF+1)/ABS(A(IST+1))                                  FORWD       9
      DO 21 I=2,N                                                        FORWD      10
      L=IDEF+I                                                           FORWD      11
      IUI=IU+I                                                           FORWD      12
      ID=IA(IUI)+IST                                                     FORWD      13
      IE1=I-1                                                            FORWD      14
      JJ=MAX+I                                                           FORWD      15
      KB=I-IA(JJ)                                                        FORWD      16
      IF (KB-I) 3521,21,21                                               FORWD      17
 3521 DO 22 K=KB,IE1                                                     FORWD      18
      IUK=IU+K                                                           FORWD      19
      KD=IA(IUK)+IST                                                     FORWD      20
      IK=KD+I-K                                                          FORWD      21
      JK=IDEF+K                                                          FORWD      22
   22 A(L)=A(L)-A(IK)*A(JK)*SIGN(1.0,A(KD))                              FORWD      23
   21 A(L)=A(L)/ABS(A(ID))                                               FORWD      24
      RETURN                                                             FORWD      25
      END                                                                FORWD      26
*DECK NCOMP
      SUBROUTINE NCOMP                                                   NCOMP       2
C     TO COMPLETE THE DEFLECTION VECTOR                                  NCOMP       3
CMAP10                                                                   NCOMP       4
      COMMON/COMEL/IN                                                    NCOMP       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  NCOMP       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     NCOMP       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       NCOMP       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   NCOMP       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   NCOMP      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   NCOMP      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   NCOMP      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   NCOMP      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   NCOMP      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   NCOMP      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   NCOMP      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   NCOMP      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   NCOMP      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   NCOMP      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   NCOMP      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   NCOMP      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   NCOMP      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   NCOMP      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   NCOMP      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   NCOMP      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   NCOMP      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   NCOMP      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    NCOMP      28
      EQUIVALENCE     (IA(401), S(1))                                    NCOMP      29
CEND MAP10                                                               NCOMP      30
CMAP20                                                                   NCOMP      31
      DIMENSION LLL(27)                                                  NCOMP      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   NCOMP      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   NCOMP      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  NCOMP      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  NCOMP      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   NCOMP      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   NCOMP      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   NCOMP      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   NCOMP      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  NCOMP      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   NCOMP      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   NCOMP      43
CEND MAP20                                                               NCOMP      44
      IDEG=3                                                             NCOMP      45
      IND=3*IN                                                           NCOMP      46
      IND1=IND+1                                                         NCOMP      47
      DO 202 K=1,IND                                                     NCOMP      48
      L=IST+K                                                            NCOMP      49
 202  AA(L)=0.                                                           NCOMP      50
      JJ=-IDEG                                                           NCOMP      51
      LZ=IST                                                             NCOMP      52
      DO 2031M=1,IN                                                      NCOMP      53
      JJ=JJ+IDEG                                                         NCOMP      54
      DO 203 K=1,IDEG                                                    NCOMP      55
      LZ=LZ+1                                                            NCOMP      56
      J=JJ+K                                                             NCOMP      57
      IBOJ=IBB+J                                                         NCOMP      58
      KK=IA(IBOJ)                                                        NCOMP      59
      IICJ=IIC+J                                                         NCOMP      60
C     ANY MULTIPLE CONNECTION ?                                          NCOMP      61
      IF (KK) 61,62,61                                                   NCOMP      62
C     SINGLE CONNECTION. SEE IF PRESCRIBED DEFLECTION.                   NCOMP      63
 61   IF (KK-IND1) 63,64,64                                              NCOMP      64
C     PRESCRIBED DEFLECTION.  COPY VALUE FROM IIC VECTOR.                NCOMP      65
   64 IF(KTERS.EQ.0) AA(LZ)=AA(LZ)+AA(IICJ)                              NCOMP      66
      GO TO 203                                                          NCOMP      67
C     NOT PRESCRIBED DEFLECTION.  OBTAIN VALUE FROM REDUCED DEF.VECT.    NCOMP      68
 63   KDEF=IDEF+KK                                                       NCOMP      69
      AA(LZ)=AA(LZ)+AA(KDEF)*AA(IICJ)                                    NCOMP      70
      GO TO 203                                                          NCOMP      71
C     MULTIPLE CONNECTION.  FIND MULTIPLICITY AND RELATIVE POINTER.      NCOMP      72
 62   II=IA(IICJ)/100000                                                 NCOMP      73
      MEND=IA(IICJ)-100000*II                                            NCOMP      74
C     OBTAIN DEFLECTION OF MULTIPLE CONNECTION.                          NCOMP      75
      CC=0.                                                              NCOMP      76
      IR=IBB+MEND+IND                                                    NCOMP      77
      JR=IIC+MEND+IND                                                    NCOMP      78
      DO 80 L=1,II                                                       NCOMP      79
      IR=IR+1                                                            NCOMP      80
      JR=JR+1                                                            NCOMP      81
      KK=IA(IR)                                                          NCOMP      82
C     SEE IF L TH CONNECTION IS PRESCRIBED.                              NCOMP      83
      IF (KK-IND1) 73,74,74                                              NCOMP      84
C     PRESCRIBED DEFLECTION.                                             NCOMP      85
   74 IF(KTERS.EQ.0) CC=CC+AA(JR)                                        NCOMP      86
      GO TO 80                                                           NCOMP      87
C     NOT PRESCRIBED.                                                    NCOMP      88
 73   KDEF=IDEF+KK                                                       NCOMP      89
      CC=CC+AA(KDEF)*AA(JR)                                              NCOMP      90
 80   CONTINUE                                                           NCOMP      91
      AA(LZ)=CC                                                          NCOMP      92
 203  CONTINUE                                                           NCOMP      93
 2031 CONTINUE                                                           NCOMP      94
C     COPY COMPLETE DEFLECTION VECTOR INTO PLACE.                        NCOMP      95
      JJ=-IDEG                                                           NCOMP      96
      LZ=IST                                                             NCOMP      97
      DO 2011M=1,IN                                                      NCOMP      98
      JJ=JJ+IDEG                                                         NCOMP      99
      DO 201 K=1,IDEG                                                    NCOMP     100
      LZ=LZ+1                                                            NCOMP     101
      IDEFI=IDEF+JJ+K                                                    NCOMP     102
 201  AA(IDEFI)=AA(LZ)                                                   NCOMP     103
 2011 CONTINUE                                                           NCOMP     104
C     DO NOT CHANGE POINTERS                                             NCOMP     105
      RETURN                                                             NCOMP     106
      END                                                                NCOMP     107
*DECK PAC4
      SUBROUTINE PAC4(IFLG)                                              PAC4        2
C.....MAIN SUBROUTINE OF THE STRESS LINK................................ PAC4        3
CMAP10                                                                   PAC4        4
      COMMON/COMEL/IN                                                    PAC4        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PAC4        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PAC4        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       PAC4        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PAC4        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PAC4       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PAC4       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PAC4       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PAC4       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PAC4       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PAC4       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PAC4       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PAC4       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PAC4       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PAC4       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PAC4       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PAC4       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PAC4       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PAC4       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PAC4       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PAC4       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PAC4       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PAC4       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PAC4       28
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           PAC4       29
CEND MAP10                                                               PAC4       30
CMAP20                                                                   PAC4       31
      DIMENSION LLL(27)                                                  PAC4       32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PAC4       33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PAC4       34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PAC4       35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PAC4       36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PAC4       37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PAC4       38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PAC4       39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PAC4       40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PAC4       41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PAC4       42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PAC4       43
CEND MAP20                                                               PAC4       44
      CALL RESET                                                         PAC4       45
C                                                                        PAC4       46
C.....SET IMPORTANT PARAMETERS.......................................... PAC4       47
C                                                                        PAC4       48
  111 IF(IYEL .GE. 0) GO TO 60                                           PAC4       49
      IYEL=-IYEL                                                         PAC4       50
      ITERS=KTERS                                                        PAC4       51
      PNORMB=QNORMB                                                      PAC4       52
   60 KKX=IORD1+ISUM+1                                                   PAC4       53
      LLX=IST+ISUM+1                                                     PAC4       54
      LLY=LLX+ISUM                                                       PAC4       55
      IT6=6*IT                                                           PAC4       56
      LLZ=LLY+IT6                                                        PAC4       57
      LLU=LLZ+3*IN                                                       PAC4       58
      LLN=LLU+IT6                                                        PAC4       59
      LEN=6*IN+IT6                                                       PAC4       60
      IWRIT=ITERS                                                        PAC4       61
      MS=20*IHARD                                                        PAC4       62
      LHD1=LHD+IMAT+MS*IMAT                                              PAC4       63
      IF(ITERS .EQ. 0) ISECT=1                                           PAC4       64
C                                                                        PAC4       65
C.....TEST FOR SCALING.................................................. PAC4       66
C                                                                        PAC4       67
      IF ((ITER.EQ.1).OR.(ITERS.NE.0)) GO TO 9                           PAC4       68
      ZZ=DESC                                                            PAC4       69
C                                                                        PAC4       70
C.....SCALE INCREMENTAL DEFLECTIONS , AND THE NORM (PNORMB) OF THE ..... PAC4       71
C.....ASSOCIATED INCREMENTAL LOADS...................................... PAC4       72
C                                                                        PAC4       73
    7 D=DESC                                                             PAC4       74
      IND=3*IN                                                           PAC4       75
      DO 8 I=1,IND                                                       PAC4       76
       AA(IDEF+I)=ZZ*AA(IDEF+I)                                          PAC4       77
    8 CONTINUE                                                           PAC4       78
      PNORMB=PNORMB*ZZ                                                   PAC4       79
      PNORMB=ABS(PNORMB)                                                 PAC4       80
      IF (IFB.GT.0) GO TO 6                                              PAC4       81
      CUMS=CUMS+DESC                                                     PAC4       82
    6 ZZ=DESC                                                            PAC4       83
C                                                                        PAC4       84
C.....COMPUTE THE ACTION OF INCREMENTAL VERTEX DEFLECTIONS, BY CALLING.. PAC4       85
C.....RESPNS, IN IST-AREA, AND ALSO UPDATE STRESS, STRAIN, AND CENTER... PAC4       86
C.....OF YIELD SURFACE INFORMATION...................................... PAC4       87
C                                                                        PAC4       88
    9 PNORM=0.                                                           PAC4       89
C     CLEAR THE LOAD VECTOR AREA                                         PAC4       90
      DO 4 I=1,ISUM                                                      PAC4       91
       AA(IST+I) =0.                                                     PAC4       92
    4 CONTINUE                                                           PAC4       93
      JEL=IELAS                                                          PAC4       94
      ITERS=ITERS+1                                                      PAC4       95
      KTERS=ITERS                                                        PAC4       96
      MI=-NI                                                             PAC4       97
C     CLEAR NODAL FORCES AREA IF FIRST STEP & FIRST SUBSTEP              PAC4       98
      IF(ITER.GT.1 .OR. ITERS.GT.1) GO TO 91                             PAC4       99
      IND=3*IN                                                           PAC4      100
      DO 44 I=1,IND                                                      PAC4      101
      AA(LLN+I)=0.                                                       PAC4      102
   44 CONTINUE                                                           PAC4      103
      GO TO 90                                                           PAC4      104
   91 REWIND ITAX                                                        PAC4      105
      IF (IFB.EQ.0.OR.ITERS.GT.1) GO TO 92                               PAC4      106
      REWIND ISHUF                                                       PAC4      107
      READ (ISHUF) (AA(LLZ+I),I=1,LEN)                                   PAC4      108
      READ (ISHUF) ((AA(LLL(K)+I),K=1,27),I=1,IT)                        PAC4      109
      CALL BROK                                                          PAC4      110
      GO TO 90                                                           PAC4      111
   92 READ (ITAX) (AA(LLZ+I),I=1,LEN)                                    PAC4      112
   90 CALL RESPNS (MI)                                                   PAC4      113
      D=DESC                                                             PAC4      114
      KTER=ITER                                                          PAC4      115
C                                                                        PAC4      116
C.....READ IN THE ASSOCIATED INCREMENTAL LOADS OF THE PRESENT .......... PAC4      117
C.....INCREMENTAL DEFLECTIONS , COMPUTE RESIDUAL LOAD VECTOR AND ITS ... PAC4      118
C.....NORM (PNORM) ; UPDATE CUMULATIVE DEFLECTIONS AND STRAINS , AND ... PAC4      119
C.....SAVE THEM , IF REQUIRED ; PRINT DATA , IF IT IS TIME.............. PAC4      120
C                                                                        PAC4      121
   21 READ(ITAS) (AA( LLX+I),I=1,ISUM)                                   PAC4      122
      BACKSPACE ITAS                                                     PAC4      123
      IF(ITER.EQ.1 .OR. ITERS.GT.1) GO TO 26                             PAC4      124
      DO 25 I=1,ISUM                                                     PAC4      125
       AA( LLX+I)=D*AA( LLX+I)                                           PAC4      126
   25 CONTINUE                                                           PAC4      127
   26 DO 27 I=1,ISUM                                                     PAC4      128
       C=AA( LLX+I)+AA(IST+I)                                            PAC4      129
       PNORM=PNORM+ABS(C)                                                PAC4      130
       AA( LLX+I)=C                                                      PAC4      131
   27 CONTINUE                                                           PAC4      132
      IF(ITAX .EQ. 0) GO TO 28                                           PAC4      133
      IF(ITER.GT.1 .OR. ITERS.GT.1) GO TO 300                            PAC4      134
      LEN1=LEN-3*IN                                                      PAC4      135
      DO 207 I=1,LEN1                                                    PAC4      136
      AA(LLZ+I)=0.                                                       PAC4      137
  207 CONTINUE                                                           PAC4      138
C     UPDATE CUMULATIVE DEFLECTIONS AND STRAINS                          PAC4      139
  300 IND=3*IN                                                           PAC4      140
      DO 29 I=1,IND                                                      PAC4      141
       AA(LLZ+I)=AA(LLZ+I)+AA(IDEF+I)                                    PAC4      142
   29 CONTINUE                                                           PAC4      143
      DO 30 I=1,IT6                                                      PAC4      144
       AA(LLU+I)=AA(LLU+I)+AA(LLY+I)                                     PAC4      145
   30 CONTINUE                                                           PAC4      146
      REWIND ITAX                                                        PAC4      147
      WRITE(ITAX) (AA(LLZ+I),I=1,LEN)                                    PAC4      148
   28 NAXSI=MAXSI*ISECT                                                  PAC4      149
      IF((MAXI .NE. 0) .OR. (ITERS .GE. NAXSI)) MPR=1                    PAC4      150
      IF (ITER.EQ.1) CALL PRINT                                          PAC4      151
C                                                                        PAC4      152
C.....TEST FOR SUBSTEP CONVERGENCE...................................... PAC4      153
C                                                                        PAC4      154
      IF(PNORM/PNORMB .LE. ER1) GO TO 16                                 PAC4      155
      MPRC=MPR                                                           PAC4      156
      MPR=0                                                              PAC4      157
      CALL PRINT                                                         PAC4      158
      MPR=MPRC                                                           PAC4      159
      IF(ITERS .LT. NAXSI) GO TO 10                                      PAC4      160
      WRITE(MO,31) ITER,ITERS                                            PAC4      161
   31 FORMAT(1X,24H24.  AT INCREMENTAL STEP,I3,1X,17HNO CONVERGENCE IN,  PAC4      162
     1I3,1X,10HITERATIONS)                                               PAC4      163
C                                                                        PAC4      164
C.....IF NO CONVERGENCE TERMINATE PROGRAM                                PAC4      165
C                                                                        PAC4      166
      GO TO 39                                                           PAC4      167
C                                                                        PAC4      168
C.....TEST FOR FIRST STEP SCALING....................................... PAC4      169
C                                                                        PAC4      170
   16 IF(ITER.GT.1) GO TO 106                                            PAC4      171
C                                                                        PAC4      172
C.....FIND LOAD FACTOR OF FIRST YIELD, AND SCALE DEFLECTIONS,STRAINS.... PAC4      173
C.....AND STRESSES AND PRINT OUT........................................ PAC4      174
C                                                                        PAC4      175
      CALL SCALY                                                         PAC4      176
      D=DESC                                                             PAC4      177
      CALL PRINT                                                         PAC4      178
C                                                                        PAC4      179
C.....CHECK FAILURE OF FIBERS IF NECESSARY.............................. PAC4      180
C                                                                        PAC4      181
  106 IF(ITYPE.EQ.0 .OR. IFBR.EQ.0) GO TO 160                            PAC4      182
      CALL PRINT                                                         PAC4      183
      IFB=0                                                              PAC4      184
      CALL FAILUR(IFAIL,IFB)                                             PAC4      185
C      IF IFAIL=1; TERMINATE PROGRAM                                     PAC4      186
C      IF IFAIL=0; CONTINUE EXECUTION                                    PAC4      187
      IF (IFB.GT.0) GO TO 53                                             PAC4      188
      REWIND ISHUF                                                       PAC4      189
      WRITE (ISHUF) (AA(LLZ+I),I=1,LEN)                                  PAC4      190
      WRITE (ISHUF) ((AA(LLL(K)+I),K=1,27),I=1,IT)                       PAC4      191
   53 CONTINUE                                                           PAC4      192
      IF(IFAIL.EQ.0) GO TO 160                                           PAC4      193
      IF (IFAIL.EQ.1) WRITE (MO,151) ITER,CUMS                           PAC4      194
  151 FORMAT (//////,5X,41HFIRST FIBER FAILURE.  PROGRAM TERMINATING,    PAC4      195
     +15H AT END OF STEP,I5,15H; LOAD FACTOR%,E12.5)                     PAC4      196
      IA(LLD+LCDP)=ITER                                                  PAC4      197
      AA(LLD+2*LCDP)=CUMS                                                PAC4      198
      GO TO 39                                                           PAC4      199
C                                                                        PAC4      200
C.....TEST FOR MORE STEPS............................................... PAC4      201
C                                                                        PAC4      202
  160 IF (ITER .GE. IA(LLD+LCDP)) GO TO 39                               PAC4      203
C                                                                        PAC4      204
C.....FIND NEXT LOAD INCREMENT FACTOR (DESC) AND PREPARE FOR NEXT STEP.. PAC4      205
C                                                                        PAC4      206
  333 ITERS=0                                                            PAC4      207
      KTERS=0                                                            PAC4      208
      ITER=ITER+1                                                        PAC4      209
      IF (IFB.GT.0) ITER=ITER-1                                          PAC4      210
      DO 40 I=1,LCDP                                                     PAC4      211
       IF (ITER.LE.IA(LLD+I)) GO TO 401                                  PAC4      212
   40 CONTINUE                                                           PAC4      213
  401 IF(IRR.EQ.1) GO TO 41                                              PAC4      214
      IF(I.GT.1) GO TO 41                                                PAC4      215
      C1=DESC                                                            PAC4      216
      GO TO 402                                                          PAC4      217
   41 C1=IA(LLD+I)-IA(LLD+I-1)                                           PAC4      218
      C1=(AA(LLD+LCDP+I)-AA(LLD+LCDP+I-1))/C1                            PAC4      219
  402 IAL=IA(LLD+I)                                                      PAC4      220
      IF(C1*DESC  .GT.  0.) GO TO 43                                     PAC4      221
      DO 42 J=1,IT                                                       PAC4      222
       AA(LLL(7)+J)=ABS(AA(LLL(7)+J))                                    PAC4      223
   42 CONTINUE                                                           PAC4      224
      IELAS=0                                                            PAC4      225
   43 DESC=C1                                                            PAC4      226
      MPR=0                                                              PAC4      227
C                                                                        PAC4      228
C.....IF PREVIOUS AND CURRENT STEPS ARE ELASTIC , HANDLE THE CURRENT ... PAC4      229
C.....STEP IN THIS LINK (STAT. # 7) , OTHERWISE GO TO GENERATION LINK .. PAC4      230
C.....(RETURN1)......................................................... PAC4      231
C                                                                        PAC4      232
      IF((ITER .EQ. IAL)       .OR. (MAXI .NE. 0)) MPR=1                 PAC4      233
      IF(IWRIT .NE. 0) GO TO 71                                          PAC4      234
C     CHECK IF THE PREVIOUS AND THE CURRENT STEP ARE ELASTIC.            PAC4      235
      IF ((IELAS .EQ. 0)  .AND.  (JEL .EQ. 0)) GO TO 11                  PAC4      236
   71 REWIND ITAS                                                        PAC4      237
      IND=3*IN                                                           PAC4      238
      READ (ITAS) (AA(IDEF+I),I=1,IND)                                   PAC4      239
      NI=0                                                               PAC4      240
      CALL TIMEO (C1T)                                                   PAC4      241
      WRITE(MO,50) C1T                                                   PAC4      242
      IFLG = 1                                                           PAC4      243
      RETURN                                                             PAC4      244
C     ELASTIC STEP FOLLOWS HANDLE IN THIS LINK                           PAC4      245
   11 ZZ=DESC/D                                                          PAC4      246
      ISECT=1                                                            PAC4      247
      GO TO 7                                                            PAC4      248
C                                                                        PAC4      249
C.....PREPARE FOR A RESTART JOB IF NECESSARY AND TERMINATE.............. PAC4      250
C                                                                        PAC4      251
   39 IF(IPIR .EQ. 0) GO TO 395                                          PAC4      252
      IFILE=LLZ+LEN                                                      PAC4      253
      REWIND ITAS                                                        PAC4      254
      IND=3*IN                                                           PAC4      255
      READ(ITAS) (AA(IDEF+I),I=1,IND)                                    PAC4      256
      REWIND IPIR                                                        PAC4      257
      WRITE(IPIR) IFILE,LLZ,LEN,ICOUNT,(AA(I),I=1,IFILE)                 PAC4      258
 395  CALL TIMEO (C1T)                                                   PAC4      259
      WRITE(MO,50) C1T                                                   PAC4      260
      RETURN                                                             PAC4      261
C                                                                        PAC4      262
C.....SAVE THE RESIDUAL LOAD VECTOR ON UNIT ITAS , READ IN DECOMPOSED .. PAC4      263
C.....MATRIX FROM UNIT ITAS FOR SUBSTEP ITERATION AND GO TO DEFLECTION . PAC4      264
C.....LINK (RETURN2) , UNLESS THE GENERATION OF THE STIFFNESS MATRIX IS  PAC4      265
C.....REQUIRED . IF SO , GO TO GENERATION LINK (RETURN1)................ PAC4      266
C                                                                        PAC4      267
   10 WRITE(ITAS) (AA( LLX+I),I=1,ISUM)                                  PAC4      268
      BACKSPACE ITAS                                                     PAC4      269
      BACKSPACE ITAS                                                     PAC4      270
C     PLACE THE LOAD VECTOR IN IDEF AREA                                 PAC4      271
      DO 12 I=1,ISUM                                                     PAC4      272
       AA(IDEF+I)=AA(LLX+I)                                              PAC4      273
   12 CONTINUE                                                           PAC4      274
      READ(ITAS) (AA(IST+I),I=1,KKX)                                     PAC4      275
      CALL TIMEO (C1T)                                                   PAC4      276
      WRITE(MO,50) C1T                                                   PAC4      277
   50 FORMAT(1X,20HSTRESS     LINK TOOK,F7.2,10H  SECONDS.)              PAC4      278
C     CHECK THE NUMBER OF ELEMENTS WHICH BECAME PLASTIC DURING THE       PAC4      279
C     SUBSTEP. IF THIS IS MORE THAN THE SPECIFIED GOTO GENERATION LINK   PAC4      280
C     OTHERWISE GOTO DEFLECTION LINK                                     PAC4      281
        IF (ITERS.EQ.1) GO TO 501                                        PAC4      282
      IF(IYEL.EQ.0) IFLG = 2                                             PAC4      283
      IF(IYEL.EQ.0) RETURN                                               PAC4      284
      IF((MI.LE.IYEL).AND.(NI.LT.IT)) IFLG = 2                           PAC4      285
      IF((MI.LE.IYEL).AND.(NI.LT.IT)) RETURN                             PAC4      286
 501   IYEL=-IYEL                                                        PAC4      287
      KTERS=ITERS                                                        PAC4      288
      QNORMB=PNORMB                                                      PAC4      289
      ITERS=0                                                            PAC4      290
      NI=0                                                               PAC4      291
      IFLG = 1                                                           PAC4      292
      RETURN                                                             PAC4      293
      END                                                                PAC4      294
*DECK ASMELP
      SUBROUTINE ASMELP                                                  ASMELP      2
C *** TO ASSEMBLE ELEMENTAL LOAD VECTORS OF HEXAHEDRAL ELEMENTS          ASMELP      3
CMAP10                                                                   ASMELP      4
      COMMON/COMEL/IN                                                    ASMELP      5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ASMELP      6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ASMELP      7
      EQUIVALENCE (IN,IA(1),AA(1))                                       ASMELP      8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ASMELP      9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ASMELP     10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ASMELP     11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ASMELP     12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ASMELP     13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ASMELP     14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ASMELP     15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ASMELP     16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ASMELP     17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ASMELP     18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ASMELP     19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ASMELP     20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ASMELP     21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ASMELP     22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ASMELP     23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ASMELP     24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ASMELP     25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ASMELP     26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ASMELP     27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ASMELP     28
      EQUIVALENCE     (IA(401), S(1))                                    ASMELP     29
CEND MAP10                                                               ASMELP     30
      IDEG=3                                                             ASMELP     31
      IMS=8                                                              ASMELP     32
      IDS=IMS*IDEG                                                       ASMELP     33
      IND=3*IN                                                           ASMELP     34
      DO 95 I=1,IDEG                                                     ASMELP     35
      DO 94 K=1,IMS                                                      ASMELP     36
      IE=IMS*(I-1)+K                                                     ASMELP     37
      IS=IDEG*(N(K)-1)+I                                                 ASMELP     38
      ISE=IE-IDS                                                         ASMELP     39
      IQE=1                                                              ASMELP     40
      IBBI=IS+IBB                                                        ASMELP     41
      IF (IA(IBBI)) 307,100,308                                          ASMELP     42
 308  IBBI=IBBI-1                                                        ASMELP     43
      GO TO 309                                                          ASMELP     44
C     MULTIPLE CONNECTION                                                ASMELP     45
 100  IBBI=IBBI-IBB+IIC                                                  ASMELP     46
      IQE=IA(IBBI)/100000                                                ASMELP     47
      IBBI=IA(IBBI)-100000*IQE+IND+IBB                                   ASMELP     48
      GO TO 309                                                          ASMELP     49
 307  IERR=6                                                             ASMELP     50
      GO TO 96                                                           ASMELP     51
 309  DO 393 IQ=1,IQE                                                    ASMELP     52
      IBBI=IBBI+1                                                        ASMELP     53
      IICI=IBBI-IBB+IIC                                                  ASMELP     54
      ISS=ISE                                                            ASMELP     55
      CCURI=AA(IICI)                                                     ASMELP     56
      IB=IA(IBBI)                                                        ASMELP     57
      IF (CCURI) 912,911,912                                             ASMELP     58
 912  IDEFI=IST +IB                                                      ASMELP     59
      AA(IDEFI)=AA(IDEFI)+CCURI*P(IE)                                    ASMELP     60
  911 CONTINUE                                                           ASMELP     61
 393  CONTINUE                                                           ASMELP     62
 94   CONTINUE                                                           ASMELP     63
 95   CONTINUE                                                           ASMELP     64
 96   RETURN                                                             ASMELP     65
      END                                                                ASMELP     66
*DECK BROK
      SUBROUTINE BROK                                                    BROK        2
C                                                                        BROK        3
C     SUBROUTINE TO ARTIFICALLY REDUCE STRESSES IN ELEMENTS              BROK        4
C     WHERE FIBERS HAVE ALREADY FAILED                                   BROK        5
C     VAILD ONLY WHEN ALL ELEMENTS HAVE IMET=1 ORIGINALLY AND            BROK        6
C     THE FIBER FAILURE MATERIAL IS 2 (IAMB=IFL=2)                       BROK        7
C                                                                        BROK        8
      COMMON /COMEL/ IN                                                  BROK        9
      DIMENSION IA(401),AA(401),LLL(27)                                  BROK       10
      EQUIVALENCE (IN,IA(1),AA(1)),(IA(3),IT),(IA(35),J1),(IA(46),IID),  BROK       11
     +(IA(382),IAMB),(IA(338),LLL(1))                                    BROK       12
C                                                                        BROK       13
C                                                                        BROK       14
      IF (IAMB.EQ.0) RETURN                                              BROK       15
      DO 10 MCLIP=1,IT                                                   BROK       16
      JM=J1+MCLIP                                                        BROK       17
      IMET=IA(JM)/100                                                    BROK       18
      IF (IMET.EQ.1) GO TO 10                                            BROK       19
      VF=AA(IID+5)                                                       BROK       20
      IF (VF.EQ.0.0) GO TO 10                                            BROK       21
      VM=1.0-VF                                                          BROK       22
      EM=AA(IID+1)                                                       BROK       23
      EF=AA(IID+3)                                                       BROK       24
      DO 2 K=22,27                                                       BROK       25
    2 AA(LLL(K)+MCLIP)=0.0                                               BROK       26
      I2=IID+(IMET-1)*6                                                  BROK       27
      IF (IMET.EQ.3) GO TO 3                                             BROK       28
      RF=(AA(I2+3)*VF+EM*VM)/(EF*VF+EM*VM)                               BROK       29
      AA(LLL(1)+MCLIP)=RF*(AA(LLL(1)+MCLIP))                             BROK       30
      GO TO 10                                                           BROK       31
    3 I3=IID+(IMET-2)*6                                                  BROK       32
      RF=(AA(I3+3)*VF+AA(I2+1)*VM)/(EF*VF+EM*VM)                         BROK       33
      AA(LLL(1)+MCLIP)=RF*(AA(LLL(1)+MCLIP))                             BROK       34
   10 CONTINUE                                                           BROK       35
      RETURN                                                             BROK       36
      END                                                                BROK       37
*DECK CODI4
      SUBROUTINE CODI4                                                   CODI4       2
C     OBTAINS MATRIX OF DIRECTION COSINES OF LAMINA-OVERALL AXES         CODI4       3
CMAP10                                                                   CODI4       4
      COMMON/COMEL/IN                                                    CODI4       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  CODI4       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     CODI4       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       CODI4       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   CODI4       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   CODI4      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   CODI4      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   CODI4      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   CODI4      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   CODI4      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   CODI4      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   CODI4      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   CODI4      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   CODI4      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   CODI4      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   CODI4      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   CODI4      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   CODI4      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   CODI4      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   CODI4      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   CODI4      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   CODI4      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   CODI4      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    CODI4      28
      EQUIVALENCE     (IA(401), S(1))                                    CODI4      29
CEND MAP10                                                               CODI4      30
CMAP40                                                                   CODI4      31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            CODI4      32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       CODI4      33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), CODI4      34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         CODI4      35
CEND MAP40                                                               CODI4      36
      DO 10 I=1,3                                                        CODI4      37
      J=N(I)                                                             CODI4      38
      IXXJ=IXX+J                                                         CODI4      39
      IYYJ=IYY+J                                                         CODI4      40
      IZZJ=IZZ+J                                                         CODI4      41
      X(I)=AA(IXXJ)                                                      CODI4      42
      Y(I)=AA(IYYJ)                                                      CODI4      43
   10 Z(I)=AA(IZZJ)                                                      CODI4      44
      X21=X(2)-X(1)                                                      CODI4      45
      Y21=Y(2)-Y(1)                                                      CODI4      46
      Z21=Z(2)-Z(1)                                                      CODI4      47
      X31=X(3)-X(1)                                                      CODI4      48
      Y31=Y(3)-Y(1)                                                      CODI4      49
      Z31=Z(3)-Z(1)                                                      CODI4      50
      DIR(2,1)=Y21*Z31-Y31*Z21                                           CODI4      51
      DIR(2,2)=X31*Z21-X21*Z31                                           CODI4      52
      DIR(2,3)=X21*Y31-X31*Y21                                           CODI4      53
      XL=SQRT(DIR(2,1)**2+DIR(2,2)**2+DIR(2,3)**2)                       CODI4      54
      DIR(2,1)=DIR(2,1)/XL                                               CODI4      55
      DIR(2,2)=DIR(2,2)/XL                                               CODI4      56
      DIR(2,3)=DIR(2,3)/XL                                               CODI4      57
      IF(JMFI) 1010,1010,20                                              CODI4      58
   20 ICFIJ=ICFI+JMFI                                                    CODI4      59
      ANG=AA(ICFIJ)                                                      CODI4      60
      IF(ABS(ANG)-90.) 50,50,30                                          CODI4      61
   30 ANG=90.                                                            CODI4      62
      IF(AA(ICFIJ)) 40,50,50                                             CODI4      63
   40 ANG=-90.                                                           CODI4      64
   50 FI=ANG*0.01745329252                                               CODI4      65
      IF(FI) 60,60,70                                                    CODI4      66
   60 SIGNFI=-1.0                                                        CODI4      67
      GO TO 80                                                           CODI4      68
   70 SIGNFI=1.0                                                         CODI4      69
   80 IF(ABS(DIR(2,1))-.1E-3) 90,90,100                                  CODI4      70
   90 IF(ABS(DIR(2,3))-.1E-3) 140,140,130                                CODI4      71
  100 DIR(3,2)=COS(FI)                                                   CODI4      72
      ASQ=DIR(2,1)*DIR(2,1)                                              CODI4      73
      AX=1.0+DIR(2,3)*DIR(2,3)/ASQ                                       CODI4      74
      BX=DIR(2,2)*DIR(2,3)*DIR(3,2)/ASQ                                  CODI4      75
      CX=DIR(3,2)*DIR(3,2)+DIR(2,2)*DIR(2,2)*DIR(3,2)*DIR(3,2)/ASQ-1.0   CODI4      76
      CULP=BX*BX-AX*CX                                                   CODI4      77
      IF(CULP) 110,120,120                                               CODI4      78
  110 CULP=0.                                                            CODI4      79
  120 DIR(3,3)=(-BX+SIGNFI*SQRT(CULP))/AX                                CODI4      80
      DIR(3,1)=(-DIR(2,2)*DIR(3,2)-DIR(2,3)*DIR(3,3))/DIR(2,1)           CODI4      81
      GO TO 150                                                          CODI4      82
  130 DIR(3,2)=COS(FI)                                                   CODI4      83
      DIR(3,3)=-DIR(2,2)*DIR(3,2)/DIR(2,3)                               CODI4      84
      DIR(3,1)=SIGNFI*SQRT(1.0-DIR(3,2)*DIR(3,2)-DIR(3,3)*DIR(3,3))      CODI4      85
      GO TO 150                                                          CODI4      86
  140 DIR(3,3)=COS(FI)                                                   CODI4      87
      DIR(3,2)=0.0                                                       CODI4      88
      DIR(3,1)=SIGNFI*SQRT(1.0-DIR(3,3)*DIR(3,3))                        CODI4      89
  150 DIR(1,1)=DIR(2,2)*DIR(3,3)-DIR(2,3)*DIR(3,2)                       CODI4      90
      DIR(1,2)=-DIR(2,1)*DIR(3,3)+DIR(2,3)*DIR(3,1)                      CODI4      91
      DIR(1,3)=DIR(2,1)*DIR(3,2)-DIR(2,2)*DIR(3,1)                       CODI4      92
 1000 RETURN                                                             CODI4      93
 1010 IERR=1                                                             CODI4      94
      GO TO 1000                                                         CODI4      95
      END                                                                CODI4      96
*DECK DIFF
      SUBROUTINE DIFF (SS,AS,DSS,DSS1,R1,R2)                             DIFF        2
C     TO COMPUTE A WEIGHTED AVERAGE OF STRESS INCR. DSS&DSS1             DIFF        3
CMAP10                                                                   DIFF        4
      COMMON/COMEL/IN                                                    DIFF        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  DIFF        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     DIFF        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       DIFF        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   DIFF        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   DIFF       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   DIFF       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   DIFF       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   DIFF       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   DIFF       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   DIFF       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   DIFF       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   DIFF       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   DIFF       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   DIFF       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   DIFF       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   DIFF       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   DIFF       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   DIFF       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   DIFF       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   DIFF       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   DIFF       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   DIFF       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    DIFF       28
      EQUIVALENCE     (IA(401), S(1))                                    DIFF       29
CEND MAP10                                                               DIFF       30
CMAP20                                                                   DIFF       31
      DIMENSION LLL(27)                                                  DIFF       32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   DIFF       33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   DIFF       34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  DIFF       35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  DIFF       36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   DIFF       37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   DIFF       38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   DIFF       39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   DIFF       40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  DIFF       41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   DIFF       42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   DIFF       43
CEND MAP20                                                               DIFF       44
      DIMENSION SS(6),AS(6),DSS(6),DSS1(6),SD(6),SI(6)                   DIFF       45
      FE(X1,X2,X3,X4,X5,X6,Y1,Y2,Y3,Y4,Y5,Y6)=((2.*X1-X2-X3)*Y1+(2.*X2-  DIFF       46
     1X3-X1)*Y2+(2.*X3-X1-X2)*Y3)/2.+3.*(X4*Y4+X5*Y5+X6*Y6)              DIFF       47
      DATA ERR/1.E-6/                                                    DIFF       48
      YP=ABS(AA(LLL(7)+M))                                               DIFF       49
      DO 10 I=1,6                                                        DIFF       50
      SI(I)=(SS(I)+DSS1(I))-AS(I)                                        DIFF       51
   10 SD(I)=DSS(I)-DSS1(I)                                               DIFF       52
      A=FE(SD(1),SD(2),SD(3),SD(4),SD(5),SD(6),SD(1),SD(2),SD(3),SD(4),  DIFF       53
     1SD(5),SD(6))                                                       DIFF       54
      B=2.*FE(SD(1),SD(2),SD(3),SD(4),SD(5),SD(6),SI(1),SI(2),SI(3),     DIFF       55
     1SI(4),SI(5),SI(6))                                                 DIFF       56
      C=FE(SI(1),SI(2),SI(3),SI(4),SI(5),SI(6),SI(1),SI(2),SI(3),SI(4),  DIFF       57
     1SI(5),SI(6))-YP*YP                                                 DIFF       58
      D=B*B-4.*A*C                                                       DIFF       59
      IF(A/YP.LT.ERR .OR. D.LT.0.) GO TO 20                              DIFF       60
      D=SQRT(D)                                                          DIFF       61
      R1=(-B+D)/(2.*A)                                                   DIFF       62
      R2=(-B-D)/(2.*A)                                                   DIFF       63
      IF(ABS(R1).GT.ABS(R2)) R1=R2                                       DIFF       64
      GO TO 30                                                           DIFF       65
C     ERROR CONDITION, TAKE AVERAGE                                      DIFF       66
   20 R1=0.5                                                             DIFF       67
   30 R2=1.0-R1                                                          DIFF       68
      DO 40 I=1,6                                                        DIFF       69
   40 DSS(I)=R1*DSS(I)+R2*DSS1(I)                                        DIFF       70
      RETURN                                                             DIFF       71
      END                                                                DIFF       72
*DECK ELCOM
      SUBROUTINE ELCOM (DD,SS,AS,ISS)                                    ELCOM       2
C     TO COMPUTE CURRENT COMPLIANCE MATRIX FOR COMPOSITE ELEMENTS IN DD  ELCOM       3
C     REFFERED TO OVERALL AXES                                           ELCOM       4
CMAP10                                                                   ELCOM       5
      COMMON/COMEL/IN                                                    ELCOM       6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ELCOM       7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ELCOM       8
      EQUIVALENCE (IN,IA(1),AA(1))                                       ELCOM       9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ELCOM      10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ELCOM      11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ELCOM      12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ELCOM      13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ELCOM      14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ELCOM      15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ELCOM      16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ELCOM      17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ELCOM      18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ELCOM      19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ELCOM      20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ELCOM      21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ELCOM      22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ELCOM      23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ELCOM      24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ELCOM      25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ELCOM      26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ELCOM      27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ELCOM      28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ELCOM      29
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           ELCOM      30
CEND MAP10                                                               ELCOM      31
CMAP20                                                                   ELCOM      32
      DIMENSION LLL(27)                                                  ELCOM      33
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   ELCOM      34
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   ELCOM      35
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  ELCOM      36
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  ELCOM      37
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   ELCOM      38
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   ELCOM      39
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   ELCOM      40
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   ELCOM      41
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  ELCOM      42
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   ELCOM      43
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   ELCOM      44
CEND MAP20                                                               ELCOM      45
CMAP40                                                                   ELCOM      46
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            ELCOM      47
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       ELCOM      48
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), ELCOM      49
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         ELCOM      50
CEND MAP40                                                               ELCOM      51
      DIMENSION DD(6,6),SS(6),AS(6),S66(6,6)                             ELCOM      52
C     D21 CONTAINS ELASTIC COMPLIANCE MATRIX IN LAMINA COORDINATES       ELCOM      53
C     IF ISS.NE.0, D21 IS ALREADY AVAILABLE                              ELCOM      54
      IF(ISS.NE.0) GO TO 30                                              ELCOM      55
      IF(M.EQ.1) GO TO 10                                                ELCOM      56
      MMET=IA(J1+M-1)/100                                                ELCOM      57
C     IF THE MATERIAL OF THE CURRENT ELEMENT IS SAME AS THAT OF PREVIOUS ELCOM      58
C     ELEMENT, D21 IS ALREADY AVAILABLE                                  ELCOM      59
      IF(IMET.EQ.MMET) GO TO 30                                          ELCOM      60
C     FIND ELASTIC THERMAL EXPAN. COEFF. REFFERED TO LAMINA AXES         ELCOM      61
   10 IIAI=IIA+(IMET-1)*2                                                ELCOM      62
      ALM=AA(IIAI+1)                                                     ELCOM      63
      ALF=AA(IIAI+2)                                                     ELCOM      64
      IIDI=IID+(IMET-1)*6                                                ELCOM      65
      VF=AA(IIDI+5)                                                      ELCOM      66
C IF VF=0., CURRENT ELEMENT IS ISOTROPIC                                 ELCOM      67
      IF(VF.EQ.0.) GO TO 210                                             ELCOM      68
      EM=AA(IIDI+1)                                                      ELCOM      69
      UM=AA(IIDI+2)                                                      ELCOM      70
      EF=AA(IIDI+3)                                                      ELCOM      71
      UF=AA(IIDI+4)                                                      ELCOM      72
      VM=1.-VF                                                           ELCOM      73
      PA=UM*EF-UF*EM                                                     ELCOM      74
      EC=VM*EM+VF*EF                                                     ELCOM      75
      AL1=VM*ALM+VF*ALF-VF*VM*PA*(ALF-ALM)/EC                            ELCOM      76
      AL2=AL1                                                            ELCOM      77
      AL3=(ALF*VF*EF+ALM*VM*EM)/EC                                       ELCOM      78
C     COMPUTE ELASTIC COMPLIANCE MATRIX REFFERED TO LAMINA AXES IN D21   ELCOM      79
      GM=EM/2./(1.+UM)                                                   ELCOM      80
      GF=EF/2./(1.+UF)                                                   ELCOM      81
      GC=VM/GM+VF/GF                                                     ELCOM      82
      UC=VM*UM+VF*UF                                                     ELCOM      83
      ET=VM/EM+VF/EF                                                     ELCOM      84
      DO 20 I=1,21                                                       ELCOM      85
   20 D21(I)=0.                                                          ELCOM      86
      D21(1)=ET-VM*VF*PA*PA/EM/EF/EC                                     ELCOM      87
      D21(2)=-VM*UM/EM-VF*UF/EF-VM*VF*PA*PA/EM/EF/EC                     ELCOM      88
      D21(3)=-UC/EC                                                      ELCOM      89
      D21(7)=D21(1)                                                      ELCOM      90
      D21(8)=D21(3)                                                      ELCOM      91
      D21(12)=1./EC                                                      ELCOM      92
      D21(16)=GC                                                         ELCOM      93
      D21(19)=GC                                                         ELCOM      94
      D21(21)=GC                                                         ELCOM      95
C     YP=MATRIX YIELD STRESS, ES=MATRIX EFF. STRESS                      ELCOM      96
   30 YP=AA(LLL(7)+M)                                                    ELCOM      97
      ES=AA(LLL(8)+M)                                                    ELCOM      98
C     JJ% INDICATOR, 0=PLASTIC ELEMENT, 1=ELASTIC ELEMENT                ELCOM      99
      JJ=1                                                               ELCOM     100
      IF(ITER.EQ.1 .AND. ITERS.EQ.1) GO TO 140                           ELCOM     101
      IF(ISS.EQ.1) GO TO 50                                              ELCOM     102
      DO 40 I=1,6                                                        ELCOM     103
      SS(I)=AA(LLL(9+I)+M)                                               ELCOM     104
   40 AS(I)=AA(LLL(15+I)+M)                                              ELCOM     105
C     DETERMINE STATE OF THE ELEMENT AT THE BEGINNING OF SUBSTEP         ELCOM     106
C     YP.LT.0, PLASTIC ELEMENT                                           ELCOM     107
   50 IF(YP.GE.0.) GO TO 140                                             ELCOM     108
      IF(ISS.EQ.1) H1=H                                                  ELCOM     109
      IF(KHARD.NE.0) GO TO 80                                            ELCOM     110
      H=0.                                                               ELCOM     111
      GO TO 120                                                          ELCOM     112
   80 IF(IHARD.NE.0) GO TO 90                                            ELCOM     113
      CALL YHAR4P(ES,IMET,H)                                             ELCOM     114
      GO TO 120                                                          ELCOM     115
   90 KS=LHD+IMAT+(IMET-1)*20*IHARD+10*IHARD                             ELCOM     116
      K=IA(LHD+IMET)                                                     ELCOM     117
      KE=KS-10*IHARD                                                     ELCOM     118
      DO 100 I=2,K                                                       ELCOM     119
  100 IF(ES.LT.AA(KS+I)) GO TO 110                                       ELCOM     120
      I=I-1                                                              ELCOM     121
  110 H=(AA(KS+I)-AA(KS+I-1))/(AA(KE+I)-AA(KE+I-1))                      ELCOM     122
  120 Q=2.*(SS(3)-AS(3))-(SS(1)-AS(1))-(SS(2)-AS(2))                     ELCOM     123
      Q=Q/6./(YP*YP+3.*((SS(4)-AS(4))**2+(SS(5)-AS(5))**2+(SS(6)-AS(6))  ELCOM     124
     1**2))                                                              ELCOM     125
      Q1=Q*(2.*(SS(1)-AS(1))-(SS(2)-AS(2))-(SS(3)-AS(3)))                ELCOM     126
      Q2=Q*(2.*(SS(2)-AS(2))-(SS(1)-AS(1))-(SS(3)-AS(3)))                ELCOM     127
      Q3=Q*(2.*(SS(3)-AS(3))-(SS(1)-AS(1))-(SS(2)-AS(2)))                ELCOM     128
      Q4=Q*6.*(SS(4)-AS(4))                                              ELCOM     129
      Q5=Q*6.*(SS(5)-AS(5))                                              ELCOM     130
      Q6=Q*6.*(SS(6)-AS(6))                                              ELCOM     131
      IF(ISS.NE.0) GO TO 125                                             ELCOM     132
      IF(M.NE.1 .AND. IMET.EQ.MMET) GO TO 125                            ELCOM     133
      GO TO 130                                                          ELCOM     134
  125 IIDI=IID+(IMET-1)*6                                                ELCOM     135
      VF=AA(IIDI+5)                                                      ELCOM     136
      EM=AA(IIDI+1)                                                      ELCOM     137
      UM=AA(IIDI+2)                                                      ELCOM     138
      EF=AA(IIDI+3)                                                      ELCOM     139
      UF=AA(IIDI+4)                                                      ELCOM     140
      VM=1.-VF                                                           ELCOM     141
      PA=UM*EF-UF*EM                                                     ELCOM     142
      EC=VM*EM+VF*EF                                                     ELCOM     143
      ET=VM/EM+VF/EF                                                     ELCOM     144
  130 RR=H*EC+VF*EF*EM*Q3                                                ELCOM     145
      R11=VF*(H*PA-EF*EM*Q1)/RR                                          ELCOM     146
      R22=VF*(H*PA-EF*EM*Q2)/RR                                          ELCOM     147
      R33=H*EM/RR                                                        ELCOM     148
      R12=-VF*EF*EM*Q4/RR                                                ELCOM     149
      R13=-VF*EF*EM*Q5/RR                                                ELCOM     150
      R23=-VF*EF*EM*Q6/RR                                                ELCOM     151
      JJ=0                                                               ELCOM     152
  140 K=0                                                                ELCOM     153
      DO 150 I=1,6                                                       ELCOM     154
      DO 150 J=I,6                                                       ELCOM     155
      K=K+1                                                              ELCOM     156
  150 DD(I,J)=D21(K)                                                     ELCOM     157
      IF(JJ.EQ.1) GO TO 155                                              ELCOM     158
      DD(1,1)=ET-VM*PA*R11/EF/EM+VM*Q1*(VF*PA-EC*R11)/VF/EF/EM/Q3        ELCOM     159
      DD(1,2)=-VM*UM/EM-VF*UF/EF-VM*PA*R11/EF/EM+VM*Q2*(VF*PA-EC*R11)/   ELCOM     160
     1 VF/EF/EM/Q3                                                       ELCOM     161
      DD(1,3)=-UF/EF-VM*R11/VF/EF                                        ELCOM     162
      DD(1,4)=VM*Q4*(VF*PA-EC*R11)/VF/EF/EM/Q3                           ELCOM     163
      DD(1,5)=DD(1,4)*Q5/Q4                                              ELCOM     164
      DD(1,6)=DD(1,4)*Q6/Q4                                              ELCOM     165
      DD(2,2)=ET-VM*PA*R22/EF/EM+VM*Q2*(VF*PA-EC*R22)/VF/EF/EM/Q3        ELCOM     166
      DD(2,3)=-UF/EF-VM*R22/VF/EF                                        ELCOM     167
      DD(2,4)=VM*Q4*(VF*PA-EC*R22)/VF/EF/EM/Q3                           ELCOM     168
      DD(2,5)=DD(2,4)*Q5/Q4                                              ELCOM     169
      DD(2,6)=DD(2,4)*Q6/Q4                                              ELCOM     170
      DD(3,3)=(1.-VM*R33)/VF/EF                                          ELCOM     171
      DD(3,4)=VM*Q4*(EM-EC*R33)/VF/EF/EM/Q3                              ELCOM     172
      DD(3,5)=DD(3,4)*Q5/Q4                                              ELCOM     173
      DD(3,6)=DD(3,4)*Q6/Q4                                              ELCOM     174
      DD(4,4)=DD(4,4)-VM*EC*Q4*R12/VF/EF/EM/Q3                           ELCOM     175
      DD(4,5)=-VM*EC*Q5*R12/VF/EF/EM/Q3                                  ELCOM     176
      DD(4,6)=DD(4,5)*Q6/Q5                                              ELCOM     177
      DD(5,5)=DD(5,5)-VM*EC*Q5*R13/VF/EF/EM/Q3                           ELCOM     178
      DD(5,6)=-VM*EC*Q6*R13/VF/EF/EM/Q3                                  ELCOM     179
      DD(6,6)=DD(6,6)-VM*EC*Q6*R23/VF/EF/EM/Q3                           ELCOM     180
      IF(ISS.EQ.1) H=H1                                                  ELCOM     181
  155 DO 160 I=2,6                                                       ELCOM     182
      I1=I-1                                                             ELCOM     183
      DO 160 J=1,I1                                                      ELCOM     184
  160 DD(I,J)=DD(J,I)                                                    ELCOM     185
C     COMPUTE COMPLIANCE MATRIX IN OVERALL COORDINATES                   ELCOM     186
C     IF ISS.NE.0, STRESS TRANSF. MATRIX E66 IS AVAILABLE                ELCOM     187
      IF(ISS.NE.0) GO TO 180                                             ELCOM     188
      IF(M.EQ.1) GO TO 170                                               ELCOM     189
      MMFI=IA(J1+M-1)-100*MMET                                           ELCOM     190
C     IF CURRENT ELEMENT AND PREVIOUS ELEMENT HAS SAME FIBER DIRECTION,  ELCOM     191
C     E66 IS AVAILABLE                                                   ELCOM     192
      IF(JMFI.EQ.MMFI) GO TO 180                                         ELCOM     193
C     COMPUTE LAMINA DIRECTION COSINES W.R.T. OVERALL AXES IN DIR        ELCOM     194
  170 CALL CODI4                                                         ELCOM     195
C     COMPUTE STRESS TRANSFORMATION MATRIX E66                           ELCOM     196
      CALL TRANS4                                                        ELCOM     197
  180 DO 190 I=1,6                                                       ELCOM     198
      DO 190 J=1,6                                                       ELCOM     199
      S66(I,J)=0.                                                        ELCOM     200
      DO 190 K=1,6                                                       ELCOM     201
  190 S66(I,J)=S66(I,J)+DD(I,K)*E66(K,J)                                 ELCOM     202
      DO 200 I=1,6                                                       ELCOM     203
      DO 200 J=1,6                                                       ELCOM     204
      DD(I,J)=0.                                                         ELCOM     205
      DO 200 K=1,6                                                       ELCOM     206
  200 DD(I,J)=DD(I,J)+E66(K,I)*S66(K,J)                                  ELCOM     207
      RETURN                                                             ELCOM     208
  210 CALL ELISO (DD,SS,AS,ISS)                                          ELCOM     209
      RETURN                                                             ELCOM     210
      END                                                                ELCOM     211
*DECK ELISO
      SUBROUTINE ELISO (DD,SS,AS,ISS)                                    ELISO       2
C     TO COMPUTE CURRENT COMPLIANCE MATRIX FOR ISOTROPIC ELEMENTS IN DD  ELISO       3
CMAP10                                                                   ELISO       4
      COMMON/COMEL/IN                                                    ELISO       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ELISO       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ELISO       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       ELISO       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ELISO       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ELISO      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ELISO      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ELISO      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ELISO      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ELISO      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ELISO      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ELISO      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ELISO      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ELISO      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ELISO      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ELISO      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ELISO      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ELISO      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ELISO      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ELISO      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ELISO      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ELISO      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ELISO      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ELISO      28
      EQUIVALENCE     (IA(401), S(1))                                    ELISO      29
CEND MAP10                                                               ELISO      30
CMAP20                                                                   ELISO      31
      DIMENSION LLL(27)                                                  ELISO      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   ELISO      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   ELISO      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  ELISO      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  ELISO      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   ELISO      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   ELISO      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   ELISO      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   ELISO      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  ELISO      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   ELISO      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   ELISO      43
CEND MAP20                                                               ELISO      44
      DIMENSION DD(6,6),SS(6),AS(6)                                      ELISO      45
C     IF ISS.NE.0, ELASTIC COMPLIANCE MATRIX IS ALREADY AVAILABLE IN D21 ELISO      46
      IF(ISS.NE.0) GO TO 30                                              ELISO      47
      IF(M.EQ.1) GO TO 10                                                ELISO      48
      MMET=IA(J1+M-1)/100                                                ELISO      49
C     IF THE MATERIAL OF CURRENT ELEMENT IS SAME AS THAT OF PREVIOUS     ELISO      50
C     ELEMENT, ELASTIC COMPL. MATRIX IS ALREADY AVAILABLE IN D21         ELISO      51
      IF(IMET.EQ.MMET) GO TO 30                                          ELISO      52
   10 AL1=AA(IIA+IMET)                                                   ELISO      53
      AL2=AL1                                                            ELISO      54
      AL3=AL1                                                            ELISO      55
      N2=2                                                               ELISO      56
      IF(ITYPE.EQ.1) N2=6                                                ELISO      57
      IIDI=IID+(IMET-1)*N2                                               ELISO      58
      EE=AA(IIDI+1)                                                      ELISO      59
      PU=AA(IIDI+2)                                                      ELISO      60
      GG=EE/2./(1.+PU)                                                   ELISO      61
      DO 20 I=1,21                                                       ELISO      62
   20 D21(I)=0.                                                          ELISO      63
      D21(1)=1./EE                                                       ELISO      64
      D21(2)=-PU/EE                                                      ELISO      65
      D21(3)=D21(2)                                                      ELISO      66
      D21(7)=D21(1)                                                      ELISO      67
      D21(8)=D21(2)                                                      ELISO      68
      D21(12)=D21(1)                                                     ELISO      69
      D21(16)=1./GG                                                      ELISO      70
      D21(19)=1./GG                                                      ELISO      71
      D21(21)=1./GG                                                      ELISO      72
C     YP=YIELD STRESS OF THE MATERIAL, ES=EFFECTIVE STRESS               ELISO      73
   30 YP=AA(LLL(7)+M)                                                    ELISO      74
      ES=AA(LLL(8)+M)                                                    ELISO      75
C     JJ% INDICATOR, 0=PLASTIC ELEMENT, 1=ELASTIC ELEMENT                ELISO      76
      JJ=1                                                               ELISO      77
      IF(ITER.EQ.1 .AND. ITERS.EQ.1) GO TO 120                           ELISO      78
      IF(ISS.EQ.1) GO TO 50                                              ELISO      79
      DO 40 I=1,6                                                        ELISO      80
      SS(I)=AA(LLL(I)+M)                                                 ELISO      81
   40 AS(I)=AA(LLL(9+I)+M)                                               ELISO      82
C     DETERMINE STATE OF THE ELEMENT AT THE BEGINNING OF SUBSTEP         ELISO      83
C     YP.LT.0; PLASTIC ELEMENT                                           ELISO      84
   50 IF(YP.GE.0.) GO TO 120                                             ELISO      85
      IF(ISS.EQ.1) H1=H                                                  ELISO      86
      IF(IHARD.NE.0) GO TO 80                                            ELISO      87
      CALL YHAR4P (ES,IMET,H)                                            ELISO      88
      GO TO 110                                                          ELISO      89
   80 KS=LHD+IMAT+(IMET-1)*20*IHARD+10*IHARD                             ELISO      90
      K=IA(LHD+IMET)                                                     ELISO      91
      KE=KS-10*IHARD                                                     ELISO      92
      DO 90 I=2,K                                                        ELISO      93
   90 IF(ES.LT.AA(KS+I)) GO TO 100                                       ELISO      94
      I=I-1                                                              ELISO      95
  100 H=(AA(KS+I)-AA(KS+I-1))/(AA(KE+I)-AA(KE+I-1))                      ELISO      96
  110 Q=2.*(SS(3)-AS(3))-(SS(1)-AS(1))-(SS(2)-AS(2))                     ELISO      97
      Q=Q/6./(YP*YP+3.*((SS(4)-AS(4))**2+(SS(5)-AS(5))**2+(SS(6)-AS(6))  ELISO      98
     1 **2))                                                             ELISO      99
      Q1=Q*(2.*(SS(1)-AS(1))-(SS(2)-AS(2))-(SS(3)-AS(3)))                ELISO     100
      Q2=Q*(2.*(SS(2)-AS(2))-(SS(1)-AS(1))-(SS(3)-AS(3)))                ELISO     101
      Q3=Q*(2.*(SS(3)-AS(3))-(SS(1)-AS(1))-(SS(2)-AS(2)))                ELISO     102
      Q4=Q*6.*(SS(4)-AS(4))                                              ELISO     103
      Q5=Q*6.*(SS(5)-AS(5))                                              ELISO     104
      Q6=Q*6.*(SS(6)-AS(6))                                              ELISO     105
      JJ=0                                                               ELISO     106
  120 K=0                                                                ELISO     107
      DO 130 I=1,6                                                       ELISO     108
      DO 130 J=I,6                                                       ELISO     109
      K=K+1                                                              ELISO     110
  130 DD(I,J)=D21(K)                                                     ELISO     111
      IF(JJ.EQ.1) GO TO 135                                              ELISO     112
      DD(1,1)=DD(1,1)+Q1**2/Q3/H                                         ELISO     113
      DD(1,2)=DD(1,2)+Q1*Q2/Q3/H                                         ELISO     114
      DD(1,3)=DD(1,3)+Q1/H                                               ELISO     115
      DD(1,4)=Q1*Q4/Q3/H                                                 ELISO     116
      DD(1,5)=Q1*Q5/Q3/H                                                 ELISO     117
      DD(1,6)=Q1*Q6/Q3/H                                                 ELISO     118
      DD(2,2)=DD(2,2)+Q2**2/Q3/H                                         ELISO     119
      DD(2,3)=DD(2,3)+Q2/H                                               ELISO     120
      DD(2,4)=Q2*Q4/Q3/H                                                 ELISO     121
      DD(2,5)=Q2*Q5/Q3/H                                                 ELISO     122
      DD(2,6)=Q2*Q6/Q3/H                                                 ELISO     123
      DD(3,3)=DD(3,3)+Q3/H                                               ELISO     124
      DD(3,4)=Q4/H                                                       ELISO     125
      DD(3,5)=Q5/H                                                       ELISO     126
      DD(3,6)=Q6/H                                                       ELISO     127
      DD(4,4)=DD(4,4)+Q4**2/Q3/H                                         ELISO     128
      DD(4,5)=Q4*Q5/Q3/H                                                 ELISO     129
      DD(4,6)=Q4*Q6/Q3/H                                                 ELISO     130
      DD(5,5)=DD(5,5)+Q5**2/Q3/H                                         ELISO     131
      DD(5,6)=Q5*Q6/Q3/H                                                 ELISO     132
      DD(6,6)=DD(6,6)+Q6**2/Q3/H                                         ELISO     133
      IF(ISS.EQ.1) H=H1                                                  ELISO     134
  135 DO 140 I=2,6                                                       ELISO     135
      I1=I-1                                                             ELISO     136
      DO 140 J=1,I1                                                      ELISO     137
  140 DD(I,J)=DD(J,I)                                                    ELISO     138
      RETURN                                                             ELISO     139
      END                                                                ELISO     140
*DECK ELMT4
      SUBROUTINE ELMT4 (DD,SS,AS,ISS)                                    ELMT4       2
C     TO COMPUTE CURRENT COMPLIANCE MATRIX IN DD                         ELMT4       3
C     DD % COMPLIANCE MATRIX                                             ELMT4       4
C     SS % CUMUL. STRESSES (OF MATRIX IF COMPOSITE)                      ELMT4       5
C     AS % CENTER OF Y.S. (OF MATRIX IF COMPOSITE)                       ELMT4       6
C     ISS% INDICATOR; 0=OBTAIN SS&AS FROM CORE, 1=USE WHATEVER IN SS&AS  ELMT4       7
CMAP10                                                                   ELMT4       8
      COMMON/COMEL/IN                                                    ELMT4       9
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  ELMT4      10
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     ELMT4      11
      EQUIVALENCE (IN,IA(1),AA(1))                                       ELMT4      12
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   ELMT4      13
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   ELMT4      14
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   ELMT4      15
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   ELMT4      16
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   ELMT4      17
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   ELMT4      18
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   ELMT4      19
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   ELMT4      20
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   ELMT4      21
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   ELMT4      22
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   ELMT4      23
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   ELMT4      24
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   ELMT4      25
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   ELMT4      26
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   ELMT4      27
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   ELMT4      28
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   ELMT4      29
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   ELMT4      30
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   ELMT4      31
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    ELMT4      32
      EQUIVALENCE     (IA(401), S(1))                                    ELMT4      33
CEND MAP10                                                               ELMT4      34
CMAP20                                                                   ELMT4      35
      DIMENSION LLL(27)                                                  ELMT4      36
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   ELMT4      37
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   ELMT4      38
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  ELMT4      39
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  ELMT4      40
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   ELMT4      41
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   ELMT4      42
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   ELMT4      43
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   ELMT4      44
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  ELMT4      45
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   ELMT4      46
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   ELMT4      47
CEND MAP20                                                               ELMT4      48
      DIMENSION DD(6,6),SS(6),AS(6)                                      ELMT4      49
      IF(ITYPE-1) 10,20,20                                               ELMT4      50
   10 CALL ELISO (DD,SS,AS,ISS)                                          ELMT4      51
      GO TO 30                                                           ELMT4      52
   20 CALL ELCOM (DD,SS,AS,ISS)                                          ELMT4      53
   30 IF (INP.NE.2) RETURN                                               ELMT4      54
      WRITE(MO,40) M,ITER,ITERS,((DD(I,J),J=I,6),I=1,6)                  ELMT4      55
   40 FORMAT(///1X,29HCOMPLIANCE MATRIX FOR ELEMENT,I5,5X,5HSTEP%,I4,5X, ELMT4      56
     18HSUBSTEP%,I4,2X,24H(FOR STRESS COMPUTATION)/6E15.6/15X,5E15.6/30X ELMT4      57
     2,4E15.6/45X,3E15.6/60X,2E15.6/75X,E15.6)                           ELMT4      58
      RETURN                                                             ELMT4      59
      END                                                                ELMT4      60
*DECK FAILUR
      SUBROUTINE FAILUR(IFAIL,IFB)                                       FAILUR      2
C     TO CHECK FAILURE CRITERION OF FIBERS. DETERMINES ELEMENT CLOSEST   FAILUR      3
C     TO FAILURE.                                                        FAILUR      4
C     IFAIL=1; IF ULTIMATE STRENGTH OF FIBER IS REACHED AND IAMB=0.      FAILUR      5
C              PROGRAM WILL TERMINATE.                                   FAILUR      6
C     IFAIL=0; OTHERWISE.  PROGRAM CONTINUES                             FAILUR      7
C                                                                        FAILUR      8
CMAP10                                                                   FAILUR      9
      COMMON/COMEL/IN                                                    FAILUR     10
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  FAILUR     11
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     FAILUR     12
     2,DIR(3,3),E66(6,6),LLV(6),EG(6),EL(6)                              FAILUR     13
      EQUIVALENCE (IN,IA(1),AA(1))                                       FAILUR     14
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   FAILUR     15
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   FAILUR     16
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   FAILUR     17
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   FAILUR     18
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   FAILUR     19
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   FAILUR     20
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   FAILUR     21
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   FAILUR     22
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   FAILUR     23
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   FAILUR     24
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   FAILUR     25
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   FAILUR     26
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   FAILUR     27
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   FAILUR     28
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   FAILUR     29
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   FAILUR     30
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   FAILUR     31
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   FAILUR     32
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   FAILUR     33
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    FAILUR     34
      EQUIVALENCE (IA(401),S(1)),(IA(236),DIR(1)),(IA(274),E66(1))       FAILUR     35
CEND MAP10                                                               FAILUR     36
CMAP20                                                                   FAILUR     37
      DIMENSION LLL(27)                                                  FAILUR     38
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   FAILUR     39
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   FAILUR     40
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  FAILUR     41
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  FAILUR     42
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   FAILUR     43
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   FAILUR     44
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   FAILUR     45
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   FAILUR     46
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  FAILUR     47
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   FAILUR     48
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   FAILUR     49
CEND MAP20                                                               FAILUR     50
      WRITE(MO,5) ITER,CUMS                                              FAILUR     51
    5 FORMAT(/////24H FAILURE MAP/      STEP%,I4,5X,13H LOAD FACTOR%,    FAILUR     52
     1E12.5)                                                             FAILUR     53
      ICT=0                                                              FAILUR     54
      IFAIL=0                                                            FAILUR     55
      FSMAX=0.                                                           FAILUR     56
      DO 90 M=1,IT                                                       FAILUR     57
      JM=J1+M                                                            FAILUR     58
      IMET=IA(JM)/100                                                    FAILUR     59
      IIDI=IID+(IMET-1)*6                                                FAILUR     60
      VF=AA(IIDI+5)                                                      FAILUR     61
      IF(VF.EQ.0.) GO TO 90                                              FAILUR     62
      VM=1.0-VF                                                          FAILUR     63
      EM=AA(IIDI+1)                                                      FAILUR     64
      EF=AA(IIDI+3)                                                      FAILUR     65
      SFU=AA(IIDI+6)                                                     FAILUR     66
      SF33=AA(LLL(24)+M)                                                 FAILUR     67
      IIAI=IIA+2*(IMET-1)+1                                              FAILUR     68
      SFT=AA(IIAI)                                                       FAILUR     69
      IF (SFT.NE.0.0.AND.SFU.NE.0.0) GO TO 35                            FAILUR     70
      IFAIL=1                                                            FAILUR     71
      WRITE (MO,36) IMET                                                 FAILUR     72
   36 FORMAT (52H 25.  FIBER AXIAL AND/OR SHEAR FAILURE STRENGTHS NOT,   FAILUR     73
     123H SPECIFIED FOR ELEMENT ,I5,/,22H    PROGRAM TERMINATED)         FAILUR     74
      RETURN                                                             FAILUR     75
   35 SF13=AA(LLL(26)+M)                                                 FAILUR     76
      FC=(SF33/SFU)*(SF33/SFU)+(SF13/SFT)*(SF13/SFT)                     FAILUR     77
      IF (FC.LE.FSMAX) GO TO 10                                          FAILUR     78
      FSMAX=FC                                                           FAILUR     79
      L=M                                                                FAILUR     80
   10 IF (FC-1.0) 70,30,50                                               FAILUR     81
   30 WRITE(MO,40) M                                                     FAILUR     82
   40 FORMAT(//31H  FIBER AXIAL STRESS IN ELEMENT,I5,27H REACHED ULTIMAT FAILUR     83
     1TE STRENGTH)                                                       FAILUR     84
       GO TO 65                                                          FAILUR     85
   50 PRCNT=(FC-1.0)*100.0                                               FAILUR     86
      WRITE(MO,60) M,PRCNT                                               FAILUR     87
   60 FORMAT(//31H  FIBER AXIAL STRESS IN ELEMENT,I5,30H EXCEEDES ULTIMA FAILUR     88
     1TE STRENGTH BY,E12.4,1H:)                                          FAILUR     89
  65   IF (IAMB.EQ.0) GO TO 90                                           FAILUR     90
      ICT=ICT+1                                                          FAILUR     91
      GO TO 90                                                           FAILUR     92
   70 IF (FC.LT.0.9) GO TO 90                                            FAILUR     93
      PRCNT=FC*100.0                                                     FAILUR     94
      WRITE(MO,80) M,PRCNT                                               FAILUR     95
   80 FORMAT(//31H  FIBER AXIAL STRESS IN ELEMENT,I5,8H REACHED,         FAILUR     96
     1F7.2,22H: OF ULTIMATE STRENGTH)                                    FAILUR     97
   90 CONTINUE                                                           FAILUR     98
      IF (ICT.LE.0) GO TO 91                                             FAILUR     99
       WRITE (MO,67) L                                                   FAILUR    100
   67 FORMAT (8H ELEMENT,I5,18H HAS BEEN WEAKENED)                       FAILUR    101
      IFB=IFB+1                                                          FAILUR    102
      JM=J1+L                                                            FAILUR    103
       JMFI=IA(JM)-100*(IA(JM)/100)                                      FAILUR    104
       IA(JM)=100*IAMB+JMFI                                              FAILUR    105
      DO 2 K=22,27                                                       FAILUR    106
    2 AA(LLL(K)+L)=0.0                                                   FAILUR    107
      I2=IID+(IAMB-1)*6                                                  FAILUR    108
      RF=(AA(I2+3)*VF+EM*VM)/(EF*VF+EM*VM)                               FAILUR    109
      AA(LLL(1)+L)=RF*(AA(LLL(1)+L))                                     FAILUR    110
   91  IF (FSMAX.GE.1 .AND. IAMB.EQ.0) IFAIL=1                           FAILUR    111
      IF (FSMAX.EQ.0.0) L=IT                                             FAILUR    112
      IF (FSMAX.EQ.0.0) FSMAX=FC                                         FAILUR    113
      WRITE(MO,100) L,FSMAX                                              FAILUR    114
  100 FORMAT(////43H   FAILURE IS PREDICTED TO OCCUR IN ELEMENT,I5/      FAILUR    115
     138H    WHERE FIBER FAILURE CRITERION IS ,E12.4)                    FAILUR    116
      LEN=6*IT+3*IN                                                      FAILUR    117
      LLV(1)=IST+2*ISUM+1                                                FAILUR    118
      DO 175 I=2,6                                                       FAILUR    119
  175 LLV(I)=LLV(I-1)+IT                                                 FAILUR    120
      DO 200 M=1,IT                                                      FAILUR    121
      JM=J1+M                                                            FAILUR    122
      IMET=IA(JM)/100                                                    FAILUR    123
      IIDI=IID+(IMET-1)*6                                                FAILUR    124
      UF=AA(IIDI+4)                                                      FAILUR    125
      JMFI=IA(JM)-100*IMET                                               FAILUR    126
      IIAI=IIA+2*(IMET-1)+1                                              FAILUR    127
      EULT=AA(IIAI+1)                                                    FAILUR    128
      IF (M.EQ.1) GO TO 170                                              FAILUR    129
      MMET=IA(JM-1)/100                                                  FAILUR    130
      MMFI=IA(JM+M-1)-100*MMET                                           FAILUR    131
      IF (JMFI.EQ.MMFI) GO TO 180                                        FAILUR    132
  170 CALL CODI4                                                         FAILUR    133
      CALL TRANN4                                                        FAILUR    134
  180 CONTINUE                                                           FAILUR    135
      DO 185 K=1,6                                                       FAILUR    136
  185 EG(K)=AA(LLV(K)+LEN+M)                                             FAILUR    137
      DO 190 I=1,6                                                       FAILUR    138
      EL(I)=0.0                                                          FAILUR    139
      DO 190 J=1,6                                                       FAILUR    140
  190 EL(I)=EL(I)+E66(I,J)*EG(J)                                         FAILUR    141
      SF11=AA(LLL(22)+M)                                                 FAILUR    142
      SF13=AA(LLL(26)+M)                                                 FAILUR    143
      EL(1)=(EL(1)-VF*SF11/EF)/VM                                        FAILUR    144
      EF13=2.0*(1.0+UF)*SF13/EF                                          FAILUR    145
      EL(5)=(EL(5)-VF*EF13)/VM                                           FAILUR    146
      EXX=SQRT(EL(1)*EL(1)+EL(3)*EL(3)-EL(1)*EL(3)+3.0*EL(5)*EL(5))      FAILUR    147
      IF (EXX.LT.EULT) GO TO 200                                         FAILUR    148
      WRITE (MO,201) M                                                   FAILUR    149
  201 FORMAT (/,11H   ELEMENT ,I5,36H HAS EXCEEDED ULTIMATE MATRIX STRAI FAILUR    150
     1N,/,33H   REDUCED MATRIX PROPERTIES USED,/)                        FAILUR    151
      IFB=IFB+1                                                          FAILUR    152
      IMATI=0                                                            FAILUR    153
      IF (IMET.EQ.1) IMATI=IMAT                                          FAILUR    154
      IF (IMET.EQ.2) IMATI=IAMB+1                                        FAILUR    155
      JM=J1+M                                                            FAILUR    156
      JMFI=IA(JM)-100*(IA(JM)/100)                                       FAILUR    157
      IA(JM)=100*(IMATI)+JMFI                                            FAILUR    158
      H=10.0                                                             FAILUR    159
      I2=IID+(IMATI-2)*6                                                 FAILUR    160
      I3=IID+(IMATI-1)*6                                                 FAILUR    161
      RF=(AA(I2+3)*VF+AA(I3+1)*VM)/(EF*VF+EM*VM)                         FAILUR    162
      AA(LLL(1)+M)=RF*(AA(LLL(1)+M))                                     FAILUR    163
  200 CONTINUE                                                           FAILUR    164
      RETURN                                                             FAILUR    165
      END                                                                FAILUR    166
*DECK INV
      SUBROUTINE INV(A,N,B,M,DETERM)                                     INV         2
C *** INVERTS MATRICES UPTO ORDER 8 BY GAUSS ELIMINATION                 INV         3
C *** SLAVE TO RESS1P AND STRNP                                          INV         4
      DIMENSION IPIVOT( 6),A( 6, 6),B( 6,2),INDEX( 6,2),PIVOT( 6)        INV         5
      EQUIVALENCE (IROW,JROW), (ICOLUM,JCOLUM), (AMAX, T, SWAP)          INV         6
C                                                                        INV         7
C                                                                        INV         8
C     INITIALIZATION                                                     INV         9
C                                                                        INV        10
   10 DETERM=1.0                                                         INV        11
   15 DO 20 J=1,N                                                        INV        12
   20 IPIVOT(J)=0                                                        INV        13
      BB=1.E-30                                                          INV        14
      GO TO 9003                                                         INV        15
 9002 DETERM=0.0                                                         INV        16
      GO TO 740                                                          INV        17
 9003 CONTINUE                                                           INV        18
   30 DO 550 I=1,N                                                       INV        19
C                                                                        INV        20
C     SEARCH FOR PIVOT ELEMENT                                           INV        21
C                                                                        INV        22
   40 AMAX=0.0                                                           INV        23
   45 DO 105 J=1,N                                                       INV        24
   50 IF (IPIVOT(J)-1) 60, 105, 60                                       INV        25
   60 DO 100 K=1,N                                                       INV        26
   70 IF (IPIVOT(K)-1) 80, 100, 9002                                     INV        27
   80 IF (ABS(AMAX)-ABS(A(J,K))) 85, 100, 100                            INV        28
   85 IROW=J                                                             INV        29
   90 ICOLUM=K                                                           INV        30
   95 AMAX=A(J,K)                                                        INV        31
  100 CONTINUE                                                           INV        32
  105 CONTINUE                                                           INV        33
      IF (ABS(AMAX)-BB) 9002,9002,110                                    INV        34
  110 IPIVOT(ICOLUM)=IPIVOT(ICOLUM)+1                                    INV        35
C                                                                        INV        36
C     INTERCHANGE ROWS TO PUT PIVOT ELEMENT ON DIAGONAL                  INV        37
C                                                                        INV        38
  130 IF (IROW-ICOLUM) 140, 260, 140                                     INV        39
  140 DETERM=-DETERM                                                     INV        40
  150 DO 200 L=1,N                                                       INV        41
  160 SWAP=A(IROW,L)                                                     INV        42
  170 A(IROW,L)=A(ICOLUM,L)                                              INV        43
  200 A(ICOLUM,L)=SWAP                                                   INV        44
  205 IF(M) 260, 260, 210                                                INV        45
  210 DO 250 L=1, M                                                      INV        46
  220 SWAP=B(IROW,L)                                                     INV        47
  230 B(IROW,L)=B(ICOLUM,L)                                              INV        48
  250 B(ICOLUM,L)=SWAP                                                   INV        49
  260 INDEX(I,1)=IROW                                                    INV        50
  270 INDEX(I,2)=ICOLUM                                                  INV        51
  310 PIVOT(I)=A(ICOLUM,ICOLUM)                                          INV        52
  320 DETERM=DETERM*PIVOT(I)                                             INV        53
C                                                                        INV        54
C     DIVIDE PIVOT ROW BY PIVOT ELEMENT                                  INV        55
C                                                                        INV        56
  330 A(ICOLUM,ICOLUM)=1.0                                               INV        57
  340 DO 350 L=1,N                                                       INV        58
  350 A(ICOLUM,L)=A(ICOLUM,L)/PIVOT(I)                                   INV        59
  355 IF(M) 380, 380, 360                                                INV        60
  360 DO 370 L=1,M                                                       INV        61
  370 B(ICOLUM,L)=B(ICOLUM,L)/PIVOT(I)                                   INV        62
C                                                                        INV        63
C     REDUCE NON-PIVOT ROWS                                              INV        64
C                                                                        INV        65
  380 DO 550 L1=1,N                                                      INV        66
  390 IF(L1-ICOLUM) 400, 550, 400                                        INV        67
  400 T=A(L1,ICOLUM)                                                     INV        68
  420 A(L1,ICOLUM)=0.0                                                   INV        69
  430 DO 450 L=1,N                                                       INV        70
  450 A(L1,L)=A(L1,L)-A(ICOLUM,L)*T                                      INV        71
  455 IF(M) 550, 550, 460                                                INV        72
  460 DO 500 L=1,M                                                       INV        73
  500 B(L1,L)=B(L1,L)-B(ICOLUM,L)*T                                      INV        74
  550 CONTINUE                                                           INV        75
C                                                                        INV        76
C     INTERCHANGE COLUMNS                                                INV        77
C                                                                        INV        78
  600 DO 710 I=1,N                                                       INV        79
  610 L=N+1-I                                                            INV        80
  620 IF (INDEX(L,1)-INDEX(L,2)) 630, 710, 630                           INV        81
  630 JROW=INDEX(L,1)                                                    INV        82
  640 JCOLUM=INDEX(L,2)                                                  INV        83
  650 DO 705 K=1,N                                                       INV        84
  660 SWAP=A(K,JROW)                                                     INV        85
  670 A(K,JROW)=A(K,JCOLUM)                                              INV        86
  700 A(K,JCOLUM)=SWAP                                                   INV        87
  705 CONTINUE                                                           INV        88
  710 CONTINUE                                                           INV        89
  740 RETURN                                                             INV        90
      END                                                                INV        91
*DECK LOADY
      SUBROUTINE LOADY (DD,CYBED)                                        LOADY       2
C     TO COMPUTE LOAD VECTOR OF STORED INCR. DEFLECTIONS AND CURRENT     LOADY       3
C     MATERIAL PROPERTIES                                                LOADY       4
C     DD=MATERIAL MATRIX                                                 LOADY       5
CMAP10                                                                   LOADY       6
      COMMON/COMEL/IN                                                    LOADY       7
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  LOADY       8
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     LOADY       9
      EQUIVALENCE (IN,IA(1),AA(1))                                       LOADY      10
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   LOADY      11
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   LOADY      12
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   LOADY      13
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   LOADY      14
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   LOADY      15
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   LOADY      16
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   LOADY      17
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   LOADY      18
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   LOADY      19
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   LOADY      20
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   LOADY      21
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   LOADY      22
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   LOADY      23
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   LOADY      24
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   LOADY      25
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   LOADY      26
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   LOADY      27
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   LOADY      28
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   LOADY      29
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    LOADY      30
      EQUIVALENCE     (IA(401), S(1))                                    LOADY      31
CEND MAP10                                                               LOADY      32
CMAP20                                                                   LOADY      33
      DIMENSION LLL(27)                                                  LOADY      34
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   LOADY      35
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   LOADY      36
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  LOADY      37
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  LOADY      38
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   LOADY      39
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   LOADY      40
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   LOADY      41
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   LOADY      42
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  LOADY      43
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   LOADY      44
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   LOADY      45
CEND MAP20                                                               LOADY      46
      DIMENSION NN(10,4),II(3,3),KK(3,3),V(4,3),DD(6,6),KKK(9),JJJ(9)    LOADY      47
      DIMENSION DD1(6),DD2(6)                                            LOADY      48
      DATA NN/2,1,2,1,3,2,1,4,1,2, 7,3,4,8,8,5,6,7,3,7,                  LOADY      49
     1        4,6,5,3,6,7,8,5,8,5, 1,2,3,4,5,6,7,8,6,4/                  LOADY      50
      DATA II/1,2,3,4,4,5,5,6,6/                                         LOADY      51
      DATA KK/1,2,3,2,1,1,3,3,2/                                         LOADY      52
      DATA KKK/1,2,3,2,3,3,1,1,2/                                        LOADY      53
      DATA JJJ/1,2,3,1,1,2,2,3,3/                                        LOADY      54
      LLX=IST+ISUM+1                                                     LOADY      55
      LLY=LLX+ISUM                                                       LOADY      56
      LLZ=LLY+6*IT                                                       LOADY      57
      LLU=LLZ+3*IN                                                       LOADY      58
      LLN=LLU+6*IT                                                       LOADY      59
      IDEG=3                                                             LOADY      60
      DO 2 I=1,24                                                        LOADY      61
    2 P(I)=0.                                                            LOADY      62
      DO 51 I=1,10                                                       LOADY      63
      R=-1.                                                              LOADY      64
      DO 100 J=1,4                                                       LOADY      65
      R=-R                                                               LOADY      66
      I1=J+2                                                             LOADY      67
      IF (I1.GT.4) I1=I1-4                                               LOADY      68
      I2=J+1                                                             LOADY      69
      IF (I2.GT.4) I2=I2-4                                               LOADY      70
      I3=J+3                                                             LOADY      71
      IF (I3.GT.4) I3=I3-4                                               LOADY      72
      K1=N(NN(I,I1))                                                     LOADY      73
      K2=N(NN(I,I2))                                                     LOADY      74
      K3=N(NN(I,I3))                                                     LOADY      75
      V(J,1)=R*((AA(IYY+K1)-AA(IYY+K2))*(AA(IZZ+K3)-AA(IZZ+K2))          LOADY      76
     1         -(AA(IYY+K3)-AA(IYY+K2))*(AA(IZZ+K1)-AA(IZZ+K2)))         LOADY      77
      V(J,2)=R*((AA(IZZ+K1)-AA(IZZ+K2))*(AA(IXX+K3)-AA(IXX+K2))          LOADY      78
     1         -(AA(IZZ+K3)-AA(IZZ+K2))*(AA(IXX+K1)-AA(IXX+K2)))         LOADY      79
      V(J,3)=R*((AA(IXX+K1)-AA(IXX+K2))*(AA(IYY+K3)-AA(IYY+K2))          LOADY      80
     1         -(AA(IXX+K3)-AA(IXX+K2))*(AA(IYY+K1)-AA(IYY+K2)))         LOADY      81
  100 CONTINUE                                                           LOADY      82
      K4=N(NN(I,4))                                                      LOADY      83
      DET=V(4,1)*(AA(IXX+K4)-AA(IXX+K2))                                 LOADY      84
     1   +V(4,2)*(AA(IYY+K4)-AA(IYY+K2))                                 LOADY      85
     2   +V(4,3)*(AA(IZZ+K4)-AA(IZZ+K2))                                 LOADY      86
      VTEST=((ABS(AA(IXX+K1)-AA(IXX+K2))+ABS(AA(IYY+K1)-AA(IYY+K2))      LOADY      87
     1       +ABS(AA(IZZ+K1)-AA(IZZ+K2))+ABS(AA(IXX+K3)-AA(IXX+K2))      LOADY      88
     2       +ABS(AA(IYY+K3)-AA(IYY+K2))+ABS(AA(IZZ+K3)-AA(IZZ+K2))      LOADY      89
     3       +ABS(AA(IXX+K4)-AA(IXX+K2))+ABS(AA(IYY+K4)-AA(IYY+K2))      LOADY      90
     4       +ABS(AA(IZZ+K4)-AA(IZZ+K2)))/9.)**3                         LOADY      91
      IF(ABS(DET) .LT. 1.E-4*VTEST) GO TO 51                             LOADY      92
      DET=-(DET*12.)                                                     LOADY      93
      IME=0                                                              LOADY      94
  101 DO 11 J=1,6                                                        LOADY      95
      DD1(J)=0.                                                          LOADY      96
      DO 12 K=1,4                                                        LOADY      97
      IS=(N(NN(I,K))-1)*IDEG+JJJ(J)                                      LOADY      98
      IF(IME.NE.0) GO TO 102                                             LOADY      99
      DD1(J)=DD1(J)+V(K,KKK(J))*AA(IDEF+IS)                              LOADY     100
     1  *CYBED                                                           LOADY     101
      GO TO 12                                                           LOADY     102
  102 C=PRSD(IS)*DESC                                                    LOADY     103
      DD1(J)=DD1(J)+V(K,KKK(J))*(AA(IDEF+IS)-C)*CYBED                    LOADY     104
   12 CONTINUE                                                           LOADY     105
      IF(J.LT.4) GO TO 11                                                LOADY     106
      DO 13 K=1,4                                                        LOADY     107
      IS=(N(NN(I,K))-1)*IDEG+JJJ(J+3)                                    LOADY     108
      IF(IME.NE.0) GO TO 103                                             LOADY     109
      DD1(J)=DD1(J)+V(K,KKK(J+3))*AA(IDEF+IS)                            LOADY     110
     1  *CYBED                                                           LOADY     111
      GO TO 13                                                           LOADY     112
  103 C=PRSD(IS)*DESC                                                    LOADY     113
      DD1(J)=DD1(J)+V(K,KKK(J+3))*(AA(IDEF+IS)-C)*CYBED                  LOADY     114
   13 CONTINUE                                                           LOADY     115
11    DD1(J)=DD1(J)/DET                                                  LOADY     116
      DO 14 J=1,6                                                        LOADY     117
      DD2(J)=0.                                                          LOADY     118
      DO 16 K=1,6                                                        LOADY     119
16    DD2(J)=DD2(J)+DD(J,K)*DD1(K)                                       LOADY     120
14    CONTINUE                                                           LOADY     121
      DO 21 J=1,IDEG                                                     LOADY     122
      DO 21 K=1,4                                                        LOADY     123
      LL=(J-1)*8+NN(I,K)                                                 LOADY     124
      CU=0.                                                              LOADY     125
      DO 18 L=1,3                                                        LOADY     126
      IF(IME.NE.0) GO TO 108                                             LOADY     127
      CU=CU-V(K,KK(J,L))*DD2(II(J,L))                                    LOADY     128
      GO TO 18                                                           LOADY     129
  108 P(LL) = P(LL)-V(K,KK(J,L))*DD2(II(J,L))                            LOADY     130
   18 CONTINUE                                                           LOADY     131
C IF IME=0, ADD THE CONTRIBUTION OF THE CURRENT ELEMENT TO NODAL         LOADY     132
C FORCES IN LLN-AREA                                                     LOADY     133
      IF(IME.NE.0) GO TO 21                                              LOADY     134
      IS=(N(NN(I,K))-1)*IDEG+J                                           LOADY     135
      AA(LLN+IS)=AA(LLN+IS)-CU                                           LOADY     136
   21 CONTINUE                                                           LOADY     137
      IF(IME.NE.0) GO TO 51                                              LOADY     138
      IME=1                                                              LOADY     139
      GO TO 101                                                          LOADY     140
   51 CONTINUE                                                           LOADY     141
   37 IF (INP.NE.2) RETURN                                               LOADY     142
      WRITE(MO,251) M,ITER,ITERS,(P(I),I=1,24)                           LOADY     143
  251 FORMAT(//1X,22HLOAD VECTOR OF ELEMENT,I5,5X,5HSTEP%,I4,8HSUBSTEP%, LOADY     144
     1I4/8X,8HVERTEX 1,7X,8HVERTEX 2,7X,8HVERTEX 3,7X,8HVERTEX 4,7X,8HVE LOADY     145
     2RTEX 5,7X,8HVERTEX 6,7X,8HVERTEX 7,7X,8HVERTEX 8/                  LOADY     146
     31X,2HX%,8E15.5/1X,2HY%,8E15.5/1X,2HZ%,8E15.5)                      LOADY     147
      RETURN                                                             LOADY     148
      END                                                                LOADY     149
*DECK MSTRS
      SUBROUTINE MSTRS (DSSB,DSS,SS,AS,DSF)                              MSTRS       2
C     TO COMPUTE MATRIX STRESS INCR. IN LAMINA COOR. (DSS) FROM OVERALL  MSTRS       3
C     ELEMENT STRESSES (DSSB). COMPUTES FIBER STRESS IN LAMINA COOR.     MSTRS       4
C     (DSF) IF IFBR.GT.0 .                                               MSTRS       5
CMAP10                                                                   MSTRS       6
      COMMON/COMEL/IN                                                    MSTRS       7
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  MSTRS       8
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     MSTRS       9
      EQUIVALENCE (IN,IA(1),AA(1))                                       MSTRS      10
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   MSTRS      11
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   MSTRS      12
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   MSTRS      13
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   MSTRS      14
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   MSTRS      15
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   MSTRS      16
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   MSTRS      17
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   MSTRS      18
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   MSTRS      19
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   MSTRS      20
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   MSTRS      21
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   MSTRS      22
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   MSTRS      23
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   MSTRS      24
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   MSTRS      25
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   MSTRS      26
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   MSTRS      27
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   MSTRS      28
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   MSTRS      29
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    MSTRS      30
      EQUIVALENCE     (IA(401), S(1))                                    MSTRS      31
CEND MAP10                                                               MSTRS      32
CMAP20                                                                   MSTRS      33
      DIMENSION LLL(27)                                                  MSTRS      34
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   MSTRS      35
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   MSTRS      36
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  MSTRS      37
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  MSTRS      38
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   MSTRS      39
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   MSTRS      40
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   MSTRS      41
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   MSTRS      42
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  MSTRS      43
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   MSTRS      44
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   MSTRS      45
CEND MAP20                                                               MSTRS      46
CMAP40                                                                   MSTRS      47
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            MSTRS      48
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       MSTRS      49
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), MSTRS      50
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         MSTRS      51
CEND MAP40                                                               MSTRS      52
      DIMENSION DSSB(6),DSS(6),SS(6),AS(6),SI(6),DSF(6)                  MSTRS      53
C     IF ISOTROPIC MATERIAL, STORE DSSB IN DSS AND RETURN                MSTRS      54
      IF(ITYPE.EQ.1) GO TO 5                                             MSTRS      55
    1 DO 2 I=1,6                                                         MSTRS      56
      DSS(I)=DSSB(I)                                                     MSTRS      57
    2 DSF(I)=0.                                                          MSTRS      58
      RETURN                                                             MSTRS      59
    5 IIDI=IID+(IMET-1)*6                                                MSTRS      60
      VF=AA(IIDI+5)                                                      MSTRS      61
      IF(VF.EQ.0.) GO TO 1                                               MSTRS      62
      EM=AA(IIDI+1)                                                      MSTRS      63
      UM=AA(IIDI+2)                                                      MSTRS      64
      EF=AA(IIDI+3)                                                      MSTRS      65
      UF=AA(IIDI+4)                                                      MSTRS      66
      VM=1.-VF                                                           MSTRS      67
      PA=UM*EF-UF*EM                                                     MSTRS      68
      EC=VM*EM+VF*EF                                                     MSTRS      69
      YP=AA(LLL(7)+M)                                                    MSTRS      70
C     JJ=0, ELEMENT IS PLASTIC ; JJ=1, ELEMENT IS ELASTIC                MSTRS      71
      IF(JJ.EQ.0) GO TO 10                                               MSTRS      72
      R11=VF*PA/EC                                                       MSTRS      73
      R22=R11                                                            MSTRS      74
      R33=EM/EC                                                          MSTRS      75
      R12=0.                                                             MSTRS      76
      R13=0.                                                             MSTRS      77
      R23=0.                                                             MSTRS      78
      GO TO 20                                                           MSTRS      79
   10 DO 15 I=1,6                                                        MSTRS      80
      SS(I)=AA(LLL(9+I)+M)                                               MSTRS      81
   15 AS(I)=AA(LLL(15+I)+M)                                              MSTRS      82
      Q=2.*(SS(3)-AS(3))-(SS(1)-AS(1))-(SS(2)-AS(2))                     MSTRS      83
      Q=Q/6./(YP*YP+3.*((SS(4)-AS(4))**2+(SS(5)-AS(5))**2+(SS(6)-AS(6))  MSTRS      84
     1**2))                                                              MSTRS      85
      Q1=Q*(2.*(SS(1)-AS(1))-(SS(2)-AS(2))-(SS(3)-AS(3)))                MSTRS      86
      Q2=Q*(2.*(SS(2)-AS(2))-(SS(1)-AS(1))-(SS(3)-AS(3)))                MSTRS      87
      Q3=Q*(2.*(SS(3)-AS(3))-(SS(1)-AS(1))-(SS(2)-AS(2)))                MSTRS      88
      Q4=Q*6.*(SS(4)-AS(4))                                              MSTRS      89
      Q5=Q*6.*(SS(5)-AS(5))                                              MSTRS      90
      Q6=Q*6.*(SS(6)-AS(6))                                              MSTRS      91
      RR=H*EC+VF*EF*EM*Q3                                                MSTRS      92
      R11=VF*(H*PA-EF*EM*Q1)/RR                                          MSTRS      93
      R22=VF*(H*PA-EF*EM*Q2)/RR                                          MSTRS      94
      R33=H*EM/RR                                                        MSTRS      95
      R12=-VF*EF*EM*Q4/RR                                                MSTRS      96
      R13=-VF*EF*EM*Q5/RR                                                MSTRS      97
      R23=-VF*EF*EM*Q6/RR                                                MSTRS      98
C     FIND INCR. STRESSES IN LAMINA COOR. IN SI                          MSTRS      99
   20 DO 30 I=1,6                                                        MSTRS     100
      SI(I)=0.                                                           MSTRS     101
      DO 30 J=1,6                                                        MSTRS     102
   30 SI(I)=SI(I)+E66(I,J)*DSSB(J)                                       MSTRS     103
C     FIND MATRIX INCR. STRESSES IN DSS                                  MSTRS     104
      DO 40 I=1,6                                                        MSTRS     105
   40 DSS(I)=SI(I)                                                       MSTRS     106
      DSS(3)=R11*SI(1)+R22*SI(2)+R33*SI(3)+R12*SI(4)+R13*SI(5)+R23*SI(6) MSTRS     107
C FIND FIBER INCR. STRESSES IN DSF IF IFBR.GT.0                          MSTRS     108
      IF(IFBR.EQ.0) RETURN                                               MSTRS     109
      DO 50 I=1,6                                                        MSTRS     110
   50 DSF(I)=DSS(I)                                                      MSTRS     111
      DSF(3)=(  SI(3)-VM*DSS(3))/VF                                      MSTRS     112
      RETURN                                                             MSTRS     113
      END                                                                MSTRS     114
*DECK PDATP
      SUBROUTINE PDATP                                                   PDATP       2
C *** PREPARES PLOTTING INFORMATION ON UNIT IPOT                         PDATP       3
C *** IF IPOT .LT. 0 MULTIPLE JOBS ON UNIT IPOT                          PDATP       4
C *** IF IPOT .GT. 0 FIRST JOB                                           PDATP       5
C *** IF IPOT .GT. 100 FIRST RECORD IS ALREADY WRITTEN                   PDATP       6
CMAP10                                                                   PDATP       7
      COMMON/COMEL/IN                                                    PDATP       8
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PDATP       9
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PDATP      10
      EQUIVALENCE (IN,IA(1),AA(1))                                       PDATP      11
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PDATP      12
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PDATP      13
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PDATP      14
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PDATP      15
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PDATP      16
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PDATP      17
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PDATP      18
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PDATP      19
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PDATP      20
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PDATP      21
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PDATP      22
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PDATP      23
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PDATP      24
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PDATP      25
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PDATP      26
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PDATP      27
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PDATP      28
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PDATP      29
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PDATP      30
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PDATP      31
      EQUIVALENCE     (IA(401), S(1))                                    PDATP      32
CEND MAP10                                                               PDATP      33
CMAP20                                                                   PDATP      34
      DIMENSION LLL(27)                                                  PDATP      35
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PDATP      36
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PDATP      37
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PDATP      38
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PDATP      39
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PDATP      40
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PDATP      41
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PDATP      42
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PDATP      43
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PDATP      44
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PDATP      45
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PDATP      46
CEND MAP20                                                               PDATP      47
      DIMENSION LLV(6)                                                   PDATP      48
      IF(IPOT .GT. 100) GO TO 16                                         PDATP      49
      IF(IPOT .LT. 0) GO TO 10                                           PDATP      50
C *** WRITING ON IPOT FOR THE FIRST TIME                                 PDATP      51
      REWIND IPOT                                                        PDATP      52
      ICOUNT=0                                                           PDATP      53
      GO TO 17                                                           PDATP      54
C *** MULTIPLE JOBS                                                      PDATP      55
 10   IPOT=-IPOT                                                         PDATP      56
 17   ICOUNT=ICOUNT+1                                                    PDATP      57
      NHARD=21*IHARD*IMAT                                                PDATP      58
      IF(IYIT .NE. 0) NHARD=2*NHARD                                      PDATP      59
      WRITE(IPOT) IDD,IRR,IN,IT,IMAT,IDEG,ISDT,IHARD,LCDP,IYIT,ITAX,     PDATP      60
     ANHARD                                                              PDATP      61
     1,(AA(IID+2*I-1),AA(IID+2*I),AA(IIA+I),I=1,IMAT)                    PDATP      62
     2,(AA(LHD+I),I=1,NHARD)                                             PDATP      63
     3,(IA(LLD+I),AA(LLD+25+I),I=1,LCDP)                                 PDATP      64
     4,(AA(IXX+I),AA(IYY+I),AA(IZZ+I),I=1,IN)                            PDATP      65
     5,(IA(J1+I),IA(J2+I),IA(J3+I),IA(J4+I),IA(J5+I),IA(J6+I),IA(J7+I),  PDATP      66
     6           IA(J8+I),IA(J9+I),IA(J10+I),I=1,IT)                     PDATP      67
      GO TO 15                                                           PDATP      68
C *** WRITING ON IPOT SUBSEQUENT TIME(S)                                 PDATP      69
C *** IF ITAX.EQ.0 WRITE ITER. INFORM.,MAIN VECT.,INC. STRNS.&DEFLECS.   PDATP      70
C *** IF ITAX.NE.0 WRITE ITER. INFORM.,MAIN VECT.,CUM. STRNS.&DEFLECS.   PDATP      71
 16   IPOT=IPOT-100                                                      PDATP      72
 15   IF(ITAX) 13,12,13                                                  PDATP      73
 12   LEN=0                                                              PDATP      74
      LLZ=IDEF                                                           PDATP      75
      GO TO 11                                                           PDATP      76
 13   LEN=IND+6*IT                                                       PDATP      77
      LLZ=IST+2*ISUM+1+6*IT                                              PDATP      78
 11   LLV(1)=IST+2*ISUM+1+LEN                                            PDATP      79
      DO 20 I=2,6                                                        PDATP      80
 20   LLV(I)=LLV(I-1)+IT                                                 PDATP      81
      ICOUNT=ICOUNT+1                                                    PDATP      82
      WRITE(IPOT) ITER,ITERS,DESC,CUMS                                   PDATP      83
     1,((AA(LLL(I)+J),I=1,9),J=1,IT)                                     PDATP      84
     2,((AA(LLV(K)+I),K=1,6),I=1,IT)                                     PDATP      85
     3,((AA(LLZ+(I-1)*IDEG+K),K=1,IDEG),I=1,IN)                          PDATP      86
C *** SWICH OFF IPOT AND RETURN                                          PDATP      87
      IPOT=IPOT+100                                                      PDATP      88
      RETURN                                                             PDATP      89
      END                                                                PDATP      90
*DECK PRINT
      SUBROUTINE PRINT                                                   PRINT       2
C *** TO OUTPUT INFORMATION IN STRESS LINK                               PRINT       3
CMAP10                                                                   PRINT       4
      COMMON/COMEL/IN                                                    PRINT       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PRINT       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PRINT       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       PRINT       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PRINT       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PRINT      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PRINT      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PRINT      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PRINT      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PRINT      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PRINT      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PRINT      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PRINT      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PRINT      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PRINT      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PRINT      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PRINT      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PRINT      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PRINT      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PRINT      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PRINT      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PRINT      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PRINT      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PRINT      28
      EQUIVALENCE     (IA(401), S(1))                                    PRINT      29
CEND MAP10                                                               PRINT      30
CMAP20                                                                   PRINT      31
      DIMENSION LLL(27)                                                  PRINT      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PRINT      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PRINT      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PRINT      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PRINT      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PRINT      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PRINT      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PRINT      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PRINT      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PRINT      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PRINT      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PRINT      43
CEND MAP20                                                               PRINT      44
      DIMENSION LLV(6),MAT(1000),MFIB(1000)                              PRINT      45
      DO 201 I=1,IT                                                      PRINT      46
      JM=J1+I                                                            PRINT      47
      MAT(I)=IA(JM)/100                                                  PRINT      48
      MFIB(I)=IA(JM)-100*MAT(I)                                          PRINT      49
  201 CONTINUE                                                           PRINT      50
      IDEG=3                                                             PRINT      51
      IF(IPOT .NE. 0) CALL PDATP                                         PRINT      52
      IF(MPR .NE. 0) GO TO 1                                             PRINT      53
      WRITE (MO,52) ITER,ITERS,CUMS,PNORMB,PNORM                         PRINT      54
      GO TO 32                                                           PRINT      55
 1    WRITE (MO,51) ITER,ITERS,CUMS,PNORMB,PNORM                         PRINT      56
      IF(ITYPE.EQ.1) GO TO 204                                           PRINT      57
      WRITE (MO,10) (I,(AA(LLL(K)+I),K=1,8),I=1,IT)                      PRINT      58
      GO TO 205                                                          PRINT      59
  204 WRITE (MO,101) (I,MAT(I),(AA(LLL(K)+I),K=1,8),MFIB(I),I=1,IT)      PRINT      60
  205 WRITE(MO,11)                                                       PRINT      61
      LLN=IST+2*ISUM+1+12*IT+3*IN                                        PRINT      62
      IF (NPRIN.LT.3) GO TO 22                                           PRINT      63
      WRITE(MO,520) (I,(AA(LLN+(I-1)*IDEG+K),K=1,IDEG),I=1,IN)           PRINT      64
   22 IF (NPRIN.EQ.0) GO TO 20                                           PRINT      65
      LLV(1)=IST+2*ISUM+1                                                PRINT      66
      DO 24 I=2,6                                                        PRINT      67
 24   LLV(I)=LLV(I-1)+IT                                                 PRINT      68
      LLZ=LLV(6)+IT                                                      PRINT      69
      LEN=6*IT+3*IN                                                      PRINT      70
 25   IF(ITAX .EQ. 0) GO TO 30                                           PRINT      71
      WRITE(MO,140)(I,(AA(LLV(K)+I),K=1,6),(AA(LLV(K)+LEN+I),K=1,6),I=1, PRINT      72
     1IT)                                                                PRINT      73
      GO TO 40                                                           PRINT      74
 30   WRITE(MO,14) (I,(AA(LLV(K)+I),K=1,6),I=1,IT)                       PRINT      75
 40   IF(NPRIN .EQ. 1) GO TO 20                                          PRINT      76
      IF(ITAX .EQ. 0) GO TO 31                                           PRINT      77
      WRITE(MO,150)(I,(AA(IDEF+(I-1)*IDEG+K),K=1,IDEG),                  PRINT      78
     1                (AA( LLZ+(I-1)*IDEG+K),K=1,IDEG),I=1,IN)           PRINT      79
      GO TO 20                                                           PRINT      80
 31   WRITE(MO,15) (I,(AA(IDEF+(I-1)*IDEG+K),K=1,IDEG),I=1,IN)           PRINT      81
   20 IF(ITYPE.EQ.0) GO TO 32                                            PRINT      82
      IF(IFBR.LT.10) GO TO 32                                            PRINT      83
      WRITE (MO,160) (I,MAT(I),(AA(LLL(K)+I),K=22,27),MFIB(I),I=1,IT)    PRINT      84
      WRITE(MO,16)                                                       PRINT      85
   32 RETURN                                                             PRINT      86
   10 FORMAT (/,1X,14HSTRESS VECTORS,//,                                 PRINT      87
     1       1X,3HELT,5X,3HSXX,9X,3HSYY,9X,3HSZZ,9X,3HSXY,9X,3HSXZ,9X,   PRINT      88
     23HSYZ,7X,11HYIELD STRS*,2X,12HEFFCTVE.STRS/(1X,I3,1P6E12.3,        PRINT      89
     31P2E14.4))                                                         PRINT      90
  101 FORMAT (/,1X,14HSTRESS VECTORS,//,                                 PRINT      91
     11X,3HELT,1X,3HMAT,6X,3HSXX,9X,3HSYY,9X,3HSZZ,9X,3HSXY,9X,3HSXZ,9X, PRINT      92
     23HSYZ,7X,10HMTRX.Y.STR,1H*,2X,12HMTRX.EFF.STR,3X,11HFIBER ANGLE/   PRINT      93
     3(1X,I3,2X,I1,2X,1P6E12.3,1P2E14.4,6X,I3))                          PRINT      94
   11 FORMAT(/1X,1H*,36H MINUS SIGN INDICATES THAT THE YIELD,            PRINT      95
     1 18H SURFACE IS MOVING)                                            PRINT      96
   14 FORMAT (/,1X,26HINCREMENTAL STRAIN VECTORS,//,                     PRINT      97
     11X,3HELT,5X,3HEXX,7X,3HEYY,7X,3HEZZ,7X,3HEXY,7X,3HEXZ,7X,3HEYZ/    PRINT      98
     2(1X,I3,3X,1P6E10.3))                                               PRINT      99
   15 FORMAT (/,1X,29HINCREMENTAL NODAL DEFLECTIONS,//                   PRINT     100
     11X,4HNODE,5X,1HU,9X,1HV,9X,1HW/(1X,I4,3X,1P3E10.3))                PRINT     101
  140 FORMAT (/,1X,14HSTRAIN VECTORS,//8X,11HINCREMENTAL,52X             PRINT     102
     1,10HCUMULATIVE//1X,3HELT,2(5X,3HEXX,7X,3HEYY,7X,3HEZZ,7X,3HEXY,7X, PRINT     103
     23HEXZ,7X,3HEYZ,5X)/(1X,I3,3X,1P6E10.3,3X,1P6E10.3))                PRINT     104
  150 FORMAT (/,1X,17HNODAL DEFLECTIONS,//,9X,11HINCREMENTAL,22X,        PRINT     105
     110HCUMULATIVE//1X,4HNODE,2(5X,1HU,9X,1HV,9X,1HW,7X)/               PRINT     106
     2(1X,I4,3X,1P3E10.3,3X,1P3E10.3))                                   PRINT     107
  160 FORMAT (/,1X,38HFIBER STRESS VECTORS IN MATERIAL AXES$,//,1X       PRINT     108
     1,3HELT,1X,3HMAT,4X,3HS11,9X,3HS22,9X,3HS33,9X,3HS12,9X,3HS13,9X,   PRINT     109
     23HS23,7X,11HFIBER ANGLE,/,(1X,I3,1X,I1,1X,1P6E12.3,6X,I3))         PRINT     110
   16 FORMAT(/1X,45H$ ZERO QUANTITIES DENOTE AN ISOTROPIC ELEMENT/1X,    PRINT     111
     128H  X3-AXIS IS FIBER DIRECTION)                                   PRINT     112
 51   FORMAT(1H1,5HSTEP%,I4,5X,8HSUBSTEP%,I4,5X,12HLOAD FACTOR%,E12.5,   PRINT     113
     15X,7HPNORMB%,E12.5,5X,6HPNORM%,E12.5)                              PRINT     114
 52   FORMAT(1X ,5HSTEP%,I4,5X,8HSUBSTEP%,I4,5X,12HLOAD FACTOR%,E12.5,   PRINT     115
     15X,7HPNORMB%,E12.5,5X,6HPNORM%,E12.5)                              PRINT     116
  520 FORMAT (/,1X,23HCUMULATIVE NODAL FORCES,//,1X,4HNODE,5X,1HX,       PRINT     117
     19X,1HY,9X,1HZ/(1X,I4,3X,1P3E10.3))                                 PRINT     118
      END                                                                PRINT     119
      FUNCTION PRSD (IS)                                                 PRINT     120
C     TO FIND THE PRESCRIBED DEFLECTION COMPONENT OF THE IS TH DEFL.     PRINT     121
CMAP10                                                                   PRINT     122
      COMMON/COMEL/IN                                                    PRINT     123
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  PRINT     124
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     PRINT     125
      EQUIVALENCE (IN,IA(1),AA(1))                                       PRINT     126
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   PRINT     127
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   PRINT     128
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   PRINT     129
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   PRINT     130
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   PRINT     131
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   PRINT     132
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   PRINT     133
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   PRINT     134
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   PRINT     135
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   PRINT     136
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   PRINT     137
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   PRINT     138
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   PRINT     139
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   PRINT     140
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   PRINT     141
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   PRINT     142
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   PRINT     143
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   PRINT     144
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   PRINT     145
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    PRINT     146
      EQUIVALENCE     (IA(401), S(1))                                    PRINT     147
CEND MAP10                                                               PRINT     148
CMAP20                                                                   PRINT     149
      DIMENSION LLL(27)                                                  PRINT     150
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   PRINT     151
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   PRINT     152
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  PRINT     153
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  PRINT     154
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   PRINT     155
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   PRINT     156
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   PRINT     157
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   PRINT     158
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  PRINT     159
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   PRINT     160
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   PRINT     161
CEND MAP20                                                               PRINT     162
      PRSD=0.                                                            PRINT     163
      IF(ITERS.GT.1) RETURN                                              PRINT     164
      IND=3*IN                                                           PRINT     165
      IND1=IND+1                                                         PRINT     166
      IBOJ=IBB+IS                                                        PRINT     167
      KK=IA(IBOJ)                                                        PRINT     168
      IICJ=IIC+IS                                                        PRINT     169
C     ANY MULTIPLE CONNECTION ?                                          PRINT     170
      IF(KK) 61,62,61                                                    PRINT     171
C     SINGLE CONNECTION. SEE IF PRESCRIBED DEFLECTION                    PRINT     172
   61 IF(KK-IND1) 63,64,64                                               PRINT     173
C     PRESCRIBED DEFLECTION. STORE IN PRSD                               PRINT     174
   64 PRSD=AA(IICJ)                                                      PRINT     175
   63 RETURN                                                             PRINT     176
C     MULTIPLE CONNECTION. FIND MULTIPLICITY AND RELATIVE POINTER        PRINT     177
   62 II=IA(IICJ)/100000                                                 PRINT     178
      MEND=IA(IICJ)-100000*II                                            PRINT     179
      IR=IBB+MEND+IND                                                    PRINT     180
      JR=IIC+MEND+IND                                                    PRINT     181
      DO 80 L=1,II                                                       PRINT     182
      IR=IR+1                                                            PRINT     183
      JR=JR+1                                                            PRINT     184
      KK=IA(IR)                                                          PRINT     185
C     SEE IF L TH CONNECTION IS PRESCRIBED                               PRINT     186
      IF(KK-IND1) 80,74,74                                               PRINT     187
C     PRESCRIBED COMPONENT                                               PRINT     188
   74 PRSD=PRSD+AA(JR)                                                   PRINT     189
   80 CONTINUE                                                           PRINT     190
      RETURN                                                             PRINT     191
      END                                                                PRINT     192
*DECK RESPNS
      SUBROUTINE RESPNS (MI)                                             RESPNS      2
C     TO COMPUTE ELASTIC-PLASTIC RESPONSE FOR STEP-ITER, SUBSTEP-ITERS   RESPNS      3
CMAP10                                                                   RESPNS      4
      COMMON/COMEL/IN                                                    RESPNS      5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  RESPNS      6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     RESPNS      7
      EQUIVALENCE (IN,IA(1),AA(1))                                       RESPNS      8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   RESPNS      9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   RESPNS     10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   RESPNS     11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   RESPNS     12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   RESPNS     13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   RESPNS     14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   RESPNS     15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   RESPNS     16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   RESPNS     17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   RESPNS     18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   RESPNS     19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   RESPNS     20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   RESPNS     21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   RESPNS     22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   RESPNS     23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   RESPNS     24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   RESPNS     25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   RESPNS     26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   RESPNS     27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    RESPNS     28
      EQUIVALENCE (IA(401),S(1)),(IA(325),IFB)                           RESPNS     29
CEND MAP10                                                               RESPNS     30
CMAP20                                                                   RESPNS     31
      DIMENSION LLL(27)                                                  RESPNS     32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   RESPNS     33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   RESPNS     34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  RESPNS     35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  RESPNS     36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   RESPNS     37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   RESPNS     38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   RESPNS     39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   RESPNS     40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  RESPNS     41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   RESPNS     42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   RESPNS     43
CEND MAP20                                                               RESPNS     44
      DIMENSION DD(6,6),SS(6),AS(6),DSNB(6),DSSB(6),DSS(6),DAS(6)        RESPNS     45
      DIMENSION DSSB1(6),DSS1(6),DAS1(6),DSF(6),DSF1(6)                  RESPNS     46
      DO 200 M=1,IT                                                      RESPNS     47
      CYBED=1.0                                                          RESPNS     48
C.....YP=YIELD STRESS(OF THE MATRIX IF COMPOSITE)                        RESPNS     49
      YP=AA(LLL(7)+M)                                                    RESPNS     50
C.....FIND ELEMENTAL INFORMATION; IMET, ITEM, JPRS, JMFI, N(I),I=1,8     RESPNS     51
      CALL TOPO4                                                         RESPNS     52
      VF=0.                                                              RESPNS     53
      IF(ITYPE.EQ.0) GO TO 20                                            RESPNS     54
      IIDI=IID+(IMET-1)*6                                                RESPNS     55
      VF=AA(IIDI+5)                                                      RESPNS     56
C.....COMPUTE THE COMPLIANCE MATRIX AT THE BEGINNING OF THE SUBSTEP IN   RESPNS     57
C.....DD USING CUMULATIVE STRESSES & CENTER OF Y.S. (SS&AS) FROM CORE    RESPNS     58
   20 CALL ELMT4 (DD,SS,AS,0)                                            RESPNS     59
C.....COMPUTE INCR. STRAINS DSNB FROM INCR. DEFLECTIONS                  RESPNS     60
      CALL STRN (DSNB)                                                   RESPNS     61
C.....STORE INCR. STRAINS IN LLY-AREA, INITIALIZE IF 1ST STEP            RESPNS     62
      CALL UPDT (DSNB,-1)                                                RESPNS     63
C.....COMPUTE INCR. STRESSES DSSB ACCORDING TO MAT. PROP. AT THE         RESPNS     64
C.....BEGINNING OF THE SUBSTEP                                           RESPNS     65
      DO 30 I=1,6                                                        RESPNS     66
   30 DSSB(I)=DSNB(I)                                                    RESPNS     67
      CALL INV (DD,6,DSSB,1,DETERM)                                      RESPNS     68
C.....COMPUTE INCR. MATRIX STRESSES DSS AT THE BEGINNING OF THE SUBSTEP  RESPNS     69
C.....IF ISOTROPIC, SET DSS=DSSB. COMPUTE INCR. FIBER STRESSES DSS,      RESPNS     70
C.....IF NECESSARY                                                       RESPNS     71
      CALL MSTRS (DSSB,DSS,SS,AS,DSF)                                    RESPNS     72
      IF(ITER.GT.1) GO TO 40                                             RESPNS     73
C.....1ST STEP, 1ST SUBSTEP; UPDATE STRESSES AND GO TO NEXT ELEMENT      RESPNS     74
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) CALL UPDT(DSSB,0)                    RESPNS     75
      K=0                                                                RESPNS     76
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=9                                  RESPNS     77
      CALL UPDT (DSS,K)                                                  RESPNS     78
      IF(ITYPE.EQ.1 .AND. IFBR.GT.0) CALL UPDT(DSF,21)                   RESPNS     79
      CALL LOADY (DD,1.0)                                                RESPNS     80
      CALL ASMELP                                                        RESPNS     81
      GO TO 200                                                          RESPNS     82
C.....COMPUTE INCR. Y.S. SHIFT DAS AT THE BEGINNING OF THE SUBSTEP       RESPNS     83
   40 CALL SHFT (DSS,DAS,SS,AS,VF)                                       RESPNS     84
C.....COMPUTE CUMUL. STRESSES AND SHIFT OF Y.S.                          RESPNS     85
      CALL SUMMT (SS,DSS)                                                RESPNS     86
      CALL SUMMT (AS,DAS)                                                RESPNS     87
C.....FIND STATE OF THE ELT. AT THE BEGINNING OF THE SUBSTEP; YP.LT.0    RESPNS     88
C.....MEANS ELT. IS PLASTIC                                              RESPNS     89
      IF(YP.LT.0.) GO TO 90                                              RESPNS     90
C.....ELEMENT IS ELASTIC AT THE BEGINNING OF THE SUBSTEP                 RESPNS     91
      Y2=(SS(1)-AS(1))**2+(SS(2)-AS(2))**2+(SS(3)-AS(3))**2-(SS(1)-AS(1) RESPNS     92
     1)*(SS(2)-AS(2))-(SS(1)-AS(1))*(SS(3)-AS(3))-(SS(2)-AS(2))*(SS(3)-  RESPNS     93
     2AS(3))+3.*((SS(4)-AS(4))**2+(SS(5)-AS(5))**2+(SS(6)-AS(6))**2)     RESPNS     94
      Y2=SQRT(Y2)                                                        RESPNS     95
C.....Y2.LT.YP=ELT. WAS ELASTIC AND REMAINS ELASTIC                      RESPNS     96
      IF(Y2.LT.YP) GO TO 90                                              RESPNS     97
C.....ELT. WAS ELASTIC AND BECAME PLASTIC                                RESPNS     98
C     SEPARATE ELASTIC AND PLASTIC PARTS OF THIS SUBSTEP                 RESPNS     99
C     CYBED=RATIO OF EL-PL INCR. TO TOTAL ICR.                           RESPNS    100
C     COMPUTE EL-PL PORTION OF INCR. STRAINS, COMPUTE ELASTIC PORTION    RESPNS    101
C.....OF INCR. STRESS AND UPDATE STRESSES IN CORE                        RESPNS    102
      CALL SCLIT (DSS,DSNB,DD,CYBED,VF)                                  RESPNS    103
C.....IF COMPOSITE, UPDATE COMPOSITE STRESSES WITH ELASTIC PORTION OF    RESPNS    104
C.....STRESS INCR.                                                       RESPNS    105
      IF(ITYPE.EQ.0) GO TO 70                                            RESPNS    106
      C=1.-CYBED                                                         RESPNS    107
      IF(VF.EQ.0.) GO TO 70                                              RESPNS    108
      DO 60 I=1,6                                                        RESPNS    109
      AA(LLL(I)+M)=AA(LLL(I)+M)+C*DSSB(I)                                RESPNS    110
      IF(IFBR.EQ.0) GO TO 60                                             RESPNS    111
      AA(LLL(21+I)+M)=AA(LLL(21+I)+M)+C*DSF(I)                           RESPNS    112
   60 CONTINUE                                                           RESPNS    113
   70 YP=AA(LLL(7)+M)                                                    RESPNS    114
C.....COMPUTE COMPLIANCE MATRIX AT THE END OF THE 1ST STRESS INCR.       RESPNS    115
      CALL ELMT4 (DD,SS,AS,0)                                            RESPNS    116
C.....COMPUTE INCR. STRESSES ACCORDING TO MATERIAL PROP. AT THE END OF   RESPNS    117
C.....1ST STRESS INCR.                                                   RESPNS    118
      DO 80 I=1,6                                                        RESPNS    119
   80 DSSB(I)=DSNB(I)                                                    RESPNS    120
      CALL INV (DD,6,DSSB,1,DETERM)                                      RESPNS    121
C.....COMPUTE INCR. MATRIX STRESSES CORRESP. TO 2ND STRESS INCR.         RESPNS    122
C.....IF ISOTROPIC, SET DSS=DSSB                                         RESPNS    123
      CALL MSTRS (DSSB,DSS,SS,AS,DSF)                                    RESPNS    124
C.....COMPUTE INCR. SHIFT OF Y.S. CORRESP. TO 2ND STRESS INCR.           RESPNS    125
      CALL SHFT (DSS,DAS,SS,AS,VF)                                       RESPNS    126
C.....COMPUTE CUMUL. STRESSES (MATRIX STRESSES ONLY IF COMPOSITE), AND   RESPNS    127
C.....CUMUL. SHIFT OF Y.S.                                               RESPNS    128
      CALL SUMMT (SS,DSS)                                                RESPNS    129
      CALL SUMMT (AS,DAS)                                                RESPNS    130
C.....COMPUTE COMPLIANCE MATRIX AT THE END OF SUBSTEP                    RESPNS    131
   90 CALL ELMT4 (DD,SS,AS,1)                                            RESPNS    132
      IF(JJ.NE.1) GO TO 110                                              RESPNS    133
      IF(YP.GE.0.) GO TO 170                                             RESPNS    134
C.....CONFLICTING SITUATION, ELT. WAS PLASTIC AT THE BEGINNING OF SUBSTP RESPNS    135
C.....BUT ELASTIC AT THE END THOUGH LOADING IS TAKING PLACE              RESPNS    136
      WRITE(MO,100) M                                                    RESPNS    137
  100 FORMAT(1X,12H26.  ELEMENT,I4,2X,51HACTS ELASTICALLY, ALTHOUGH LINK RESPNS    138
     1 2 ASSUMED OTHERWISE)                                              RESPNS    139
      AA(LLL(7)+M)=-YP                                                   RESPNS    140
      MI=MI+2                                                            RESPNS    141
      GO TO 170                                                          RESPNS    142
C.....COMPUTE INCR. STRESSES ACCORDING TO MATERIAL PROP. AT THE END OF   RESPNS    143
C.....THE SUBSTEP AND SAME STRAIN INCR.                                  RESPNS    144
  110 DO 120 I=1,6                                                       RESPNS    145
  120 DSSB1(I)=DSNB(I)                                                   RESPNS    146
      CALL INV (DD,6,DSSB1,1,DETERM)                                     RESPNS    147
C.....COMPUTE INCR. MATRIX STRESSES CORRESP. TO DSSB1                    RESPNS    148
C.....IF ISOTROPIC, SET DSS=DSSB                                         RESPNS    149
      CALL MSTRS (DSSB1,DSS1,SS,AS,DSF1)                                 RESPNS    150
C.....COMPUTE INCR. SHIFT OF Y.S. CORRESP. TO INCR. STRESSES             RESPNS    151
      CALL SHFT (DSS1,DAS1,SS,AS,VF)                                     RESPNS    152
C.....COMPUTE AN AVERAGE OF THE TWO INCR. SHIFTS DAS & DAS1 IN DAS       RESPNS    153
      DO 130 I=1,6                                                       RESPNS    154
  130 DAS(I)=0.5*(DAS(I)+DAS1(I))                                        RESPNS    155
C.....COMPUTE CUMUL. SHIFT USING THE AVERAGE SHIFT                       RESPNS    156
      CALL SUMMT (AS,DAS)                                                RESPNS    157
C.....COMPUTE A WEIGHTED AVERAGE STRESS INCR. OF THE TWO STRESS INCRS.   RESPNS    158
      CALL DIFF (SS,AS,DSS,DSS1,R1,R2)                                   RESPNS    159
      IF(ITYPE.EQ.0 .OR. VF.EQ.0.) GO TO 150                             RESPNS    160
      DO 140 I=1,6                                                       RESPNS    161
      DSSB(I)=R1*DSSB(I)+R2*DSSB1(I)                                     RESPNS    162
      IF(IFBR.EQ.0) GO TO 140                                            RESPNS    163
      DSF(I)=R1*DSF(I)+R2*DSF1(I)                                        RESPNS    164
  140 CONTINUE                                                           RESPNS    165
C.....COMPUTE AN INCR. SHIFT CORRESP. TO THE AVERAGE STRESS              RESPNS    166
  150 CALL SHFT (DSS,DAS,SS,AS,VF)                                       RESPNS    167
C.....UPDATE STRESSES AND CENTER OF Y.S. IN CORE                         RESPNS    168
  170 IF(ITYPE.EQ.1 .AND. VF.GT.0.) CALL UPDT(DSSB,0)                    RESPNS    169
      K=0                                                                RESPNS    170
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=9                                  RESPNS    171
      CALL UPDT (DSS,K)                                                  RESPNS    172
      K=9                                                                RESPNS    173
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=15                                 RESPNS    174
      KTYPE=ITYPE                                                        RESPNS    175
      ITYPE=0                                                            RESPNS    176
      CALL UPDT (DAS,K)                                                  RESPNS    177
      ITYPE=KTYPE                                                        RESPNS    178
      IF(ITYPE.EQ.1 .AND. IFBR.GT.0) CALL UPDT(DSF,21)                   RESPNS    179
C.....COMPUTE THE BEST COMPLIANCE MATRIX FOR THE SUBSTEP                 RESPNS    180
      CALL ELMT4 (DD,SS,AS,0)                                            RESPNS    181
C.....COMPUTE INTERNAL RESISTANCE CORRESP. TO INCR. DEFL. AND MATERIAL   RESPNS    182
C.....PROP. COMPUTED FOR THIS SUBSTEP AND ASSEMBLE                       RESPNS    183
      CALL INV (DD,6,SS,0,DETERM)                                        RESPNS    184
      CALL LOADY (DD,CYBED)                                              RESPNS    185
      CALL ASMELP                                                        RESPNS    186
C.....MI IS A COUNTER OF HOW MANY ELEMENTS IN PLASTIC REGION             RESPNS    187
      IF(AA(LLL(7)+M).LT.0.) MI=MI+1                                     RESPNS    188
  200 CONTINUE                                                           RESPNS    189
      RETURN                                                             RESPNS    190
      END                                                                RESPNS    191
*DECK SCALY
      SUBROUTINE SCALY                                                   SCALY       2
C *** TO COMPUTE LOAD FACTOR FOR THE FIRST YIELD                         SCALY       3
CMAP10                                                                   SCALY       4
      COMMON/COMEL/IN                                                    SCALY       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  SCALY       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     SCALY       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       SCALY       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   SCALY       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   SCALY      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   SCALY      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   SCALY      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   SCALY      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   SCALY      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   SCALY      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   SCALY      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   SCALY      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   SCALY      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   SCALY      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   SCALY      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   SCALY      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   SCALY      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   SCALY      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   SCALY      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   SCALY      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   SCALY      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   SCALY      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    SCALY      28
      EQUIVALENCE     (IA(401), S(1))                                    SCALY      29
CEND MAP10                                                               SCALY      30
CMAP20                                                                   SCALY      31
      DIMENSION LLL(27)                                                  SCALY      32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   SCALY      33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   SCALY      34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  SCALY      35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  SCALY      36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   SCALY      37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   SCALY      38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   SCALY      39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   SCALY      40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  SCALY      41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   SCALY      42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   SCALY      43
CEND MAP20                                                               SCALY      44
      DIMENSION SS(6)                                                    SCALY      45
      DATA ERR/0.0001/                                                   SCALY      46
      LLY=IST+2*ISUM+1-IT                                                SCALY      47
      LLZ=LLY+7*IT                                                       SCALY      48
      LLU=LLZ+3*IN                                                       SCALY      49
      LLN=LLU+6*IT                                                       SCALY      50
C *** COMPUTE THE INITIAL YIELD LOAD FACTOR BY COMPUTING THE DISTANCE OF SCALY      51
C *** THE STRESS VECTOR FROM THE YIELD SURFACE                           SCALY      52
      DO 21 I=1,IT                                                       SCALY      53
      IMET=IA(J1+I)/100                                                  SCALY      54
      VF=0.                                                              SCALY      55
      IF(ITYPE.EQ.0) GO TO 14                                            SCALY      56
      IIDI=IID+(IMET-1)*6                                                SCALY      57
      VF=AA(IIDI+5)                                                      SCALY      58
   14 IF (IHARD) 15,15,16                                                SCALY      59
   15 CALL YHARP(IMET,YS)                                                SCALY      60
      GO TO 17                                                           SCALY      61
   16 KS=LHD+IMAT+(IMET-1)*20*IHARD+10*IHARD                             SCALY      62
      YS=AA(KS+1)                                                        SCALY      63
   17 K=0                                                                SCALY      64
      IF(ITYPE.EQ.1 .AND.VF.GT.0.) K=9                                   SCALY      65
      DO 18 J=1,6                                                        SCALY      66
   18 SS(J)=AA(LLL(K+J)+I)                                               SCALY      67
      ES=SS(1)**2+SS(2)**2+SS(3)**2-SS(1)*SS(2)-SS(1)*SS(3)-SS(2)*SS(3)  SCALY      68
     1+3.*(SS(4)**2+SS(5)**2+SS(6)**2)                                   SCALY      69
      ES=SQRT(ES)                                                        SCALY      70
      AA(LLL(8)+I)=ES                                                    SCALY      71
      R=YS/ES                                                            SCALY      72
      IF(I.EQ.1) SCAL=R                                                  SCALY      73
      IF(R.GE.SCAL) GO TO 21                                             SCALY      74
      SCAL=R                                                             SCALY      75
 21   CONTINUE                                                           SCALY      76
C *** INCLUDE ALL ELEMENTS WHOSE EFFECTIVE STRESS IS IN THE "GREY ZONE"  SCALY      77
C *** OF -Y/10000 TO +Y/10000, (Y IS THE YIELD STRESS)AS PLASTIC BY      SCALY      78
C *** ASSIGNING A NEGATIVE SIGN TO THE YIELD STRESS IN AA(LLL(7)+M)      SCALY      79
      DO 121 I=1,IT                                                      SCALY      80
      SING=1.                                                            SCALY      81
      IMET=IA(J1+I)/100                                                  SCALY      82
      IF(IHARD) 115,115,116                                              SCALY      83
 115  CALL YHARP(IMET,YS)                                                SCALY      84
      GO TO 117                                                          SCALY      85
 116  KS=LHD+IMAT+(IMET-1)*20*IHARD+10*IHARD                             SCALY      86
      YS=AA(KS+1)                                                        SCALY      87
 117  AERR=ABS(AA(LLL(8)+I)*SCAL/YS)                                     SCALY      88
      IF(ABS(1.-AERR) .LE. ERR) SING=-1.                                 SCALY      89
 121  AA(LLL(7)+I)=SING*YS                                               SCALY      90
      IELAS=1                                                            SCALY      91
C *** FIND THE LOAD FACTOR WITH PROPER SIGN                              SCALY      92
      CC=AA(LLD+LCDP+1)                                                  SCALY      93
      IF (CC.EQ.0..AND.LCDP.GT.1) CC=AA(LLD+LCDP+2)                      SCALY      94
      IF (CC.EQ.0..AND.LCDP.EQ.1) CC=1.                                  SCALY      95
      CC=SIGN(SCAL,CC)                                                   SCALY      96
C *** SCALE DEFLECTIONS,STRESSES,STRAINS                                 SCALY      97
C *** INITIALISE CUM. DEFLECTIONS,STRESSES & STRAINS                     SCALY      98
      DO 22 K=1,6                                                        SCALY      99
      LLY=LLY+IT                                                         SCALY     100
      DO 23 I=1,IT                                                       SCALY     101
      AA(LLY+I)=AA(LLY+I)*CC                                             SCALY     102
      AA(LLL(K)+I)=CC*AA(LLL(K)+I)                                       SCALY     103
      IF(ITYPE.EQ.0) GO TO 23                                            SCALY     104
      AA(LLL(9+K)+I)=CC*AA(LLL(9+K)+I)                                   SCALY     105
      IF(IFBR.EQ.0) GO TO 23                                             SCALY     106
      AA(LLL(21+K)+I)=CC*AA(LLL(21+K)+I)                                 SCALY     107
   23 CONTINUE                                                           SCALY     108
   22 CONTINUE                                                           SCALY     109
      DO 202 I=1,IT                                                      SCALY     110
  202 AA(LLL(8)+I)=ABS(CC)*AA(LLL(8)+I)                                  SCALY     111
      DESC=CC                                                            SCALY     112
      IND=3*IN                                                           SCALY     113
      DO 31 I=1,IND                                                      SCALY     114
      K=IDEF+I                                                           SCALY     115
      AA(K)=AA(K)*SCAL                                                   SCALY     116
   31 CONTINUE                                                           SCALY     117
C *** SCALE CUMULATIVE STRAINS AND DEFLECTIONS                           SCALY     118
      IF(ITAX.EQ.0) GO TO 301                                            SCALY     119
      LEN=6*IN+6*IT                                                      SCALY     120
      REWIND ITAX                                                        SCALY     121
      READ(ITAX) (AA(LLZ+I),I=1,LEN)                                     SCALY     122
      IND=3*IN                                                           SCALY     123
      DO 206 I=1,IND                                                     SCALY     124
      AA(LLN+I)=AA(LLN+I)*SCAL                                           SCALY     125
  206 AA(LLZ+I)=AA(LLZ+I)*SCAL                                           SCALY     126
      IT6=6*IT                                                           SCALY     127
      DO 207 I=1,IT6                                                     SCALY     128
  207 AA(LLU+I)=AA(LLU+I)*CC                                             SCALY     129
      REWIND ITAX                                                        SCALY     130
      WRITE(ITAX) (AA(LLZ+I),I=1,LEN)                                    SCALY     131
  301 PNORMB=PNORMB*SCAL                                                 SCALY     132
      PNORM=PNORM*SCAL                                                   SCALY     133
      CUMS=CC                                                            SCALY     134
      C=SCAL                                                             SCALY     135
      ZZ=AA(LLD+LCDP+1)                                                  SCALY     136
      IF(ZZ.EQ.0.) C=1.0                                                 SCALY     137
      PSCAL=C                                                            SCALY     138
C *** SCALE THE GIVEN LOAD/STEP INFORMATION                              SCALY     139
      DO 26 I=1,LCDP                                                     SCALY     140
   26 AA(LLD+LCDP+I)=C*AA(LLD+LCDP+I)                                    SCALY     141
      IF (LCDP.EQ.1) GO TO 28                                            SCALY     142
C *** LOCATE THE FIRST POINT ON THE LOAD/STEP CURVE WHICH CORRESPONDS    SCALY     143
C *** TO FIRST YIELD                                                     SCALY     144
      DO 27 I=2,LCDP                                                     SCALY     145
      IF (SCAL.LT.ABS(AA(LLD+LCDP+I))) GO TO 30                          SCALY     146
   27 CONTINUE                                                           SCALY     147
   28 ITER=IA(LLD+LCDP)                                                  SCALY     148
      AA(LLD+2*LCDP)=CC                                                  SCALY     149
      WRITE (MO,29)                                                      SCALY     150
   29 FORMAT (1X,56H27.  LOADING NEVER EXCEEDS THE ONE CAUSING INITIAL Y SCALY     151
     +IELD)                                                              SCALY     152
      RETURN                                                             SCALY     153
   30 IF(ZZ.NE.0.) RETURN                                                SCALY     154
      C1=IA(LLD+I-1)                                                     SCALY     155
      C2=IA(LLD+I)                                                       SCALY     156
C *** CHECK AND ASSIGN PROPER VALUES FOR FIRST LOAD/STEP POINT           SCALY     157
      ITER=C1+(SCAL-ABS(AA(LLD+LCDP-1+I)))*(C2-C1)/                      SCALY     158
     1     ABS(AA(LLD+LCDP+I)-AA(LLD+LCDP+I-1))                          SCALY     159
      IA(LLD+I-1)=ITER                                                   SCALY     160
      AA(LLD+LCDP+I-1)=SIGN(SCAL,AA(LLD+LCDP+I))                         SCALY     161
      RETURN                                                             SCALY     162
      END                                                                SCALY     163
*DECK SCLIT
      SUBROUTINE SCLIT (DS,SN,DD,C,VF)                                   SCLIT       2
C     TO SEPARATE ELASTIC AND PLASTIC PARTS OF THE SUBSTE WHEN THE ELT.  SCLIT       3
C     IS ELASTIC AND BECOMES PLASTIC                                     SCLIT       4
C     DS=STRESS INCR. OF THE SUBSTEP (MATRIX STRESS INCR. IF COMPOSITE)  SCLIT       5
C     SS=CUMUL.STRESSES AT THE BEGINNING OF SUBSTEP (OF MATRIX IF COMP.) SCLIT       6
C     AS=CUMUL.SHIFT OF CURRENT Y.S. (OF MATRIX IF COMPOSITE)            SCLIT       7
C     C=RATIO OF EL-PL STRESS INCR. TO  TOTAL STRESS INCR.               SCLIT       8
CMAP10                                                                   SCLIT       9
      COMMON/COMEL/IN                                                    SCLIT      10
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  SCLIT      11
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     SCLIT      12
      EQUIVALENCE (IN,IA(1),AA(1))                                       SCLIT      13
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   SCLIT      14
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   SCLIT      15
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   SCLIT      16
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   SCLIT      17
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   SCLIT      18
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   SCLIT      19
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   SCLIT      20
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   SCLIT      21
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   SCLIT      22
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   SCLIT      23
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   SCLIT      24
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   SCLIT      25
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   SCLIT      26
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   SCLIT      27
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   SCLIT      28
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   SCLIT      29
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   SCLIT      30
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   SCLIT      31
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   SCLIT      32
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    SCLIT      33
      EQUIVALENCE     (IA(401), S(1))                                    SCLIT      34
CEND MAP10                                                               SCLIT      35
CMAP20                                                                   SCLIT      36
      DIMENSION LLL(27)                                                  SCLIT      37
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   SCLIT      38
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   SCLIT      39
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  SCLIT      40
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  SCLIT      41
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   SCLIT      42
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   SCLIT      43
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   SCLIT      44
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   SCLIT      45
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  SCLIT      46
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   SCLIT      47
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   SCLIT      48
CEND MAP20                                                               SCLIT      49
      DIMENSION DS(6),SN(6),DD(6,6),SS(6),AS(6)                          SCLIT      50
      FE(X1,X2,X3,X4,X5,X6,Y1,Y2,Y3,Y4,Y5,Y6)=((2.*X1-X2-X3)*Y1+(2.*X2-  SCLIT      51
     1X3-X1)*Y2+(2.*X3-X1-X2)*Y3)/2.+3.*(X4*Y4+X5*Y5+X6*Y6)              SCLIT      52
      DATA ERR/1.E-6/                                                    SCLIT      53
C     YP=YIELD STRESS                                                    SCLIT      54
      YP=ABS(AA(LLL(7)+M))                                               SCLIT      55
      K=0                                                                SCLIT      56
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=9                                  SCLIT      57
      DO 10 I=1,6                                                        SCLIT      58
   10 SS(I)=AA(LLL(K+I)+M)                                               SCLIT      59
      K=9                                                                SCLIT      60
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=15                                 SCLIT      61
      DO 20 I=1,6                                                        SCLIT      62
   20 AS(I)=AA(LLL(K+I)+M)                                               SCLIT      63
      DO 30 I=1,6                                                        SCLIT      64
   30 SS(I)=SS(I)-AS(I)                                                  SCLIT      65
      A=FE(DS(1),DS(2),DS(3),DS(4),DS(5),DS(6),DS(1),DS(2),DS(3),DS(4),  SCLIT      66
     1DS(5),DS(6))                                                       SCLIT      67
      B=2.*FE(DS(1),DS(2),DS(3),DS(4),DS(5),DS(6),SS(1),SS(2),SS(3),     SCLIT      68
     1SS(4),SS(5),SS(6))                                                 SCLIT      69
      C=FE(SS(1),SS(2),SS(3),SS(4),SS(5),SS(6),SS(1),SS(2),SS(3),SS(4),  SCLIT      70
     1SS(5),SS(6))-YP*YP                                                 SCLIT      71
      D=B*B-4.*A*C                                                       SCLIT      72
      IF(A/YP.LT.ERR .OR. D.LT.0.) GO TO 40                              SCLIT      73
      D=SQRT(D)                                                          SCLIT      74
      C=(-B+D)/(2.*A)                                                    SCLIT      75
      C1=(-B-D)/(2.*A)                                                   SCLIT      76
C     THE LOWEST ROOT WHICH TAKES THE CURRENT STATE OF STRESS TO YIELD   SCLIT      77
C     IS CONSIDERED ASSUMING THAT THE LOAD STEPS ARE SMALL. CASE OF      SCLIT      78
C     EQUAL ROOTS IS NOT CONSIDERED                                      SCLIT      79
      IF(ABS(C).GT.ABS(C1)) C=C1                                         SCLIT      80
      GO TO 50                                                           SCLIT      81
C     ERROR CONDITION, DECLARE THE ROOT AS UNITY                         SCLIT      82
   40 C=1.0                                                              SCLIT      83
   50 C1=1.0-C                                                           SCLIT      84
C     COMPUTE EL-PL PORTION OF INCR. STRAINS(COMP. STRAINS IF COMP.)     SCLIT      85
C     COMPUTE ELASTIC PORTION OF INCR. STRESSES(MATRIX STRESSES IF COMP) SCLIT      86
C     UPDATE STRESSES IN CORE                                            SCLIT      87
      DO 60 I=1,6                                                        SCLIT      88
      SN(I)=C1*SN(I)                                                     SCLIT      89
      SS(I)=C*DS(I)                                                      SCLIT      90
      K=0                                                                SCLIT      91
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=9                                  SCLIT      92
      AA(LLL(K+I)+M)=AA(LLL(K+I)+M)+SS(I)                                SCLIT      93
   60 SS(I)=AA(LLL(K+I)+M)                                               SCLIT      94
      ES=SS(1)**2+SS(2)**2+SS(3)**2-SS(1)*SS(2)-SS(1)*SS(3)-SS(2)*SS(3)  SCLIT      95
     1+3.*(SS(4)**2+SS(5)**2+SS(6)**2)                                   SCLIT      96
      AA(LLL(8)+M)=SQRT(ES)                                              SCLIT      97
C     COMPUTE INTERNAL RESISTANCE CORRESP. TO 1ST DEFL. INCR. (C*TOTAL   SCLIT      98
C     DEFL. INCR.) AND MATERIAL PROP. AT BEGINNING OF SUBSTEP AND ASSEML SCLIT      99
      CALL LOADY (DD,C)                                                  SCLIT     100
      CALL ASMELP                                                        SCLIT     101
      C=C1                                                               SCLIT     102
C     DECLARE PLASTIC ELEMENT                                            SCLIT     103
      AA(LLL(7)+M)=-YP                                                   SCLIT     104
      IELAS=1                                                            SCLIT     105
      RETURN                                                             SCLIT     106
      END                                                                SCLIT     107
*DECK SHFT
      SUBROUTINE SHFT (DSS,DAS,SS,AS,VF)                                 SHFT        2
C     TO COMPUTE INCR. SHIFT OF Y.S. (MATRIX Y.S. IF COMPOSITE)          SHFT        3
C     THE SHIFT IS PRAGER-ZIEGLER*S                                      SHFT        4
CMAP10                                                                   SHFT        5
      COMMON/COMEL/IN                                                    SHFT        6
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  SHFT        7
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     SHFT        8
      EQUIVALENCE (IN,IA(1),AA(1))                                       SHFT        9
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   SHFT       10
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   SHFT       11
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   SHFT       12
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   SHFT       13
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   SHFT       14
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   SHFT       15
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   SHFT       16
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   SHFT       17
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   SHFT       18
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   SHFT       19
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   SHFT       20
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   SHFT       21
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   SHFT       22
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   SHFT       23
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   SHFT       24
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   SHFT       25
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   SHFT       26
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   SHFT       27
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   SHFT       28
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    SHFT       29
      EQUIVALENCE     (IA(401), S(1))                                    SHFT       30
CEND MAP10                                                               SHFT       31
CMAP20                                                                   SHFT       32
      DIMENSION LLL(27)                                                  SHFT       33
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   SHFT       34
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   SHFT       35
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  SHFT       36
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  SHFT       37
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   SHFT       38
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   SHFT       39
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   SHFT       40
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   SHFT       41
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  SHFT       42
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   SHFT       43
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   SHFT       44
CEND MAP20                                                               SHFT       45
      DIMENSION DSS(6),DAS(6),SS(6),AS(6)                                SHFT       46
      IF(JJ.EQ.0) GO TO 20                                               SHFT       47
C     ELASTIC ELEMENT, NO SHIFT                                          SHFT       48
      DO 10 I=1,6                                                        SHFT       49
   10 DAS(I)=0.                                                          SHFT       50
      RETURN                                                             SHFT       51
C     PLASTIC ELEMENT, COMPUTE THE INCR. SHIFT IN DAS                    SHFT       52
   20 YP=AA(LLL(7)+M)                                                    SHFT       53
      K=0                                                                SHFT       54
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=9                                  SHFT       55
      DO 25 I=1,6                                                        SHFT       56
   25 SS(I)=AA(LLL(K+I)+M)                                               SHFT       57
      K=9                                                                SHFT       58
      IF(ITYPE.EQ.1 .AND. VF.GT.0.) K=15                                 SHFT       59
      DO 35 I=1,6                                                        SHFT       60
   35 AS(I)=AA(LLL(K+I)+M)                                               SHFT       61
      DMU=(DSS(1)-DSS(2)/2.-DSS(3)/2.)*(SS(1)-AS(1))                     SHFT       62
     1   +(DSS(2)-DSS(1)/2.-DSS(3)/2.)*(SS(2)-AS(2))                     SHFT       63
     2   +(DSS(3)-DSS(1)/2.-DSS(2)/2.)*(SS(3)-AS(3))                     SHFT       64
     3   +3.*(DSS(4)*(SS(4)-AS(4))+DSS(5)*(SS(5)-AS(5))+DSS(6)*(SS(6)-   SHFT       65
     4        AS(6)))                                                    SHFT       66
      DMU=DMU/(YP*YP)                                                    SHFT       67
      DO 30 I=1,6                                                        SHFT       68
   30 DAS(I)=DMU*(SS(I)-AS(I))                                           SHFT       69
      RETURN                                                             SHFT       70
      END                                                                SHFT       71
*DECK STNA
      SUBROUTINE STNA (SN)                                               STNA        2
C     USER SUPPLIED SUBROUTINE USED TO COMPUTE INCREMENTAL STRAINS       STNA        3
C     WHEN NSTAV IS NOT ZERO                                             STNA        4
C                                                                        STNA        5
C   MEANING OF SYMBOLS%                                                  STNA        6
C                                                                        STNA        7
C     IA     ARRAY(S) IN COMMON,COMEL                                    STNA        8
C     SN     INCREMENTAL STRAIN VECTOR OF ORDER SIX                      STNA        9
C     N      VECTOR CONTAINING NODE LABELS OF ELEMENT VERTICES           STNA       10
C     IXX    POINTER FOR X-COORDINATE ARRAY IN COMMON                    STNA       11
C     IYY    POINTER FOR Y-COORDINATE ARRAY IN COMMON                    STNA       12
C     IZZ    POINTER FOR Z-COORDINATE ARRAY IN COMMON                    STNA       13
C     IDEF   POINTER FOR INCREMENTAL DEFLECTIONS ARRAY IN COMMON;        STNA       14
C            PARTITIONED WITH RESPECT TO NODE NUMBERS                    STNA       15
C                                                                        STNA       16
      COMMON /COMEL/ IA(401)                                             STNA       17
      DIMENSION SN(6),N(8)                                               STNA       18
      EQUIVALENCE (IA(10),N(1)),(IA(50),IXX),(IA(51),IYY),(IA(52),IZZ),  STNA       19
     +(IA(54),IDEF)                                                      STNA       20
      RETURN                                                             STNA       21
      END                                                                STNA       22
*DECK STRN
      SUBROUTINE STRN (SN)                                               STRN        2
C *** TO COMPUTE BEST FIT STRAIN COMPONENTS FOR HEXAHEDRONS              STRN        3
CMAP10                                                                   STRN        4
      COMMON/COMEL/IN                                                    STRN        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  STRN        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     STRN        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       STRN        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   STRN        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   STRN       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   STRN       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   STRN       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   STRN       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   STRN       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   STRN       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   STRN       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   STRN       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   STRN       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   STRN       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   STRN       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   STRN       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   STRN       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   STRN       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   STRN       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   STRN       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   STRN       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   STRN       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    STRN       28
      EQUIVALENCE     (IA(401), S(1))                                    STRN       29
CEND MAP10                                                               STRN       30
CMAP20                                                                   STRN       31
      DIMENSION LLL(27)                                                  STRN       32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   STRN       33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   STRN       34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  STRN       35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  STRN       36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   STRN       37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   STRN       38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   STRN       39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   STRN       40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  STRN       41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   STRN       42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   STRN       43
CEND MAP20                                                               STRN       44
      DIMENSION SN(6),N1(28),N2(28),A(31,7),B(8,8),SI(6),AB(6,6)         STRN       45
      EQUIVALENCE (B(49),SI(1))                                          STRN       46
      DATA N1/1,2,3,4,5,6,7,8,1,2,3,4,1,2,7,1,8,4,5,3,6,7,1,4,1,2,3,4/   STRN       47
      DATA N2/2,3,4,1,6,7,8,5,7,6,5,8,6,7,4,8,3,5,2,6,8,5,3,2,5,8,7,6/   STRN       48
      IF (NSTAV.NE.0) GO TO 100                                          STRN       49
      C2=1.                                                              STRN       50
      KK=28                                                              STRN       51
      DO 10 I=1,KK                                                       STRN       52
      DX=AA(IXX+N(N2(I)))-AA(IXX+N(N1(I)))                               STRN       53
      DY=AA(IYY+N(N2(I)))-AA(IYY+N(N1(I)))                               STRN       54
      DZ=AA(IZZ+N(N2(I)))-AA(IZZ+N(N1(I)))                               STRN       55
      IF(I .EQ. 25) C2=DX*DX+DY*DY+DZ*DZ                                 STRN       56
      A(I,1)=DX*DX                                                       STRN       57
      A(I,2)=DY*DY                                                       STRN       58
      A(I,3)=DZ*DZ                                                       STRN       59
      A(I,4)=2.*DX*DY                                                    STRN       60
      A(I,5)=2.*DX*DZ                                                    STRN       61
      A(I,6)=2.*DY*DZ                                                    STRN       62
      K2=IDEF+(N(N2(I))-1)*3                                             STRN       63
      K1=IDEF+(N(N1(I))-1)*3                                             STRN       64
   10 A(I,7)= DX*(AA(K2+1)-AA(K1+1))+DY*(AA(K2+2)-AA(K1+2))              STRN       65
     1   +DZ*(AA(K2+3)-AA(K1+3))                                         STRN       66
 11   DO 15 I=1,6                                                        STRN       67
      DO 15 J=1,7                                                        STRN       68
      B(I,J)=0.                                                          STRN       69
      DO 14 K=1,KK                                                       STRN       70
   14 B(I,J)=B(I,J)+A(K,I)*A(K,J)                                        STRN       71
      IF(J.GT.6) GO TO 15                                                STRN       72
      AB(I,J)=B(I,J)                                                     STRN       73
   15 CONTINUE                                                           STRN       74
   17 CALL INV (AB,6,SI,1,AX)                                            STRN       75
      DO 16 I=1,3                                                        STRN       76
      SN(I)=SI(I)                                                        STRN       77
   16 SN(I+3)=SI(I+3)*2.                                                 STRN       78
      RETURN                                                             STRN       79
  100 CALL STNA (SN)                                                     STRN       80
      RETURN                                                             STRN       81
      END                                                                STRN       82
*DECK SUMMT
      SUBROUTINE SUMMT (X,DX)                                            SUMMT       2
C     TO ADD DX TO X                                                     SUMMT       3
      DIMENSION X(6),DX(6)                                               SUMMT       4
      DO 10 I=1,6                                                        SUMMT       5
   10 X(I)=X(I)+DX(I)                                                    SUMMT       6
      RETURN                                                             SUMMT       7
      END                                                                SUMMT       8
*DECK TOPO4
      SUBROUTINE TOPO4                                                   TOPO4       2
C *** PREPARES ELEMENT PROPERTIES                                        TOPO4       3
CMAP10                                                                   TOPO4       4
      COMMON/COMEL/IN                                                    TOPO4       5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TOPO4       6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TOPO4       7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TOPO4       8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TOPO4       9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TOPO4      10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TOPO4      11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TOPO4      12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TOPO4      13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TOPO4      14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TOPO4      15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TOPO4      16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TOPO4      17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TOPO4      18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TOPO4      19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TOPO4      20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TOPO4      21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TOPO4      22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TOPO4      23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TOPO4      24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TOPO4      25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TOPO4      26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TOPO4      27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TOPO4      28
      EQUIVALENCE     (IA(401), S(1))                                    TOPO4      29
CEND MAP10                                                               TOPO4      30
      IMET=0                                                             TOPO4      31
      JPRS=0                                                             TOPO4      32
      ITEM=0                                                             TOPO4      33
      JMFI=0                                                             TOPO4      34
      DO 10 I=1,8                                                        TOPO4      35
   10 N(I)=0                                                             TOPO4      36
      JM=J1+M                                                            TOPO4      37
      IMET=IA(JM)/100                                                    TOPO4      38
      JMFI=IA(JM)-100*IMET                                               TOPO4      39
      JM=J2+M                                                            TOPO4      40
      JPRS=IA(JM)/100                                                    TOPO4      41
      ITEM=IA(JM)-100*JPRS                                               TOPO4      42
      I=1                                                                TOPO4      43
      JM=J3+M                                                            TOPO4      44
      N(I)=IA(JM)                                                        TOPO4      45
      I=I+1                                                              TOPO4      46
      JM=J4+M                                                            TOPO4      47
      N(I)=IA(JM)                                                        TOPO4      48
      I=I+1                                                              TOPO4      49
      JM=J5+M                                                            TOPO4      50
      N(I)=IA(JM)                                                        TOPO4      51
      I=I+1                                                              TOPO4      52
      JM=J6+M                                                            TOPO4      53
      N(I)=IA(JM)                                                        TOPO4      54
      I=I+1                                                              TOPO4      55
      JM=J7+M                                                            TOPO4      56
      N(I)=IA(JM)                                                        TOPO4      57
      I=I+1                                                              TOPO4      58
      JM=J8+M                                                            TOPO4      59
      N(I)=IA(JM)                                                        TOPO4      60
      I=I+1                                                              TOPO4      61
      JM=J9+M                                                            TOPO4      62
      N(I)=IA(JM)                                                        TOPO4      63
      I=I+1                                                              TOPO4      64
      JM=J10+M                                                           TOPO4      65
      N(I)=IA(JM)                                                        TOPO4      66
      RETURN                                                             TOPO4      67
      END                                                                TOPO4      68
*DECK TRANN4
      SUBROUTINE TRANN4                                                  TRANN4      2
C     TO COMPUTE STRAIN TRANSFORMATION MATRIX OF THE LAMINA IN E66       TRANN4      3
CMAP10                                                                   TRANN4      4
      COMMON/COMEL/IN                                                    TRANN4      5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TRANN4      6
     1YD(8),ZD(8),D21(21),S(1),G1(1)                                     TRANN4      7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TRANN4      8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TRANN4      9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TRANN4     10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TRANN4     11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TRANN4     12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TRANN4     13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TRANN4     14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TRANN4     15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TRANN4     16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TRANN4     17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TRANN4     18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TRANN4     19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TRANN4     20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TRANN4     21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA(83), P(1)),   TRANN4     22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TRANN4     23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TRANN4     24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TRANN4     25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TRANN4     26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TRANN4     27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TRANN4     28
      EQUIVALENCE     (IA(401),S(1))                                     TRANN4     29
CEND MAP10                                                               TRANN4     30
CMAP40                                                                   TRANN4     31
      DIMENSION NOO(20), PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)           TRANN4     32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       TRANN4     33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), TRANN4     34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         TRANN4     35
CEND MAP40                                                               TRANN4     36
      DO 10 I=1,3                                                        TRANN4     37
      DO 10 J=1,3                                                        TRANN4     38
   10 E66(I,J)=DIR(I,J)*DIR(I,J)                                         TRANN4     39
      E66(1,4)=DIR(1,1)*DIR(1,2)                                         TRANN4     40
      E66(1,5)=DIR(1,1)*DIR(1,3)                                         TRANN4     41
      E66(1,6)=DIR(1,2)*DIR(1,3)                                         TRANN4     42
      E66(2,4)=DIR(2,1)*DIR(2,2)                                         TRANN4     43
      E66(2,5)=DIR(2,1)*DIR(2,3)                                         TRANN4     44
      E66(2,6)=DIR(2,2)*DIR(2,3)                                         TRANN4     45
      E66(3,4)=DIR(3,1)*DIR(3,2)                                         TRANN4     46
      E66(3,5)=DIR(3,1)*DIR(3,3)                                         TRANN4     47
      E66(3,6)=DIR(3,2)*DIR(3,3)                                         TRANN4     48
      E66(4,1)=2.0*DIR(1,1)*DIR(2,1)                                     TRANN4     49
      E66(5,1)=2.0*DIR(1,1)*DIR(3,1)                                     TRANN4     50
      E66(6,1)=2.0*DIR(2,1)*DIR(3,1)                                     TRANN4     51
      E66(4,2)=2.0*DIR(1,2)*DIR(2,2)                                     TRANN4     52
      E66(5,2)=2.0*DIR(1,2)*DIR(3,2)                                     TRANN4     53
      E66(6,2)=2.0*DIR(2,2)*DIR(3,2)                                     TRANN4     54
      E66(4,3)=2.0*DIR(1,3)*DIR(2,3)                                     TRANN4     55
      E66(5,3)=2.0*DIR(1,3)*DIR(3,3)                                     TRANN4     56
      E66(6,3)=2.0*DIR(2,3)*DIR(3,3)                                     TRANN4     57
      E66(4,4)=DIR(1,1)*DIR(2,2)+DIR(1,2)*DIR(2,1)                       TRANN4     58
      E66(5,4)=DIR(1,1)*DIR(3,2)+DIR(1,2)*DIR(3,1)                       TRANN4     59
      E66(6,4)=DIR(2,1)*DIR(3,2)+DIR(2,2)*DIR(3,1)                       TRANN4     60
      E66(4,5)=DIR(1,1)*DIR(2,3)+DIR(1,3)*DIR(2,1)                       TRANN4     61
      E66(5,5)=DIR(1,1)*DIR(3,3)+DIR(1,3)*DIR(3,1)                       TRANN4     62
      E66(6,5)=DIR(2,1)*DIR(3,3)+DIR(2,3)*DIR(3,1)                       TRANN4     63
      E66(4,6)=DIR(1,2)*DIR(2,3)+DIR(1,3)*DIR(2,2)                       TRANN4     64
      E66(5,6)=DIR(1,2)*DIR(3,3)+DIR(1,3)*DIR(3,2)                       TRANN4     65
      E66(6,6)=DIR(2,2)*DIR(3,3)+DIR(2,3)*DIR(3,3)                       TRANN4     66
      RETURN                                                             TRANN4     67
      END                                                                TRANN4     68
*DECK TRANS4
      SUBROUTINE TRANS4                                                  TRANS4      2
C     TO COMPUTE STRESS TRANSFORMATION MATRIX OF THE LAMINA IN E66       TRANS4      3
CMAP10                                                                   TRANS4      4
      COMMON/COMEL/IN                                                    TRANS4      5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  TRANS4      6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     TRANS4      7
      EQUIVALENCE (IN,IA(1),AA(1))                                       TRANS4      8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   TRANS4      9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   TRANS4     10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   TRANS4     11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   TRANS4     12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   TRANS4     13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   TRANS4     14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   TRANS4     15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   TRANS4     16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   TRANS4     17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   TRANS4     18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   TRANS4     19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   TRANS4     20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   TRANS4     21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   TRANS4     22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   TRANS4     23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   TRANS4     24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   TRANS4     25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   TRANS4     26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   TRANS4     27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    TRANS4     28
      EQUIVALENCE     (IA(401), S(1))                                    TRANS4     29
CEND MAP10                                                               TRANS4     30
CMAP40                                                                   TRANS4     31
      DIMENSION NOO(20),PD(3),NOT(4),A(6,6),DIR(3,3),E66(6,6)            TRANS4     32
      EQUIVALENCE (IA(200),A(1)),(IA(236),DIR(1)),(IA(245),PD(1)),       TRANS4     33
     1(IA(248),NOO(1)),(IA(268),NOT(1)),(IA(274),E66(1)),(IA(310),PRCO), TRANS4     34
     2(IA(311),ITTT),(IA(312),CFE),(IA(313),NAV)                         TRANS4     35
CEND MAP40                                                               TRANS4     36
      DO 10 I=1,3                                                        TRANS4     37
      DO 10 J=1,3                                                        TRANS4     38
   10 E66(I,J)=DIR(I,J)**2                                               TRANS4     39
      E66(1,4)=2.*DIR(1,1)*DIR(1,2)                                      TRANS4     40
      E66(1,5)=2.*DIR(1,1)*DIR(1,3)                                      TRANS4     41
      E66(1,6)=2.*DIR(1,2)*DIR(1,3)                                      TRANS4     42
      E66(2,4)=2.*DIR(2,1)*DIR(2,2)                                      TRANS4     43
      E66(2,5)=2.*DIR(2,1)*DIR(2,3)                                      TRANS4     44
      E66(2,6)=2.*DIR(2,2)*DIR(2,3)                                      TRANS4     45
      E66(3,4)=2.*DIR(3,1)*DIR(3,2)                                      TRANS4     46
      E66(3,5)=2.*DIR(3,1)*DIR(3,3)                                      TRANS4     47
      E66(3,6)=2.*DIR(3,2)*DIR(3,3)                                      TRANS4     48
      E66(4,1)=DIR(1,1)*DIR(2,1)                                         TRANS4     49
      E66(5,1)=DIR(1,1)*DIR(3,1)                                         TRANS4     50
      E66(6,1)=DIR(2,1)*DIR(3,1)                                         TRANS4     51
      E66(4,2)=DIR(1,2)*DIR(2,2)                                         TRANS4     52
      E66(5,2)=DIR(1,2)*DIR(3,2)                                         TRANS4     53
      E66(6,2)=DIR(2,2)*DIR(3,2)                                         TRANS4     54
      E66(4,3)=DIR(1,3)*DIR(2,3)                                         TRANS4     55
      E66(5,3)=DIR(1,3)*DIR(3,3)                                         TRANS4     56
      E66(6,3)=DIR(2,3)*DIR(3,3)                                         TRANS4     57
      E66(4,4)=DIR(1,1)*DIR(2,2)+DIR(1,2)*DIR(2,1)                       TRANS4     58
      E66(5,4)=DIR(1,1)*DIR(3,2)+DIR(1,2)*DIR(3,1)                       TRANS4     59
      E66(6,4)=DIR(2,1)*DIR(3,2)+DIR(2,2)*DIR(3,1)                       TRANS4     60
      E66(4,5)=DIR(1,1)*DIR(2,3)+DIR(1,3)*DIR(2,1)                       TRANS4     61
      E66(5,5)=DIR(1,1)*DIR(3,3)+DIR(1,3)*DIR(3,1)                       TRANS4     62
      E66(6,5)=DIR(2,1)*DIR(3,3)+DIR(2,3)*DIR(3,1)                       TRANS4     63
      E66(4,6)=DIR(1,2)*DIR(2,3)+DIR(1,3)*DIR(2,2)                       TRANS4     64
      E66(5,6)=DIR(1,2)*DIR(3,3)+DIR(1,3)*DIR(3,2)                       TRANS4     65
      E66(6,6)=DIR(2,2)*DIR(3,3)+DIR(2,3)*DIR(3,2)                       TRANS4     66
      RETURN                                                             TRANS4     67
      END                                                                TRANS4     68
*DECK UPDT
      SUBROUTINE UPDT (SI,K)                                             UPDT        2
C     TO UPDATE STRESSES, STRAINS, AND CENTER OF Y.S. IN CORE            UPDT        3
CMAP10                                                                   UPDT        4
      COMMON/COMEL/IN                                                    UPDT        5
      DIMENSION IA(401),AA(401),N(8),P(24),UV(24),X(8),Y(8),Z(8),XD(8),  UPDT        6
     1YD(7),ZD(7),D21(21),S(1),G1(1)                                     UPDT        7
      EQUIVALENCE (IN,IA(1),AA(1))                                       UPDT        8
      EQUIVALENCE     (IA(  2),  IBN),(IA(  3),   IT),(IA(  4),   IP),   UPDT        9
     1(IA(  5), IPRS),(IA(  6),ITYPE),(IA(  7), IMAT),(IA(  8),  INX),   UPDT       10
     2(IA(  9), IMFI),(IA( 10), N(1)),(IA( 18),    M),(IA( 19),  ITY),   UPDT       11
     3(IA( 20), ITEM),(IA( 21), IMET),(IA( 22), ISUM),(IA( 23),ISHUF),   UPDT       12
     4(IA( 24), IORD),(IA( 25),IORD1),(IA( 26), ACEL),(IA( 27),  INP),   UPDT       13
     5(IA( 28), IPBG),(IA( 29), IPEN),(IA( 30), CONS),(IA( 31),   IU),   UPDT       14
     6(IA( 32),G1(1)),(IA( 33),   G2),(IA( 34),   G3),(IA( 35),   J1),   UPDT       15
     7(IA( 36),   J2),(IA( 37),   J3),(IA( 38),   J4),(IA( 39),   J5),   UPDT       16
     8(IA( 40),   J6),(IA( 41),   J7),(IA( 42),   J8),(IA( 43),  JTY),   UPDT       17
     9(IA( 44),  IBB),(IA( 45),  IBO),(IA( 46),  IID),(IA( 47),  IIA),   UPDT       18
     A(IA( 48),  IDT),(IA( 49), ICFI),(IA( 50),  IXX),(IA( 51),  IYY),   UPDT       19
     B(IA( 52),  IZZ),(IA( 53),  IIC),(IA( 54), IDEF),(IA( 55),  IST),   UPDT       20
     C(IA( 56),  IIS),(IA( 57), IERR),(IA( 58),   DT),(IA( 59),  AL1),   UPDT       21
     D(IA( 60),  AL2),(IA( 61),  AL3),(IA( 62),D21(1)),(IA( 83),P(1)),   UPDT       22
     E(IA(107),UV(1)),(IA(131), X(1)),(IA(139), Y(1)),(IA(147), Z(1)),   UPDT       23
     F(IA(155),XD(1)),(IA(162),YD(1)),(IA(169),ZD(1)),(IA(176), IMES),   UPDT       24
     G(IA(177), IBUN),(IA(178), ICOR),(IA(179), IPIR),(IA(180), PRES),   UPDT       25
     H(IA(181),  IPR),(IA(182), ITAS),(IA(183), JMFI),(IA(184), JMMZ),   UPDT       26
     I(IA(185), JMMY),(IA(186), JMMX),(IA(187), JPRS),(IA(188),  J10),   UPDT       27
     J(IA(189),   J9),(IA(190), ISDT),(IA(326),   IO),(IA(327),   MO)    UPDT       28
      EQUIVALENCE     (IA(401), S(1))                                    UPDT       29
CEND MAP10                                                               UPDT       30
CMAP20                                                                   UPDT       31
      DIMENSION LLL(27)                                                  UPDT       32
      EQUIVALENCE     (IA(328), MAXI),(IA(329),MAXSI),(IA(330),NPRIN),   UPDT       33
     1(IA(331),NSTAV),(IA(332),  ER1),(IA(333),KHARD),(IA(334),IHARD),   UPDT       34
     2(IA(335), IFBR),(IA(336),  LHD),(IA(337),IELAS),(IA(338),LLL(1)),  UPDT       35
     3(IA(365), ITER),(IA(366),ITERS),(IA(367),PNORMB),(IA(368),PNORM),  UPDT       36
     4(IA(369), IDIV),(IA(370), SCAL),(IA(371), CUMS),(IA(372), DESC),   UPDT       37
     5(IA(373),  LLD),(IA(374), LCDP),(IA(375),  MPR),(IA(376),   JJ),   UPDT       38
     6(IA(377), IPOT),(IA(378),  YJ2),(IA(379),    H),(IA(380), ITAX),   UPDT       39
     7(IA(381),   ZZ),(IA(382), IAMB),(IA(383), IYIT),(IA(384),PSCAL),   UPDT       40
     8(IA(385),ISECT),(IA(386), IYEL),(IA(387),KTERS),(IA(388),QNORMB),  UPDT       41
     9(IA(389),    D),(IA(390),  IDD),(IA(391),  IRR),(IA(392),   NI),   UPDT       42
     A(IA(393),ICOUNT),(IA(394),ISCAL)                                   UPDT       43
CEND MAP20                                                               UPDT       44
      DIMENSION SI(6)                                                    UPDT       45
C     K.LT.0=UPDATE STRAINS, K.GE.0=UPDATE STRESSES & CENTER OF Y.S.     UPDT       46
      IF(K.LT.0) GO TO 20                                                UPDT       47
C     K=0, UPDATE STRESSES; K=9,ITYPE=1, UPDATE MATRIX STRESSES; K=9,    UPDT       48
C     ITYPE=0, UPDATE CENTER OF Y.S.; K=15,ITYPE=1, UPDATE CENTER        UPDT       49
C     OF MATRIX Y.S.; K=21, ITYPE=1, IFBR.GT.0, UPDATE FIBER STRESSES    UPDT       50
      DO 10 I=1,6                                                        UPDT       51
   10 AA(LLL(I+K)+M)=AA(LLL(I+K)+M)+SI(I)                                UPDT       52
C     UPDATE EFFECTIVE STRESS IN CORE                                    UPDT       53
      IF(K.EQ.0) RETURN                                                  UPDT       54
      IF(ITYPE.EQ.1) RETURN                                              UPDT       55
      J=0                                                                UPDT       56
      IF(K.EQ.15) J=9                                                    UPDT       57
      Y2=AA(LLL(J+1)+M)**2+AA(LLL(J+2)+M)**2+AA(LLL(J+3)+M)**2           UPDT       58
     1-AA(LLL(J+1)+M)*AA(LLL(J+2)+M)-AA(LLL(J+1)+M)*AA(LLL(J+3)+M)       UPDT       59
     2-AA(LLL(J+2)+M)*AA(LLL(J+3)+M)+3.*(AA(LLL(J+4)+M)**2               UPDT       60
     3+AA(LLL(J+5)+M)**2+AA(LLL(J+6)+M)**2)                              UPDT       61
      Y2=SQRT(Y2)                                                        UPDT       62
      AA(LLL(8)+M)=Y2                                                    UPDT       63
      RETURN                                                             UPDT       64
C     STORE INCR. STRAINS IN LLY-AREA                                    UPDT       65
   20 LLY=IST+2*ISUM+1                                                   UPDT       66
      DO 30 I=1,6                                                        UPDT       67
      J=LLY+(I-1)*IT+M                                                   UPDT       68
   30 AA(J)=SI(I)                                                        UPDT       69
      IF(ITER.GT.1 .OR. ITERS.GT.1) RETURN                               UPDT       70
C     INITIALIZE STRESSES AND CENTER OF Y.S.                             UPDT       71
      DO 40 I=1,6                                                        UPDT       72
      AA(LLL(I)+M)=0.                                                    UPDT       73
      AA(LLL(I+9)+M)=0.                                                  UPDT       74
      IF(ITYPE.EQ.0) GO TO 40                                            UPDT       75
      AA(LLL(I+15)+M)=0.                                                 UPDT       76
      IF(IFBR.EQ.0) GO TO 40                                             UPDT       77
      AA(LLL(I+21)+M)=0.                                                 UPDT       78
   40 CONTINUE                                                           UPDT       79
      AA(LLL(7)+M)=0.                                                    UPDT       80
      AA(LLL(8)+M)=0.                                                    UPDT       81
      AA(LLL(9)+M)=IAMB                                                  UPDT       82
      RETURN                                                             UPDT       83
      END                                                                UPDT       84
*DECK YHARP
      SUBROUTINE YHARP (IMET,YS)                                         YHARP       2
C     USER SUPPLIED SUBROUTINE USED TO OBTAIN VIRGIN YIELD               YHARP       3
C     STRESS (YS) WHEN IHARD=0                                           YHARP       4
C                                                                        YHARP       5
C   MEANING OF SYMBOLS%                                                  YHARP       6
C                                                                        YHARP       7
C     IMET   MATERIAL TYPE NUMBER                                        YHARP       8
C     YS     VIRGIN YIELD STRESS OF MATERIAL IMET                        YHARP       9
C                                                                        YHARP      10
      RETURN                                                             YHARP      11
      END                                                                YHARP      12
*DECK YHAR4P
      SUBROUTINE YHAR4P (ES,IMET,H)                                      YHAR4P      2
C     USER SUPPLIED SUBROUTINE USED TO OBTAIN THE SLOPE OF THE           YHAR4P      3
C     EFFECTIVE STRESS - EFFECTIVE PLASTIC STRAIN CURVE AT GIVEN         YHAR4P      4
C     STRESS LEVEL AND MATERIAL TYPE (WHEN IHARD=0)                      YHAR4P      5
C                                                                        YHAR4P      6
C   MEANING OF SYMBOLS%                                                  YHAR4P      7
C                                                                        YHAR4P      8
C     ES    EFFECTIVE STRESS                                             YHAR4P      9
C     IMET  MATERIAL TYPE NUMBER                                         YHAR4P     10
C     H     SLOPE OF EFFECTIVE STRESS-EFFECTIVE PLASTIC STRAIN CURVE     YHAR4P     11
C                                                                        YHAR4P     12
      RETURN                                                             YHAR4P     13
      END                                                                YHAR4P     14
F %%A>
