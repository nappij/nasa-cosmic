      PROGRAM MISRB                                                     MIS00010C                                                                       MIS00020C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS00030C                                                                      $MIS00040C             PROGRAM MISRB - A BATCH VERSION OF MISER2                $MIS00050C                                                          06/24/87/RA $MIS00060C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS00070C                                                                       MIS00080C                                                                       MIS00090C                                                                       MIS00100C                                                                       MIS00110C   ***         ***   ***    **********   ************   ************   MIS00120C   ****       ****   ***   ***********   ************   *************  MIS00130C   *****     *****   ***   ***           ***            ***       ***  MIS00140C   ******   ******   ***   **********    ************   *************  MIS00150C   *** *** *** ***   ***    **********   ************   ************   MIS00160C   ***  *****  ***   ***           ***   ***            ***     ***    MIS00170C   ***   ***   ***   ***   ***********   ************   ***      ***   MIS00180C   ***    *    ***   ***   **********    ************   ***       ***  MIS00190C                                                                       MIS00200C                                                                       MIS00210C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS00220C                                                                       MIS00230C     CALL TITPAG                                                       MIS00240C                                                                       MIS00250C.....READ INPUT DATA                                                   MIS00260C                                                                       MIS00270    1 CALL INDAT2                                                       MIS00280C                                                                       MIS00290C.....CALCULATE UNSTEADY AERODYNAMIC COEFFICIENTS                       MIS00300C                                                                       MIS00310      CALL ADMAT                                                        MIS00320C                                                                       MIS00330C.....ASSEMBLE MATRICES, SOLVE EIGENVALUE PROBLEM, CALL OUTPUT          MIS00340C.....SUBROUTINES, SETUP AND SOLVE RESPONSE PROBLEM, AND CALL           MIS00350C.....ADDITIONAL OUTPUT SUBROUTINES                                     MIS00360C                                                                       MIS00370      CALL SOLVR2                                                       MIS00380      GO TO 1                                                           MIS00390
      END                                                               MIS00400C                                                                       MIS00410C                                                                       MIS00420C                                                                       MIS00430      SUBROUTINE INDAT2                                                 MIS00440C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$     MIS00450C                                                                       MIS00460C THE FUNCTION OF INDAT2 IS TO MANAGE MOST OF THE INPUT DATA            MIS00470C THERE ARE SIX DIFFERENT TYPES OF MISTUNING AVAILABLE                  MIS00480C                                                                       MIS00490C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$     MIS00500C                                                                       MIS00510      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS00520      REAL*4 ZD,GHSY,GASY,ZHSY,ZASY                                     MIS00530      CHARACTER*4 RI, DUMMY                                             MIS00540      CHARACTER*1 FLAG,TUNE                                             MIS00550      COMMON/PARAM/NB                                                   MIS00560C                                                                       MIS00570C     COMMON/IPARAM/GAS(60),GHS(60),ZAS(60),ZHS(60),XK,XI,A,SC,XMU,XRA, MIS00580C    *              XA,W0,AMACH                                         MIS00590      COMMON /AERO1/ XNB, XK, XI, A, SC, XMU, XRA, XA, W0, WD1, AMACH   MIS00600      COMMON /STRUC1/ GAS(60), GHS(60), ZAS(60), ZHS(60)                MIS00610C                                                                       MIS00620      COMMON /RID/ RI(10), TUNE                                         MIS00630      DIMENSION ZD(10),GHSY(10),GASY(10),ZHSY(10),ZASY(10),ND(10)       MIS00640      DATA NBMAX,NIMAX/60,6/                                            MIS00650C                                                                       MIS00660C.....READ JOB TITLE                                                    MIS00670C                                                                       MIS00680 8998 READ(5,8999) FLAG                                                 MIS00690 8999 FORMAT(A1)                                                        MIS00700      IF (FLAG.EQ.'$') GO TO 8998                                       MIS00710      BACKSPACE 5                                                       MIS00720      READ(5,9000) RI                                                   MIS00730      WRITE(6,9001) RI                                                  MIS00740      CALL TIME                                                         MIS00750 9000 FORMAT(T11,10A4)                                                  MIS00760 9001 FORMAT(1H1,10A4/)                                                 MIS00770C                                                                       MIS00780
C.....READ ROTOR DATA; NUMBER OF BLADES, GAP TO CHORD RATIO             MIS00790C                                                                       MIS00800 9002 READ(5,8999) FLAG                                                 MIS00810      IF (FLAG.EQ.'$') GO TO 9002                                       MIS00820      BACKSPACE 5                                                       MIS00830      READ(5,9005) RNB, SC                                              MIS00840 9005 FORMAT(10X,5F10.5)                                                MIS00850      NB = INT(RNB)                                                     MIS00860      IF (NB.GT.NBMAX) THEN                                             MIS00870           PRINT*,'PROGRAM TERMINATED.  MAXIMUM BLADE NUMBER EXCEEDED'  MIS00880           STOP                                                         MIS00890       ENDIF                                                            MIS00900C                                                                       MIS00910C.....READ BLADE DATA; STAGGER ANGLE, BLADE/AIR MASS RATIO              MIS00920C                                                                       MIS00930 9003 READ(5,8999) FLAG                                                 MIS00940      IF (FLAG.EQ.'$') GO TO 9003                                       MIS00950      BACKSPACE 5                                                       MIS00960      READ(5,9005) XI, XMU                                              MIS00970      XNB=NB                                                            MIS00980      XI=XI*.01745329D0                                                 MIS00990      W0 = 0.                                                           MIS01000C                                                                       MIS01010C.....READ AERO DATA;  REDUCED FREQUENCY, MACH NUMBER                   MIS01020C                                                                       MIS01030 9006 READ(5,8999) FLAG                                                 MIS01040      IF (FLAG.EQ.'$') GO TO 9006                                       MIS01050      BACKSPACE 5                                                       MIS01060      READ(5,9005) XK, AMACH                                            MIS01070C                                                                       MIS01080C.....READ STRUCTURAL DATA;  PITCHING AXIS, RADIUS OF GYRATION,         MIS01090C.....CENTER OF GRAVITY, BENDING FREQUENCY, STRUCTURAL DAMPING          MIS01100C                                                                       MIS01110 9007 READ(5,8999) FLAG                                                 MIS01120      IF (FLAG.EQ.'$') GO TO 9007                                       MIS01130      BACKSPACE 5                                                       MIS01140      READ(5,9005) A, XRA, XA, ZD(1), ZD(2)                             MIS01150C                                                                       MIS01160C.....READ TUNING OPTION                                                MIS01170
C                                                                       MIS01180C TUNE = T FOR TUNED                                                    MIS01190C        R FOR RANDOM MISTUNING FOR TORSIONAL FREQUENCY ONLY            MIS01200C....FOLLOWING OPTIONS NOT YET AVAILABLE                                MIS01210C        M FOR MANUAL INPUT OF FREQUENCIES AND DAMPINGS                 MIS01220C        A FOR ALTERNATING MISTUNING (TORSIONAL MODE ONLY)              MIS01230C        S FOR SYMMETRY GROUP MISTUNING                                 MIS01240C        F FOR READING FREQUENCIES AND DAMPINGS FROM FILE               MIS01250C                                                                       MIS01260 9009 READ(5,8999) FLAG                                                 MIS01270      IF (FLAG.EQ.'$') GO TO 9009                                       MIS01280      BACKSPACE 5                                                       MIS01290      CALL PARSE(TUNE,1)                                                MIS01300      IF(TUNE.EQ.'S') GO TO 40                                          MIS01310      IF(TUNE.EQ.'F') GO TO 60                                          MIS01320      IF(TUNE.EQ.'T'.OR.TUNE.EQ.'A'.OR.TUNE.EQ.'R') GO TO 30            MIS01330C                                                                       MIS01340C.....MANUAL INPUT                                                      MIS01350C                                                                       MIS01360C     WRITE(6,110)                                                      MIS01370  110 FORMAT(' MANUAL INPUT OPTION FOR FREQUENCIES AND DAMPINGS CHOSEN'/MIS01380     &      /' INPUT GAMMA HS')                                         MIS01390      J=-10                                                             MIS01400      DO 10 I=1,NIMAX                                                   MIS01410      J=J+10                                                            MIS01420      IF(J.GT.NB)GO TO 15                                               MIS01430      J1=J+1                                                            MIS01440      K1=J+10                                                           MIS01450      WRITE(6,115)J1,K1                                                 MIS01460115   FORMAT(2X,I3,' THRU',I3)                                          MIS01470      READ (5,*) (GHS(J+K),K=1,10)                                      MIS0148010    CONTINUE                                                          MIS0149015    WRITE(6,111)                                                      MIS01500111   FORMAT(' INPUT GAMMA ALPHA S')                                    MIS01510      J=-10                                                             MIS01520      DO 11 I=1,NIMAX                                                   MIS01530      J=J+10                                                            MIS01540      IF(J.GT.NB)GO TO 16                                               MIS01550      J1=J+1                                                            MIS01560
      K1=J+10                                                           MIS01570      WRITE(6,115)J1,K1                                                 MIS01580      READ (5,*) (GAS(J+K),K=1,10)                                      MIS0159011    CONTINUE                                                          MIS0160016    WRITE(6,120)                                                      MIS01610120   FORMAT(' INPUT ZETA HS')                                          MIS01620      J=-10                                                             MIS01630      DO 20 I=1,NIMAX                                                   MIS01640      J=J+10                                                            MIS01650      IF(J.GT.NB)GO TO 25                                               MIS01660      J1=J+1                                                            MIS01670      K1=J+10                                                           MIS01680      WRITE(6,115)J1,K1                                                 MIS01690      READ (5,*) (ZHS(J+K),K=1,10)                                      MIS0170020    CONTINUE                                                          MIS0171025    WRITE(6,121)                                                      MIS01720121   FORMAT(' INPUT ZETA ALPHA S')                                     MIS01730      J=-10                                                             MIS01740      DO 21 I=1,NIMAX                                                   MIS01750      J=J+10                                                            MIS01760      IF(J.GT.NB)GO TO 26                                               MIS01770      J1=J+1                                                            MIS01780      K1=J+10                                                           MIS01790      WRITE (6,115) J1,K1                                               MIS01800      READ (5,*) (ZAS(J+K),K=1,10)                                      MIS0181021    CONTINUE                                                          MIS0182026    CONTINUE                                                          MIS01830      GO TO 9020                                                        MIS01840C                                                                       MIS01850C.....TUNED, RANDOM MISTUNING, OR ALTERNATING MISTUNING                 MIS01860C                                                                       MIS01870   30 CONTINUE                                                          MIS01880      IF (TUNE.EQ.'T') PRINT*,' TUNED OPTION CHOSEN'                    MIS01890      IF (TUNE.EQ.'A') PRINT*,' ALTERNATE MISTUNING OPTION CHOSEN'      MIS01900C                                                                       MIS01910C.....RANDOM MISTUNING                                                  MIS01920C                                                                       MIS01930      IF (TUNE.EQ.'R') THEN                                             MIS01940          PRINT*,' RANDOM MISTUNING OPTION CHOSEN'                      MIS01950
C         CALL RBG                                                      MIS01960          CALL RBGNEW                                                   MIS01970      ENDIF                                                             MIS01980C                                                                       MIS01990      DO 35 I=1,NB                                                      MIS02000      GHS(I)=ZD(1)                                                      MIS02010      IF (TUNE.EQ.'T') GAS(I)=1.D0                                      MIS02020      ZHS(I)=ZD(2)                                                      MIS0203035    ZAS(I)=ZD(2)                                                      MIS02040      IF(TUNE.EQ.'T'.OR.TUNE.EQ.'R') GO TO 9020                         MIS02050C                                                                       MIS02060C.....ALTERNATING MISTUNING                                             MIS02070C                                                                       MIS02080      WRITE(6,737)                                                      MIS02090737   FORMAT(' CIRCULAR MISTUNING: NW, DEV(SIN), DEV(COS), FREQ(0) OR DAMIS02100     *MP(1)?-')                                                         MIS02110      READ (5,*) XNW,DEVS,DEVC,ND(4)                                    MIS02120      SARG=6.28318531D0*XNW/XNB                                         MIS02130      DO 36 I=1,NB                                                      MIS02140      XS=I-1                                                            MIS02150      IF(ND(4).EQ.0)GAS(I)=1.D0+DEVS*DSIN(SARG*XS)+DEVC*DCOS(SARG*XS)   MIS02160      IF(ND(4).EQ.1)ZAS(I)=DEVC+DEVS*DSIN(SARG*XS)+DEVC*DCOS(SARG*XS)   MIS0217036    CONTINUE                                                          MIS02180      GO TO 9020                                                        MIS02190C                                                                       MIS02200C.....SYMMETRY GROUP MISTUNING                                          MIS02210C                                                                       MIS0222040    WRITE(6,41)                                                       MIS0223041    FORMAT('  # IN SYMMETRY GROUP?-')                                 MIS02240      READ (5,*) NSG                                                    MIS02250      WRITE(6,110)                                                      MIS02260      READ (5,*) (GHSY(K),K=1,NSG)                                      MIS02270      WRITE(6,111)                                                      MIS02280      READ (5,*) (GASY(K),K=1,NSG)                                      MIS02290      WRITE(6,120)                                                      MIS02300      READ (5,*) (ZHSY(K),K=1,NSG)                                      MIS02310      WRITE(6,121)                                                      MIS02320      READ (5,*) (ZASY(K),K=1,NSG)                                      MIS02330      I=0                                                               MIS02340
      DO 45 IG=1,60                                                     MIS02350      DO 45 J=1,NSG                                                     MIS02360      I=I+1                                                             MIS02370      IF(I.GT.NB)GO TO 46                                               MIS02380      GHS(I)=GHSY(J)                                                    MIS02390      GAS(I)=GASY(J)                                                    MIS02400      ZHS(I)=ZHSY(J)                                                    MIS0241045    ZAS(I)=ZASY(J)                                                    MIS0242046    CONTINUE                                                          MIS02430C                                                                       MIS02440C.....RANDOMIZE CURRENTLY DEFINED FREQUENCIES AND DAMPINGS              MIS02450C                                                                       MIS02460C     WRITE(6,195)                                                      MIS02470C 195 FORMAT(' RANDOMIZE?-')                                            MIS02480C     READ (6,*) ID                                                     MIS02490C     IF (ID.EQ.0) GO TO 9020                                           MIS02500C     WRITE(6,196)                                                      MIS02510C 196 FORMAT(' STANDARD DEVIATIONS, GHS,GAS,ZHS,ZAS?-')                 MIS02520C     READ (5,*) SDGHS,SDGAS,SDZHS,SDZAS                                MIS02530C     CALL RSEED                                                        MIS02540C     DO 51 I=1,NB                                                      MIS02550C     CALL STATS(SD)                                                    MIS02560C     GHS(I)=GHS(I)+SD*SDGHS                                            MIS02570C     CALL STATS(SD)                                                    MIS02580C     GAS(I)=GAS(I)+SD*SDGAS                                            MIS02590C     CALL STATS(SD)                                                    MIS02600C     ZHS(I)=ZHS(I)+SD*SDZHS                                            MIS02610C     CALL STATS(SD)                                                    MIS02620C     ZAS(I)=ZAS(I)+SD*SDZAS                                            MIS02630C  51 CONTINUE                                                          MIS02640C     GO TO 9020                                                        MIS02650C                                                                       MIS02660C.....READ FROM FILE                                                    MIS02670C                                                                       MIS0268060    REWIND 1                                                          MIS02690      READ(1)GHS,GAS,ZHS,ZAS                                            MIS02700      WRITE(6,198)                                                      MIS02710198   FORMAT(' GHS,GAS,ZHS,ZAS READ FROM FILE 1')                       MIS02720      GO TO 9020                                                        MIS02730
C                                                                       MIS02740 9020 CONTINUE                                                          MIS02750C                                                                       MIS02760C.....ECHO INPUT PARAMETERS                                             MIS02770C                                                                       MIS02780      WRITE(6,9050) NB, SC,  XI/.0174533, XMU,  XK, AMACH,              MIS02790     &              A, XRA, XA, ZD(1), ZD(2), TUNE                      MIS02800 9050 FORMAT(T2,'*** INPUT DATA ECHO FROM INDAT2 ***'/T6,'ROTOR'/       MIS02810     &   T8,'# OF BLADES   :',T27,I5  /T8,'GAP TO CHORD  :',T27,F8.3/   MIS02820     &   T6,'BLADE'/                                                    MIS02830     &   T8,'STAGGER ANGLE :',T27,F8.3/T8,'MU            :',T27,F8.3/   MIS02840     &   T6,'AERO'/                                                     MIS02850     &   T8,'REDUCED FREQ  :',T27,F8.3/T8,'INLET MACH #  :',T27,F8.3/   MIS02860     &   T6,'STRUCTURAL'/                                               MIS02870     &   T8,'A             :',T27,F8.3/T8,'R ALPHA       :',T27,F8.3/   MIS02880     &   T8,'X ALPHA       :',T27,F8.3/T8,'GAMA H        :',T27,F8.3/   MIS02890     &   T8,'ZETAS         :',T27,F8.3/T6,'TUNING          :',T34,A1)   MIS02900C                                                                       MIS02910      RETURN                                                            MIS02920      END                                                               MIS02930C                                                                       MIS02940C                                                                       MIS02950C                                                                       MIS02960      SUBROUTINE PARSE(STRNG,N)                                         MIS02970C                                                                       MIS02980C.....THIS SUBROUTINE READS VARIABLE LENGTH CHARACTER STRINGS           MIS02990C                                                                       MIS03000      CHARACTER*1 SPOT                                                  MIS03010      CHARACTER*10 STRING                                               MIS03020      CHARACTER*(*) STRNG                                               MIS03030C                                                                       MIS03040      LONG = LEN(STRNG)                                                 MIS03050    5 READ(5,10) STRING                                                 MIS03060   10 FORMAT(T11,A10)                                                   MIS03070C     WRITE(6,10) STRING                                                MIS03080C                                                                       MIS03090      DO 20 K=1,10                                                      MIS03100      SPOT = STRING(K:K)                                                MIS03110      IF (SPOT.NE.' ') GO TO 22                                         MIS03120
   20 CONTINUE                                                          MIS03130   22 CONTINUE                                                          MIS03140      IF (LONG.EQ.1) GO TO 30                                           MIS03150C                                                                       MIS03160      DO 24 K1=1,10                                                     MIS03170      M = 11-K1                                                         MIS03180      SPOT = STRING(M:M)                                                MIS03190      IF (SPOT.NE.' ') GO TO 26                                         MIS03200   24 CONTINUE                                                          MIS03210C                                                                       MIS03220   26 LG = M-K+1                                                        MIS03230      IF (LG.NE.LONG) K = M-N+1                                         MIS03240C                                                                       MIS03250   30 L = K+N-1                                                         MIS03260      STRNG = STRING(K:L)                                               MIS03270      RETURN                                                            MIS03280      END                                                               MIS03290C                                                                       MIS03300C                                                                       MIS03310C                                                                       MIS03320      SUBROUTINE RBGNEW                                                 MIS03330C                                                                       MIS03340C.....THIS SUBROUTINE GENERATES RANDOM NUMBERS USING THE IMSL LIBRARY   MIS03350C     ROUTINE "GGNML"     08/26/87/RA                                   MIS03360C                                                                       MIS03370      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS03380      REAL*4 RX                                                         MIS03390C                                                                       MIS03400C     COMMON/IPARAM/GAS(60),GHS(60),ZAS(60),ZHS(60),DUM(9)              MIS03410      COMMON /AERO1/ XNB, XK, XI, A, SC, XMU, XRA, XA, W0, WD1, AMACH   MIS03420      COMMON /STRUC1/ GAS(60), GHS(60), ZAS(60), ZHS(60)                MIS03430      COMMON/PARAM/NB                                                   MIS03440C                                                                       MIS03450      DIMENSION RX(60)                                                  MIS03460      DOUBLE PRECISION DSEED                                            MIS03470      DATA RX/60*0./                                                    MIS03480C                                                                       MIS03490      BACKSPACE 5                                                       MIS03500      READ(5,5) SEED,XM,SIG                                             MIS03510
    5 FORMAT(T21,3F10.4)                                                MIS03520      DSEED = SEED                                                      MIS03530      WRITE(6,9005) SEED,XM,SIG                                         MIS03540 9005 FORMAT(' RANDOM PARAMETERS: '/                                    MIS03550     &'  SEED =',F9.4,'  POPULATION MEAN =',F8.4,'  STD. DEV =',F8.4/)  MIS03560C                                                                       MIS03570      CALL GGNML(DSEED,NB,RX)                                           MIS03580C                                                                       MIS03590      TOT2=0.                                                           MIS03600      TOT=0.                                                            MIS03610      GASMX=0.0                                                         MIS03620      GASMN=10.0                                                        MIS03630      IMIN=0                                                            MIS03640      IMAX=0                                                            MIS03650      DO 10 I=1,NB                                                      MIS03660      GAS(I)=XM+RX(I)*SIG                                               MIS03670      IF(GAS(I).LT.GASMX) GO TO 150                                     MIS03680      GASMX=GAS(I)                                                      MIS03690      IMAX=I-1                                                          MIS03700150   IF(GAS(I).GT.GASMN) GO TO 170                                     MIS03710      GASMN=GAS(I)                                                      MIS03720      IMIN=I-1                                                          MIS03730170   TOT2=TOT2+GAS(I)*GAS(I)                                           MIS0374010    TOT=TOT+GAS(I)                                                    MIS03750      XNB=DFLOAT(NB)                                                    MIS03760      XME=TOT/XNB                                                       MIS03770      SIGE=(TOT2-TOT*TOT/XNB)/(XNB-1)                                   MIS03780      SIGE=DSQRT(SIGE)                                                  MIS03790C                                                                       MIS03800      WRITE(6,900) (GAS(I),I=1,10)                                      MIS03810      WRITE(6,905) XME,SIGE                                             MIS03820      WRITE(6,910) IMAX,GASMX,IMIN,GASMN                                MIS03830  900 FORMAT(' BLADE FREQUENCIES: '/6(1H ,10F8.4))                      MIS03840  905 FORMAT(' SAMPLE: MEAN=',G12.5,'  SD=',G12.5)                      MIS03850  910 FORMAT(' BLADE',I4,' HAS MAX FREQ OF',G12.5/' BLADE',I4,' HAS MIN MIS03860     * FREQ OF',G12.5)                                                  MIS03870C                                                                       MIS03880      RETURN                                                            MIS03890      END                                                               MIS03900
C                                                                       MIS03910C                                                                       MIS03920C                                                                       MIS03930                                                                        MIS03940      SUBROUTINE SOLVR2                                                 MIS03950C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS03960C     $$                                                                MIS03970C                                                                       MIS03980C THE FUNCTION OF SOLVR2 IS TO SETUP AND SOLVE THE EIGENVALUE PROBLEM   MIS03990C AND TO SETUP AND SOLVE THE RESPONSE.  IT ALSO CALLS THE APPROPRIATE   MIS04000C OUTPUT ROUTINES                                                       MIS04010C                                                                       MIS04020C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS04030C     $$                                                                MIS04040      IMPLICIT REAL*8(A-H,O-Z)                                          MIS04050      COMPLEX*16 AS,AD,DS,I1,CDEXP,TPIN,EIDE,ERKSE,ERKS,EIGVT,EIGVL,EIGEMIS04060     *L,EIGEH,GKH,GKL,                                                  MIS04070     1 EIGE,PIEGE,YR,SUMY1,SUMY2,YRB,YRT,CZ,C4B4,EIGVL4,EIGVT4,PS,CDSQRTMIS04080     *,B,POR,EDGAF,AI,WA                                                MIS04090      COMPLEX*8 S4B4,SIGVL4,SIGVT4,SIGVL,SIGVT                          MIS04100      CHARACTER*4 RI                                                    MIS04110      CHARACTER*2 OPT                                                   MIS04120      CHARACTER*1 FLAG, TUNE                                            MIS04130      REAL*8 MU,NU                                                      MIS04140      REAL*4 ZD                                                         MIS04150      COMMON/MATS/AS(60,4),AD(60,2),DS(60,4),GKH(60),GKL(60)            MIS04160      COMMON/PARAM/NB                                                   MIS04170      COMMON/ODAT/EIGVL(120),EIGVT(120,120)                             MIS04180C                                                                       MIS04190C     COMMON/IPARAM/XDUMY(240),XK,YDUMY(8)                              MIS04200      COMMON /AERO1/ XNB, XK, XI, A, SC, XMU, XRA, XA, W0, WD1, AMACH   MIS04210      COMMON /STRUC1/ GAS(60), GHS(60), ZAS(60), ZHS(60)                MIS04220      COMMON /RID/ RI(10), TUNE                                         MIS04230C                                                                       MIS04240      DIMENSION EIDE(120,120),WK(240),EDGAF(120,120),AI(120,120),WA(1464MIS04250     *0),WK2(120),ZD(10),ND(10)                                         MIS04260      DIMENSION EIGE(120,120),PIEGE(120,120),YR(120),YRB(60),YRT(60),C4BMIS04270     *4(4,4),EIGVL4(4),EIGVT4(4,4)                                      MIS04280      DIMENSION IC(4),JC(4)                                             MIS04290
      DIMENSION S4B4(4,4),SIGVL4(4),SIGVT4(4,4),SIGVL(120),SIGVT(120,120MIS04300     *)                                                                 MIS04310C                                                                       MIS04320      ITIME = 0                                                         MIS04330C                                                                       MIS0434040    CONTINUE                                                          MIS04350C     WRITE(6,900)                                                      MIS04360C900  FORMAT(/' **SOLVR2**'/)                                           MIS04370      GAMFO=0.D0                                                        MIS05260      I1=DCMPLX(0.D0,1.D0)                                              MIS04380      CZ=DCMPLX(0.D0,0.D0)                                              MIS04390      PRZ=1.D-8                                                         MIS04400      XNB=NB                                                            MIS04410      NB2=NB*2                                                          MIS04420      TPIN=6.283185308D0*I1/XNB                                         MIS04430      DO 60 IRR=1,NB                                                    MIS04440      IR=IRR-1                                                          MIS04450      XR=IR                                                             MIS04460      I=2*IR+1                                                          MIS04470      IP1=I+1                                                           MIS04480      DO 50 ISS=1,NB                                                    MIS04490      IS=ISS-1                                                          MIS04500      XS=IS                                                             MIS04510      J=2*IS+1                                                          MIS04520      JP1=J+1                                                           MIS04530      EIDE(I,J)=DCMPLX(0.D0,0.D0)                                       MIS04540      EIDE(I,JP1)=DCMPLX(0.D0,0.D0)                                     MIS04550      EIDE(IP1,J)=DCMPLX(0.D0,0.D0)                                     MIS04560      EIDE(IP1,JP1)=DCMPLX(0.D0,0.D0)                                   MIS04570      EIGEH=0.                                                          MIS04580      EIGEL=0.                                                          MIS04590      DO 49 K=1,NB                                                      MIS04600      XKK=K-1                                                           MIS04610      ERKSE=TPIN*XKK*(XS-XR)                                            MIS04620      ERKS=CDEXP(ERKSE)                                                 MIS04630      EIDE(I,J)=EIDE(I,J)+DS(K,1)*ERKS                                  MIS04640      EIDE(I,JP1)=EIDE(I,JP1)+DS(K,2)*ERKS                              MIS04650      EIDE(IP1,J)=EIDE(IP1,J)+DS(K,3)*ERKS                              MIS04660      EIGEH=EIGEH+ERKS/GKH(K)                                           MIS04670
      EIGEL=EIGEL+ERKS/GKL(K)                                           MIS0468049    EIDE(IP1,JP1)=EIDE(IP1,JP1)+DS(K,4)*ERKS                          MIS04690      EIDE(I,J)=EIDE(I,J)/XNB+EIGEH*AS(ISS,1)/XNB                       MIS04700      EIDE(I,JP1)=EIDE(I,JP1)/XNB+EIGEH*AS(ISS,2)/XNB                   MIS04710      EIDE(IP1,J)=EIDE(IP1,J)/XNB+EIGEL*AS(ISS,3)/XNB                   MIS04720      EIGE(I,J)=EIGEH/XNB                                               MIS04730      EIGE(I,JP1)=0.D0                                                  MIS04740      EIGE(IP1,J)=0.D0                                                  MIS04750      EIGE(IP1,JP1)=EIGEL/XNB                                           MIS0476050    EIDE(IP1,JP1)=EIDE(IP1,JP1)/XNB+EIGEL*AS(ISS,4)/XNB               MIS0477060    CONTINUE                                                          MIS0478061    CONTINUE                                                          MIS04790      DO 65 I=1,NB2                                                     MIS04800      DO 65 J=1,NB2                                                     MIS04810      EIGVT(I,J)=0.D0                                                   MIS0482065    EDGAF(I,J)=EIDE(I,J)                                              MIS04830      IJOB=1                                                            MIS04840      I120=120                                                          MIS04850C                                                                       MIS04860C     WRITE(6,789)                                                      MIS04870C 789 FORMAT(' 4X4 SOLUTIONS?-')                                        MIS04880C                                                                       MIS04890C.....READ CODE FOR 4X4 SOLUTION                                        MIS04900C.....1 FOR TUNED OR ALTERNATING MISTUNING                              MIS04910C.....0 FOR ALL OTHERS                                                  MIS04920C                                                                       MIS04930C     IF (ITIME.EQ.0) READ (5,9000) IANS                                MIS04940C9000 FORMAT(T16,I5)                                                    MIS04950      IANS = 0                                                          MIS04960C     WRITE(6,9020) TUNE                                                MIS04970C9020 FORMAT(' TUNING OPTION =',A1)                                     MIS04980      IF (TUNE.EQ.'T'.OR.TUNE.EQ.'A') IANS = 1                          MIS04990C     WRITE(6,9002) IANS                                                MIS05000C9002 FORMAT(' FLAG FOR 4X4 SOLUTIONS =',I3)                            MIS05010C                                                                       MIS05020      IF(IANS.GE.1) GO TO 799                                           MIS05030C     WRITE(6,901)                                                      MIS05040C901  FORMAT(' ** ENTERING EIGCC **')                                   MIS05050C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS05060
C     $$                                                                MIS05070C EXTRACT EIGENVALUES AND EIGENVECTORS FOR 2*NB BY 2*NB PROBLEM         MIS05080C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS05090C     $$                                                                MIS05100      CALL EIGCC(EIDE,NB2,I120,IJOB,EIGVL,EIGVT,I120,WK,IER)            MIS05110C     WRITE(6,902)IER                                                   MIS05120C902  FORMAT(' ** LEAVING EIGCC **',I5)                                 MIS05130                                                                        MIS05140C                                                                       MIS05150C CALL OUTPUT ROUTINE                                                   MIS05160      CALL ODAT2(ITIME)                                                 MIS05170   67 CONTINUE                                                          MIS05180C                                                                       MIS05190 8998 READ(5,8999) FLAG                                                 MIS05200 8999 FORMAT(A1)                                                        MIS05210      IF (FLAG.EQ.'$') GO TO 8998                                       MIS05220      BACKSPACE 5                                                       MIS05230      CALL PARSE(OPT,2)                                                 MIS05240C                                                                       MIS05250      ITIME = 1                                                         MIS05270      IF (OPT.EQ.' F') GO TO 68                                         MIS05280      BACKSPACE 5                                                       MIS05290      IF (OPT.EQ.' K') THEN                                             MIS05300        PRINT*,' '                                                      MIS05310        PRINT*,' ** NEW REDUCED FREQUENCY OPTION CHOSEN **'             MIS05320        READ(5,9070) XK                                                 MIS05330        GOTO 9075                                                       MIS05340        ENDIF                                                           MIS05350      IF (OPT.EQ.' M') THEN                                             MIS05360        PRINT*,' '                                                      MIS05370        PRINT*,' ** NEW MACH NUMBER OPTION CHOSEN **'                   MIS05380        READ(5,9070) AMACH                                              MIS05390        GOTO 9075                                                       MIS05400        ENDIF                                                           MIS05410      IF (OPT.EQ.'KM') THEN                                             MIS05420        PRINT*,' '                                                      MIS05430        PRINT*,' * NEW REDUCED FREQUENCY & MACH NUMBER OPTION CHOSEN *' MIS05440        READ(5,9070) AMACH,XK                                           MIS05450        GOTO 9075                                                       MIS05460
        ENDIF                                                           MIS05470 9070 FORMAT(20X,4F10.5)                                                MIS05480C                                                                       MIS05490      IF (OPT.EQ.' E') THEN                                             MIS05500         PRINT*,' '                                                     MIS05510         PRINT*,'*** MISER BATCH CONCLUDED ***'                         MIS05520         STOP                                                           MIS05530      ENDIF                                                             MIS05540C                                                                       MIS05550      PRINT*,' UNFORTUNATELY, YOU HAVE RUN OUT OF OPTIONS'              MIS05560      STOP                                                              MIS05570C                                                                       MIS05580C     READ (5,*) XK                                                     MIS05590C                                                                       MIS05600C     ID = INT(XK)                                                      MIS05610C     GAMFO=0.D0                                                        MIS05620C     IF(ND(3).NE.-1) GO TO 71                                          MIS05630C     YDUMY(8)=ZD(1)                                                    MIS05640C     XK=ZD(2)/ZD(1)                                                    MIS05650C     GO TO 73                                                          MIS0566071    CONTINUE                                                          MIS05670C     IF(ID.EQ.-2)GO TO 61                                              MIS05680C     IF(ID.LT.0)GO TO 68                                               MIS05690C                                                                       MIS05700C.....RECALCULATE A MATRIX WITH NEW  K AND/OR M                         MIS05710C                                                                       MIS05720 9075 WRITE(6,820) AMACH,XK                                             MIS05730820   FORMAT('  M=',G12.5,' K=',G12.5)                                  MIS0574073    CALL ADMAT                                                        MIS05750      GO TO 40                                                          MIS05760C                                                                       MIS05770C.....SETUP RESPONSE PROBLEM                                            MIS05780C                                                                       MIS05790   68 CONTINUE                                                          MIS05800      BACKSPACE 5                                                       MIS05810      READ (5,9070) FB,FE,FI,RIRR                                       MIS05820      IRR = INT(RIRR)                                                   MIS05830      WRITE(6,9071) FB,FE,FI,IRR                                        MIS05840 9071 FORMAT(//////T1,'*** ENTERING FORCED RESPONSE OPTION ***'/        MIS05850
     *        3X,'START FREQ  :',F8.5/3X,'END FREQ    :',F8.5/          MIS05860     *        3X,'DELTA FREQ  :',F8.5/3X,'PHASE INDEX :',5X,I3/)        MIS05870C                                                                       MIS05880      IF(FB.LE.0)RETURN                                                 MIS05890      FREQ=FB-FI                                                        MIS0590072    FREQ=FREQ+FI                                                      MIS05910      IF(FREQ.GT.FE)GO TO 67                                            MIS05920      GAMF=1.D0/(FREQ**2)-GAMFO                                         MIS05930      PRINT*,' '                                                        MIS05940      CALL TIME                                                         MIS05950      WRITE(6,436) IRR,FREQ                                             MIS05960436   FORMAT(' PHASE ANGLE INDEX = ',I3,3X,' FREQUENCY = ',G14.7)       MIS05970      GAMFO=GAMF+GAMFO                                                  MIS05980      DO 69 I=1,NB2                                                     MIS05990      DO 69 J=1,NB2                                                     MIS0600069    AI(I,J)=0.D0                                                      MIS06010      DO 70 I=1,NB2                                                     MIS06020      AI(I,I)=1.D0                                                      MIS0603070    EDGAF(I,I)=EDGAF(I,I)-GAMF                                        MIS06040      IJOB=0                                                            MIS06050C     WRITE(6,911)                                                      MIS06060911   FORMAT(' ** ENTERING LEQ2C **')                                   MIS06070C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS06080C     $$                                                                MIS06090C INVERT LEFT HAND SIDE                                                 MIS06100C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS06110C     $$                                                                MIS06120      CALL LEQ2C(EDGAF,NB2,I120,AI,NB2,I120,IJOB,WA,WK2,IER)            MIS06130C     WRITE(6,912)IER                                                   MIS06140912   FORMAT(' ** LEAVING LEQ2C **',I5)                                 MIS06150      DO 80 I=1,NB2                                                     MIS06160      DO 80 J=1,NB2                                                     MIS06170      PIEGE(I,J)=0.D0                                                   MIS06180      DO 80 K=1,NB2                                                     MIS0619080    PIEGE(I,J)=PIEGE(I,J)+AI(I,K)*EIGE(K,J)                           MIS0620084    CONTINUE                                                          MIS0621083    CONTINUE                                                          MIS06220C     WRITE(6,811)IRR                                                   MIS06230C 811 FORMAT(///,' R=',I3)                                              MIS06240
      IR=IRR+1                                                          MIS06250      IF(IRR.LT.0)GO TO 67                                              MIS06260      IRP=2*IRR+1                                                       MIS06270      IRP1=IRP+1                                                        MIS06280      DO 85 I=1,NB2                                                     MIS0629085    YR(I)=-PIEGE(I,IRP)*AD(IR,1)-PIEGE(I,IRP1)*AD(IR,2)               MIS06300      SUMY1=0.D0                                                        MIS06310      SUMY2=0.D0                                                        MIS06320      DO 86 I=1,NB                                                      MIS06330      IB=2*I-1                                                          MIS06340      IT=IB+1                                                           MIS06350      YRB(I)=YR(IB)                                                     MIS06360      YRT(I)=YR(IT)                                                     MIS06370      SUMY1=SUMY1+YR(IB)                                                MIS0638086    SUMY2=SUMY2+YR(IT)                                                MIS06390C     WRITE(6,943)SUMY1,SUMY2                                           MIS06400943   FORMAT(' BLADE 0 DEFLECTION , H AND ALPHA ',4G12.5)               MIS06410      WRITE(6,944)                                                      MIS06420944   FORMAT(' $$ BENDING')                                             MIS06430      CALL ASPLT(YRB)                                                   MIS06440      WRITE(6,945)                                                      MIS06450945   FORMAT(' $$ TORSION')                                             MIS06460      CALL ASPLT(YRT)                                                   MIS06470      GO TO 72                                                          MIS06480C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS06490C     $$                                                                MIS06500C EXTRACT EIGENVALUES FOR 4X4 SOLUTIONS                                 MIS06510C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS06520C     $$                                                                MIS06530799   N4=4                                                              MIS06540      NBH=NB/2                                                          MIS06550      IL=0                                                              MIS06560      EIGVL4(3)=1.D0                                                    MIS06570      EIGVL4(4)=1.D0                                                    MIS06580      DO 800 I=1,NB,2                                                   MIS06590      IC(1)=I                                                           MIS06600      IC(2)=I+1                                                         MIS06610      IC(3)=I+NB                                                        MIS06620      IC(4)=IC(3)+1                                                     MIS06630
      JC(1)=I                                                           MIS06640      JC(2)=IC(2)                                                       MIS06650      JC(3)=IC(3)                                                       MIS06660      JC(4)=IC(4)                                                       MIS06670      DO 805 I4=1,4                                                     MIS06680      IC4=IC(I4)                                                        MIS06690      DO 805  J4=1,4                                                    MIS06700      JC4=JC(J4)                                                        MIS06710      C4B4(I4,J4)=EIDE(IC4,JC4)                                         MIS06720      EIGVT4(I4,J4)=0.D0                                                MIS06730805   CONTINUE                                                          MIS06740      IF(IANS.EQ.1)GO TO 806                                            MIS06750      B=(C4B4(2,2)+C4B4(4,4))/2.D0                                      MIS06760      POR=CDSQRT(B**2+C4B4(2,4)*C4B4(4,2)-C4B4(2,2)*C4B4(4,4))          MIS06770      EIGVL4(2)=B+POR                                                   MIS06780      EIGVL4(4)=B-POR                                                   MIS06790      EIGVT4(2,2)=1.D0                                                  MIS06800      EIGVT4(4,2)=(C4B4(2,2)-EIGVL4(2))/C4B4(2,4)                       MIS06810      EIGVT4(2,4)=(C4B4(4,4)-EIGVL4(4))/C4B4(4,2)                       MIS06820      EIGVT4(4,4)=1.D0                                                  MIS06830      EIGVL4(1)=C4B4(1,1)                                               MIS06840      EIGVT4(1,1)=1.D0                                                  MIS06850      EIGVL4(3)=C4B4(3,3)                                               MIS06860      EIGVT4(3,3)=1.D0                                                  MIS06870      GO TO 808                                                         MIS06880806   CALL EIGCC(C4B4,N4,N4,IJOB,EIGVL4,EIGVT4,N4,WK,IER)               MIS06890808   CONTINUE                                                          MIS06900      DO 807 I4=1,4                                                     MIS06910      IL=IL+1                                                           MIS06920      EIGVL(IL)=EIGVL4(I4)                                              MIS06930      DO 807 IVT=1,4                                                    MIS06940      IIL=I                                                             MIS06950      IF(IVT.EQ.2)IIL=I+1                                               MIS06960      IF(IVT.EQ.3)IIL=I+NB                                              MIS06970      IF(IVT.EQ.4)IIL=I+NB+1                                            MIS06980      EIGVT(IIL,IL)=EIGVT4(IVT,I4)                                      MIS06990807   CONTINUE                                                          MIS07000800   CONTINUE                                                          MIS07010      CALL ODAT2(ITIME)                                                 MIS07020
      GO TO 67                                                          MIS07030      END                                                               MIS07040C                                                                       MIS07050C                                                                       MIS07060C                                                                       MIS07070      SUBROUTINE ODAT2(ITIME)                                           MIS07080C                                                                       MIS07090C.....THIS SUBROUTINE CONVERTS THE EIGENVALUES AND EIGENVECTORS INTO    MIS07100C.....FREQUENCIES, DAMPINGS, AND PHYSICAL BLADE DEFLECTIONS             MIS07110C                                                                       MIS07120      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS07130      COMPLEX*16 EIGVL,EIGVT,II,P1,PS,CDSQRT,YR,YRB,YRT,SUMY1,SUMY2     MIS07140      REAL*4 FREQ,DAMP,ZD,FR,DA,BPM,DELB,XPMIN,XPMAX,Y                  MIS07150     *       PMIN,YPMAX,ANG(120)                                        MIS07160      COMMON/ODAT/EIGVL(120),EIGVT(120,120)                             MIS07170      COMMON/PARAM/NB                                                   MIS07180      COMMON /RID/ RI(10), TUNE                                         MIS07190      COMMON/PLMXMN/XPMIN,XPMAX,YPMIN,YPMAX                             MIS07200      DIMENSION DAMP(120),CHAR(1),FREQ(120),XMP(120),DTIT(1),FTIT(1),YR(MIS07210     *120),ZD(10),ND(10),IVARS(7),IR(120)                               MIS07220      DIMENSION YRB(60),YRT(60),TITL(6)                                 MIS07230      CHARACTER*4  DTIT,FTIT,TITL,RI                                    MIS07240      CHARACTER*1  FLAG,OUTPT,RLP                                       MIS07250C                                                                       MIS07260      XNB=NB                                                            MIS07270      NB2=NB*2                                                          MIS07280      DELB=360.D0/XNB                                                   MIS07290      II=DCMPLX(0.D0,1.D0)                                              MIS07300      XPMIN=-1.E6                                                       MIS07310      XPMAX=1.E6                                                        MIS07320      YPMIN=-1.E6                                                       MIS07330      YPMAX=1.E6                                                        MIS07340      WRITE(6,948)RI                                                    MIS07350948   FORMAT(2X,10A4/)                                                  MIS07360C                                                                       MIS07370    5 CONTINUE                                                          MIS07380      IF (ITIME.EQ.0) THEN                                              MIS07390 8998    READ(5,8999) FLAG                                              MIS07400 8999    FORMAT(A1)                                                     MIS07410
         IF (FLAG.EQ.'$') GO TO 8998                                    MIS07420         BACKSPACE 5                                                    MIS07430         CALL PARSE(OUTPT,1)                                            MIS07440      ENDIF                                                             MIS07450C                                                                       MIS07460      DAMPC=-1.D6                                                       MIS07470      IF (OUTPT.EQ.'L') WRITE(6,90)                                     MIS0748090    FORMAT(//,7X,'MU',13X,'NU',7X,'PM',5X,'BRPM')                     MIS07490      DO 10 I=1,NB2                                                     MIS07500      P1=1.D0/EIGVL(I)                                                  MIS07510      PS=CDSQRT(P1)                                                     MIS07520      DAMP(I)=II*PS                                                     MIS07530      FREQ(I)=PS                                                        MIS07540      FREQ(I)=ABS(FREQ(I))                                              MIS07550      XMAX=-1.D0                                                        MIS07560      DO 20 K=1,NB2                                                     MIS07570      YR(K)=EIGVT(K,I)                                                  MIS07580      XMP(K)=CDABS(EIGVT(K,I))                                          MIS07590      IF(XMP(K).LT.XMAX)GO TO 20                                        MIS07600      IM=K                                                              MIS07610      XMAX=XMP(K)                                                       MIS0762020    CONTINUE                                                          MIS07630      IR(I)=IM-1                                                        MIS07640      IF(DAMP(I).GT.DAMPC)IDC=I                                         MIS07650      RDC=IR(I)/2                                                       MIS07660      BPM=RDC*DELB                                                      MIS07670      ANG(I) = BPM                                                      MIS07680      IF(BPM.GT.180)BPM=BPM-360.                                        MIS07690      IF(DAMP(I).GT.DAMPC)DAMPC=DAMP(I)                                 MIS07700      IF(OUTPT.EQ.'L') WRITE(6,100) DAMP(I),FREQ(I),IR(I),BPM           MIS07710100   FORMAT(2(2X,G12.5),2X,I3,2X,F6.1)                                 MIS07720      DO 30 K=1,NB2                                                     MIS07730      IF(K.EQ.IM)GO TO 30                                               MIS07740      PP=XMP(K)/XMAX                                                    MIS07750      IF(PP.LT..5D0)GO TO 30                                            MIS07760      IROC=K-1                                                          MIS07770      IF(OUTPT.EQ.'L') WRITE(6,110) IROC,PP                             MIS07780110   FORMAT(2X,I3,2X,F5.2)                                             MIS0779030    CONTINUE                                                          MIS07800
10    CONTINUE                                                          MIS07810      IRDC=IR(IDC)/2                                                    MIS07820      RDC=IRDC                                                          MIS07830      BPM=RDC*DELB                                                      MIS07840      WRITE(6,602)DAMP(IDC),FREQ(IDC),IR(IDC),BPM                       MIS07850602   FORMAT(/,'  MOST UNSTABLE MODE',/,' MU=',G12.5,' NU=',G12.5,' PRINMIS07860     *CIPAL AERO MODE',I3,                                              MIS07870     1 2X,'(',F6.1,' DEG)')                                             MIS07880      CALL TIME                                                         MIS07890C                                                                       MIS07900   39 CONTINUE                                                          MIS07910      IF (ITIME.EQ.0) THEN                                              MIS07920 9000    READ(5,8999) FLAG                                              MIS07930         IF (FLAG.EQ.'$') GO TO 9000                                    MIS07940         BACKSPACE 5                                                    MIS07950         CALL PARSE(RLP,1)                                              MIS07960      ENDIF                                                             MIS07970C                                                                       MIS07980      IF (RLP.EQ.'N') RETURN                                            MIS07990      CALL RLPLT(NB2,ANG,DAMP,FREQ)                                     MIS08000      RETURN                                                            MIS08010      END                                                               MIS08020C                                                                       MIS08030C                                                                       MIS08040C                                                                       MIS08050      SUBROUTINE ADMAT                                                  MIS08060C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08070C                                                                       MIS08080C THE FUNCTION OF ADMAT IS TO ASSEMBLE THE A AND D MATRICES             MIS08090C THIS IS THE ORIGINAL VERSION                                          MIS08100C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08110      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS08120      REAL*4 ZD                                                         MIS08130      COMPLEX*16 I1,CML,CFL,CMQ,CFQ,CC,E1,EE1,CDEXP,CFQE,CFLE,CFWE,CMQE,MIS08140     *CMLE,CMWE,                                                        MIS08150     1 LHH,LHL,LWH,LLH,LLL,LLW,GKH,GKL,AS,AD,DS,CFW,CMW,DCONJG          MIS08160      DIMENSION CC(2,3),ZD(10),ND(10)                                   MIS08170C                                                                       MIS08180C     COMMON/IPARAM/GAS(60),GHS(60),ZAS(60),ZHS(60),XK,XI,A,SC,XMU,XRA,XMIS08190
C    *A,W0,AMACH                                                        MIS08200      COMMON /AERO1/ XNB, XK, XI, A, SC, XMU, XRA, XA, W0, WD1, AMACH   MIS08210      COMMON /STRUC1/ GAS(60), GHS(60), ZAS(60), ZHS(60)                MIS08220C                                                                       MIS08230      COMMON/PARAM/NB                                                   MIS08240      COMMON/MATS/AS(60,4),AD(60,2),DS(60,4),GKH(60),GKL(60)            MIS08250      COMMON/GENB/XL,XIW,ETAW,SCW,CHIPW                                 MIS08260      ZERO=0.D0                                                         MIS08270      ONE=1.D0                                                          MIS08280      TWO=2.D0                                                          MIS08290      I1=DCMPLX(ZERO,ONE)                                               MIS08300C     WRITE(6,900)                                                      MIS08310C900  FORMAT(' **ADMAT**')                                              MIS08320C                                                                       MIS08330      ID=1                                                              MIS08340      IF(XKWR.NE.XK)GO TO 5                                             MIS08350C                                                                       MIS08360C     WRITE(6,800)                                                      MIS08370C 800 FORMAT(' NEW TUNED AERO?-')                                       MIS08380C                                                                       MIS08390C.....0 FOR YES AND 1 FOR NO                                            MIS08400C                                                                       MIS08410C     READ (6,*) ID                                                     MIS08420C     IF(ID.EQ.0)GO TO 700                                              MIS08430                                                                        MIS084405     XKWR=XK                                                           MIS08450      ONEM=-1.D0                                                        MIS08460      FOUR=4.D0                                                         MIS08470      XL=TWO*XK                                                         MIS08480      XIW=XI                                                            MIS08490      ETA=(ONE+A)/TWO                                                   MIS08500      E1=I1*XL*ETA                                                      MIS08510      EE1=CDEXP(E1)                                                     MIS08520      SCW=SC                                                            MIS08530      NB2=2*NB                                                          MIS08540      NMAX=8                                                            MIS08550      XNB=NB                                                            MIS08560      TNB=6.283185308D0/XNB                                             MIS08570      DO 100 I=1,NB                                                     MIS08580
      DO 99 J=1,4                                                       MIS08590      AS(I,J)=ZERO                                                      MIS0860099    DS(I,J)=ZERO                                                      MIS08610      DO 100 J=1,2                                                      MIS08620100   AD(I,J)=ZERO                                                      MIS08630      DO 200 I=1,NB                                                     MIS08640      XIM1=I-1                                                          MIS08650      BETA=TNB*XIM1                                                     MIS08660      IF(AMACH.LT.ONE)GO TO 10                                          MIS08670C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08680C SUPERSONIC                                                            MIS08690C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08700      CALL SSCASC(ZERO,ONE,ZERO,ZERO,BETA,LHH,LLH)                      MIS08710      CALL SSCASC(ONE,ZERO,ZERO,ZERO,BETA,LHL,LLL)                      MIS08720      GL=XK                                                             MIS08730      CALL SSCASC(ZERO,ZERO,ONE,GL,BETA,LWH,LLW)                        MIS08740      LHH=-DCONJG(LHH)                                                  MIS08750      LLH=-DCONJG(LLH)                                                  MIS08760      LHL=-DCONJG(LHL)                                                  MIS08770      LLL=-DCONJG(LLL)                                                  MIS08780      LWH=DCONJG(LWH)                                                   MIS08790      LLW=DCONJG(LLW)                                                   MIS08800      GO TO 11                                                          MIS08810C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08820C INCOMPRESSIBLE                                                        MIS08830C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS0884010    IF(AMACH.LT.0.D0)CALL WHEAD(BETA,CC,NMAX)                         MIS08850C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08860C SUBSONIC                                                              MIS08870C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    MIS08880      IF(AMACH.GE.0.D0)CALL RAO(AMACH,BETA,CC)                          MIS08890      CFQ=CC(1,1)                                                       MIS08900      CFL=CC(1,2)                                                       MIS08910      CMQ=CC(2,1)                                                       MIS08920      CML=CC(2,2)                                                       MIS08930      CFW=-CC(1,3)                                                      MIS08940      CMW=-CC(2,3)                                                      MIS08950      CFQE=CFQ                                                          MIS08960      CFLE=CFL-E1*CFQ                                                   MIS08970
      CFWE=EE1*CFW                                                      MIS08980      CMQE=CMQ-ETA*CFQ                                                  MIS08990      CMLE=CML-ETA*CFL-E1*CMQ+E1*ETA*CFQ                                MIS09000      CMWE=EE1*(CMW-ETA*CFW)                                            MIS09010      LHH=TWO*I1*CFQE/XK                                                MIS09020      LHL=TWO*CFLE/(XK*XK)                                              MIS09030      LWH=-TWO*CFWE/(XK*XKWR)                                           MIS09040      LLH=FOUR*I1*CMQE/XK                                               MIS09050      LLL=FOUR*CMLE/(XK*XK)                                             MIS09060      LLW=-FOUR*CMWE/(XK*XKWR)                                          MIS0907011    GKH(I)=XMU*GHS(I)*GHS(I)*(ONE+TWO*I1*ZHS(I))                      MIS09080      GKL(I)=XMU*XRA*XRA*GAS(I)*GAS(I)*(ONE+TWO*I1*ZAS(I))              MIS09090      AS(I,1)=LHH                                                       MIS09100      AS(I,2)=LHL                                                       MIS09110      AS(I,3)=LLH                                                       MIS09120      AS(I,4)=LLL                                                       MIS09130      AD(I,1)=LWH                                                       MIS09140      AD(I,2)=LLW                                                       MIS09150      DS(I,1)=XMU/GKH(I)                                                MIS09160      DS(I,2)=XA*DS(I,1)                                                MIS09170      DS(I,3)=XMU*XA/GKL(I)                                             MIS09180200   DS(I,4)=XMU*XRA*XRA/GKL(I)                                        MIS09190      RETURN                                                            MIS09200700   CONTINUE                                                          MIS09210      DO 750 I=1,NB                                                     MIS09220      GKH(I)=XMU*GHS(I)*GHS(I)*(ONE+TWO*I1*ZHS(I))                      MIS09230      GKL(I)=XMU*XRA*XRA*GAS(I)*GAS(I)*(ONE+TWO*I1*ZAS(I))              MIS09240      DS(I,1)=XMU/GKH(I)                                                MIS09250      DS(I,2)=XA*DS(I,1)                                                MIS09260      DS(I,3)=XMU*XA/GKL(I)                                             MIS09270750   DS(I,4)=XMU*XRA*XRA/GKL(I)                                        MIS09280      RETURN                                                            MIS09290      END                                                               MIS09300                                                                        MIS09310      SUBROUTINE ASPLT(YR)                                              MIS09320      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS09330      COMPLEX*16 AS,YR,II,E1,CDEXP                                      MIS09340      REAL*4 CHAR,ASAMP,ASFAZ,VARS,ZD,XX                                MIS09350      COMMON/PARAM/NB                                                   MIS09360
      DIMENSION YR(60),ZD(10),ASAMP(60),ASFAZ(60),PTIT(2),CHAR(1),ATIT(1MIS09370     *),VARS(10),IVARS(7),ND(10)                                        MIS09380      DIMENSION XX(60),BN(3)                                            MIS09390      CHARACTER*4  BN, PTIT, ATIT, AP, PZ                               MIS09400      DATA BN/'BLAD','E NU','MBER'/                                     MIS09410      DATA PTIT/'PHAS','E   '/                                          MIS09420      DATA ATIT/'AMP '/                                                 MIS09430      DATA AP/'AMP '/                                                   MIS09440      DATA PZ/'PHAZ'/                                                   MIS09450      RTD=57.3D0                                                        MIS09460      XNB=NB                                                            MIS09470      II=DCMPLX(0.D0,1.D0)                                              MIS09480      TPN=6.283185308D0/XNB                                             MIS09490      AMPMAX=0.D0                                                       MIS09500      DO 87 J=1,NB                                                      MIS09510      IS=J-1                                                            MIS09520      XS=IS                                                             MIS09530      AS=0.D0                                                           MIS09540      DO 86 K=1,NB                                                      MIS09550      IR=K-1                                                            MIS09560      XR=IR                                                             MIS09570      E1=TPN*II*XS*XR                                                   MIS0958086    AS=AS+YR(K)*CDEXP(E1)                                             MIS09590      ASR=AS                                                            MIS09600      ASI=-AS*II                                                        MIS09610      CDAS=CDABS(AS)                                                    MIS09620      ASAMP(J)=CDAS                                                     MIS09630      IF(CDAS.GE.AMPMAX)IBMAX=IS                                        MIS09640      IF(CDAS.GE.AMPMAX)AMPMAX=ASAMP(J)                                 MIS0965087    ASFAZ(J)=DATAN2(ASI,ASR)*RTD                                      MIS09660C     WRITE(6,711)ASAMP(1),ASAMP(2)                                     MIS09670711   FORMAT(' BLADE 0 AMP = ',G12.5,'    BLADE 1 AMP = ',G12.5)        MIS09680      ASTOT=0.                                                          MIS09690      DO 88 I=1,NB                                                      MIS09700      ASTOT=ASTOT+ASAMP(I)                                              MIS09710      ASAMP(I)=ASAMP(I)/AMPMAX                                          MIS0972088    CONTINUE                                                          MIS09730      ASTOT=ASTOT/NB*1.0                                                MIS09740      WRITE(6,707)IBMAX,AMPMAX,ASTOT                                    MIS09750
707   FORMAT(' BLADE #',I3,'  HAS MAX AMPLITUDE OF',G12.5,'   AVG. AMP. MIS09760     *IS',G12.5)                                                        MIS09770C                                                                       MIS09780      RETURN                                                            MIS09790      END                                                               MIS09800C                                                                       MIS09810C                                                                       MIS09820C                                                                       MIS09830      SUBROUTINE WHEAD(BETA,C,NMAX)                                     MIS09840C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS09850C     $$$$$$                                                            MIS09860C                                                                       MIS09870C THE FUNCTION OF WHEAD IS TO CALCULATE THE UNSTEADY AERODYNAMIC        MIS09880C COEFFICIENTS USING THE THEORY PRESENTED BY WHITEHEAD.  SEE            MIS09890C "FORCE AND MOMENT COEFFICIENTS FOR VIBRATING AEROFOILS IN CASCADE",   MIS09900C R & M 3254, FEB 1960, THE COMPUTATIONAL METHOD USED BY WHEAD          MIS09910C IS EXPLICITLY PRESENTED IN APPENDIX IV OF THIS REPORT                 MIS09920C                                                                       MIS09930C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS09940C     $$$$$$                                                            MIS09950      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS09960      COMPLEX*16 B,C,VMZ,E1,D1,SUM1,XIK,AIB,AIBM,BIM,BI,                MIS09970     1 EVINT,AINVB,VFCTN,CDEXP,A,AI,WA                                  MIS09980      REAL*4 WK                                                         MIS09990      COMMON/GENB/XK,XI,ETA,SC,CHIP                                     MIS10000      COMMON/AAP/AIB,AIBM,PMB                                           MIS10010      COMMON/WSINV/A(20,20),AI(20,20),WA(440),WK(20)                    MIS10020      DIMENSION B(20,3),C(2,3),X(2,20),AINVB(20,3)                      MIS10030      ONE=1.D0                                                          MIS10040      TWO=2.D0                                                          MIS10050      PI=3.1415926536D0                                                 MIS10060      SA=DCOS(XI)/SC                                                    MIS10070      SB=DSIN(XI)/SC                                                    MIS10080      XN=NMAX                                                           MIS10090      XL2DP=.2206356D0                                                  MIS10100      PIN=PI/XN                                                         MIS10110      AIB=DCMPLX(SA,SB)                                                 MIS10120      AIBM=DCONJG(AIB)                                                  MIS10130      P5=.5D0                                                           MIS10140
      SUM1=DCMPLX(0.D0,0.D0)                                            MIS10150      XIK=DCMPLX(0.D0,XK)                                               MIS10160      PMB=PI-BETA                                                       MIS10170      DO 10 IR=1,20                                                     MIS10180      XR=IR-1                                                           MIS10190      TPR=TWO*PI*XR                                                     MIS10200      TPRB=TPR+BETA                                                     MIS10210      TPRMB=TPR-BETA                                                    MIS10220      D1=TPRB+XIK/AIB                                                   MIS10230      E1=-TPRB*AIB-XIK                                                  MIS10240      SUM1=SUM1+CDEXP(E1)/D1                                            MIS10250      IF(IR.EQ.1)GO TO 10                                               MIS10260      D1=TPRMB+XIK/AIBM                                                 MIS10270      E1=-TPRMB*AIBM-XIK                                                MIS10280      SUM1=SUM1+CDEXP(E1)/D1                                            MIS1029010    CONTINUE                                                          MIS10300      SUM1=P5*SUM1+XL2DP                                                MIS10310      DO 20 NR=1,NMAX                                                   MIS10320      XL=NR-1                                                           MIS10330      XM=XL                                                             MIS10340      PLN=PI*XL/XN                                                      MIS10350      X(1,NR)=ONE                                                       MIS10360      X(2,NR)=P5*(ONE-DCOS(PLN))                                        MIS10370      B(NR,1)=ONE                                                       MIS10380      T1=PI*(TWO*XM+ONE)/(TWO*XN)                                       MIS10390      CT1=DCOS(T1)                                                      MIS10400      BI=P5*XIK*(ONE-CT1)                                               MIS10410      B(NR,2)=ONE+BI                                                    MIS10420      BIM=-BI                                                           MIS10430      B(NR,3)=CDEXP(BIM)                                                MIS10440      DO 20 NC=1,NMAX                                                   MIS10450      XL=NC-1                                                           MIS10460      PLN=PI*XL/XN                                                      MIS10470      Z=P5*(CT1-DCOS(PLN))                                              MIS10480      ZM=-Z                                                             MIS10490      VMZ=VFCTN(ZM)                                                     MIS10500      SUM2=0.D0                                                         MIS10510      DO 19 IR=1,NMAX                                                   MIS10520      XR=IR                                                             MIS10530
      PLNR=PLN*XR                                                       MIS10540      T1R=T1*XR                                                         MIS10550      IF(IR.EQ.NMAX)XR=TWO*XR                                           MIS1056019    SUM2=SUM2+DCOS(T1R)*DCOS(PLNR)/XR                                 MIS10570      SUM2=SUM2/PI                                                      MIS10580      CALL CGI(Z)                                                       MIS10590      CALL CGAUSS(EVINT)                                                MIS10600      E1=XIK*Z                                                          MIS10610      A(NR,NC)=VMZ+XIK*CDEXP(E1)*(SUM1+SUM2-EVINT)                      MIS10620      AI(NR,NC)=0.D0                                                    MIS10630      IF(NR.EQ.NC)AI(NR,NC)=ONE                                         MIS1064020    CONTINUE                                                          MIS10650      IJOB=0                                                            MIS10660      I2=2                                                              MIS10670      I3=3                                                              MIS10680      I20=20                                                            MIS10690      CALL LEQ2C(A,NMAX,I20,AI,NMAX,I20,IJOB,WA,WK,IER)                 MIS10700      IF(IER.GT.128)WRITE(6,100)IER                                     MIS10710100   FORMAT(' ERROR IN INVERTING A; IER=',I10)                         MIS10720      CALL CMULT(AI,B,AINVB,NMAX,NMAX,I3)                               MIS10730      CALL RCMULT(X,AINVB,C,I2,NMAX,I3)                                 MIS10740      DO 30 NR=1,I2                                                     MIS10750      DO 30 NC=1,I3                                                     MIS1076030    C(NR,NC)=-C(NR,NC)/PI                                             MIS10770      RETURN                                                            MIS10780      END                                                               MIS10790                                                                        MIS10800      SUBROUTINE CGI(BA)                                                MIS10810C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$             MIS10820C                                                                       MIS10830C THE FUNCTION OF CGI IS TO DEFINE THE EIGHT GAUSSIAN                   MIS10840C INTEGRATION POINTS                                                    MIS10850C                                                                       MIS10860C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$             MIS10870      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS10880      COMMON/GIPTS/GP(8)                                                MIS10890      A=.5D0*(1.D0+BA)                                                  MIS10900      B=1.D0-BA                                                         MIS10910      C=.48014492824877D0*B                                             MIS10920
      GP(1)=A-C                                                         MIS10930      GP(8)=A+C                                                         MIS10940      C=.39833323870681D0*B                                             MIS10950      GP(2)=A-C                                                         MIS10960      GP(7)=A+C                                                         MIS10970      C=.26276620495816D0*B                                             MIS10980      GP(3)=A-C                                                         MIS10990      GP(6)=A+C                                                         MIS11000      C=.91717321247825D-1*B                                            MIS11010      GP(4)=A-C                                                         MIS11020      GP(5)=A+C                                                         MIS11030      RETURN                                                            MIS11040      END                                                               MIS11050                                                                        MIS11060      COMPLEX FUNCTION VFCTN*16(Z)                                      MIS11070C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$        MIS11080C                                                                       MIS11090C THE FUNCTION OF VFCTN IS TO DEFINE THE FUNCTION V(Z). SEE             MIS11100C R & M 3254, APPENDIX IV, EQUATION A1                                  MIS11110C                                                                       MIS11120C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$        MIS11130      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS11140      COMPLEX*16 AIB,AIBM,E1,E2,S1,S2,SS1,SS2,SINHI,CDEXP               MIS11150      COMMON/AAP/AIB,AIBM,PMB                                           MIS11160      PI=3.1415926536D0                                                 MIS11170      E1=-PMB*AIB*Z                                                     MIS11180      S1=PI*AIB*Z                                                       MIS11190      E2=PMB*AIBM*Z                                                     MIS11200      S2=PI*AIBM*Z                                                      MIS11210      SS1=SINHI(S1)                                                     MIS11220      SS2=SINHI(S2)                                                     MIS11230      VFCTN=.25D0*(AIB*CDEXP(E1)/SS1+AIBM*CDEXP(E2)/SS2)                MIS1124010    CONTINUE                                                          MIS11250      RETURN                                                            MIS11260      END                                                               MIS11270                                                                        MIS11280      SUBROUTINE CMULT(A,B,C,L,M,N)                                     MIS11290C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11300C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                      MIS11310
C                                                                       MIS11320C         THE FUNCTION OF CMULT IS TO PERFORM (A) X (B) = (C)           MIS11330C              (A) IS L X M  COMPLEX                                    MIS11340C              (B) IS M X N  COMPLEX                                    MIS11350C              (C) IS L X N  COMPLEX                                    MIS11360C                                                                       MIS11370C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11380C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                  MIS11390      COMPLEX*16 A,B,C                                                  MIS11400      DIMENSION A(20,20),B(20,3),C(20,3)                                MIS11410      DO 10 I=1,L                                                       MIS11420      DO 10 J=1,N                                                       MIS11430      C(I,J)=0.D0                                                       MIS11440      DO 10 K=1,M                                                       MIS1145010    C(I,J)=C(I,J)+A(I,K)*B(K,J)                                       MIS11460      RETURN                                                            MIS11470      END                                                               MIS11480                                                                        MIS11490      SUBROUTINE CGAUSS(Y)                                              MIS11500C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11510C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                  MIS11520C                                                                       MIS11530C         THE FUNCTION OF CGAUSS IS TO PERFORM AN EIGHT POINT GAUSSIAN IMIS11540C     NTEGRATION                                                        MIS11550C         OF THE INTEGRAL IN EQUATION A15 OF RTM 3254                   MIS11560C                                                                       MIS11570C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11580C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                  MIS11590      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS11600      COMPLEX*16 Y,EVFCT                                                MIS11610      COMMON/GIPTS/GP(8)                                                MIS11620      B=2.D0-GP(8)-GP(1)                                                MIS11630      Y=.50614268145188D-1*(EVFCT(8)+EVFCT(1))                          MIS11640      Y=Y+.11119051722669D0*(EVFCT(7)+EVFCT(2))                         MIS11650      Y=Y+.15685332293894D0*(EVFCT(6)+EVFCT(3))                         MIS11660      Y=B*(Y+.18134189168918D0*(EVFCT(5)+EVFCT(4)))                     MIS11670      RETURN                                                            MIS11680      END                                                               MIS11690                                                                        MIS11700
      COMPLEX FUNCTION EVFCT*16(I)                                      MIS11710C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11720C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                   MIS11730C                                                                       MIS11740C         THE FUNCTION OF EVFCT IS TO DEFINE THE FUNCTION TO BE INTEGRATMIS11750C     ED BY CGAUSS.                                                     MIS11760C         SEE THE INTEGRAL IN EQUATION A15 OF RTM 3254.                 MIS11770C                                                                       MIS11780C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11790C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                   MIS11800      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS11810      COMPLEX*16 XIK,E1,VFCTN,CDEXP                                     MIS11820      COMMON/GENB/XK,D1,D2,D3,D4                                        MIS11830      COMMON/GIPTS/GP(8)                                                MIS11840      XIK=DCMPLX(0.D0,XK)                                               MIS11850      Z=GP(I)                                                           MIS11860      E1=-XIK*Z                                                         MIS11870      ZZ=-Z                                                             MIS11880      EVFCT=CDEXP(E1)*VFCTN(ZZ)+.15915493D0/Z                           MIS1189010    CONTINUE                                                          MIS11900      RETURN                                                            MIS11910      END                                                               MIS11920                                                                        MIS11930      SUBROUTINE RCMULT(A,B,C,L,M,N)                                    MIS11940C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS11950C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                  MIS11960C                                                                       MIS11970C         THE FUNCTION OF RCMULT IS TO PERFORM (A) X (B) = (C)          MIS11980C              (A) IS L X M  REAL                                       MIS11990C              (B) IS M X N  COMPLEX                                    MIS12000C              (C) IS L X N  COMPLEX                                    MIS12010C                                                                       MIS12020C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS12030C     $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$                  MIS12040      REAL*8 A                                                          MIS12050      COMPLEX*16 B,C                                                    MIS12060      DIMENSION A(2,20),B(20,3),C(2,3)                                  MIS12070      DO 10 I=1,L                                                       MIS12080      DO 10 J=1,N                                                       MIS12090
      C(I,J)=0.D0                                                       MIS12100      DO 10 K=1,M                                                       MIS1211010    C(I,J)=C(I,J)+A(I,K)*B(K,J)                                       MIS12120      RETURN                                                            MIS12130      END                                                               MIS12140C                                                                       MIS12150C                                                                       MIS12160C                                                                       MIS12170C     SUBROUTINE DSTPLT                                                 MIS12180C     IMPLICIT REAL*8 (A-H,O-Z)                                         MIS12190C     REAL*4 ZD,X,Y                                                     MIS12200C     COMMON/PARAM/NB                                                   MIS12210C                                                                       MIS12220C     COMMON/IPARAM/GAS(60),GHS(60),ZAS(60),ZHS(60),DUM(9)              MIS12230C     COMMON /AERO1/ XNB, XK, XI, A, SC, XMU, XRA, XA, W0, WD1, AMACH   MIS12240C     COMMON /STRUC1/ GAS(60), GHS(60), ZAS(60), ZHS(60)                MIS12250C                                                                       MIS12260C     COMMON /RID/ RI(10), TUNE                                         MIS12270C     DIMENSION ZD(10),ND(10),X(60),Y(60),IVARS(7)                      MIS12280C     DIMENSION YT(2),YT1(4),BN(3)                                      MIS12290C     CHARACTER*4 BN,YT1,RI,YT                                          MIS12300C     DATA BN/'BLAD','E NU','MBER'/                                     MIS12310C     DATA YT1/'GAMM','A H ',' ZET','A A '/                             MIS12320C     IVARS(1)=7                                                        MIS12330C     IVARS(2)=NB                                                       MIS12340C     IVARS(3)=3                                                        MIS12350C     IVARS(4)=119                                                      MIS12360C     IVARS(5)=1                                                        MIS12370C     IVARS(6)=10                                                       MIS12380C     IVARS(7)=0                                                        MIS12390C   5 WRITE(6,100)                                                      MIS12400C 100 FORMAT('  PARAMETER PLOT',/,'  WHICH PARAMETER')                  MIS12410C     READ (5,*) IP                                                     MIS12420C     IF(IP.EQ.0) RETURN                                                MIS12430C     IF(IP.EQ.99)CALLINDAT2                                            MIS12440C     IF(IP.EQ.99)GO TO 4                                               MIS12450C     IF(IP.EQ.10)GO TO 300                                             MIS12460C     YT(1)=YT1(1)                                                      MIS12470C     YT(2)=YT1(2)                                                      MIS12480
C     IF(IP.EQ.2.OR.IP.EQ.4) YT(2)=YT1(4)                               MIS12490C     IF(IP.GE.3) YT(1)=YT1(3)                                          MIS12500C     DO 10 I=1,NB                                                      MIS12510C     X(I)=I-1                                                          MIS12520C     IF(IP.EQ.1)Y(I)=GHS(I)                                            MIS12530C     IF(IP.EQ.2)Y(I)=GAS(I)                                            MIS12540C     IF(IP.EQ.3)Y(I)=ZHS(I)                                            MIS12550C     IF(IP.EQ.4)Y(I)=ZAS(I)                                            MIS12560C  10 CONTINUE                                                          MIS12570C     CALL GPLOT(X,Y,IVARS)                                             MIS12580C     CALL TITLE(4,12,13,BN)                                            MIS12590C     CALL TITLE(3,8,14,YT)                                             MIS12600C     CALL PARCL2                                                       MIS12610C     CALL WTIMP                                                        MIS12620C     CALL DISPLA(1)                                                    MIS12630C     READ(6,200) ADUM                                                  MIS12640C 200 FORMAT(A1)                                                        MIS12650C     GO TO 5                                                           MIS12660C 300 REWIND 1                                                          MIS12670C     WRITE(1)GHS,GAS,ZHS,ZAS                                           MIS12680C     WRITE(6,305)                                                      MIS12690C 305 FORMAT(' GHS,GAS,ZHS,ZAS WRITTEN TO FILE 1')                      MIS12700C     GO TO 5                                                           MIS12710C     END                                                               MIS12720C                                                                       MIS12730C     SUBROUTINE MANAXS                                                 MIS12740C     RETURN                                                            MIS12750C     END                                                               MIS12760C                                                                       MIS12770C     SUBROUTINE PARCL2                                                 MIS12780C     RETURN                                                            MIS12790C     END                                                               MIS12800C                                                                       MIS12810C     SUBROUTINE WTIMP                                                  MIS12820C     RETURN                                                            MIS12830C     END                                                               MIS12840C                                                                       MIS12850      FUNCTION SINHI(XX)                                                MIS12860      COMPLEX*16 XX,XARG,SINHI                                          MIS12870
      XARG = CDEXP(XX)                                                  MIS12880      SINHI = 0.5D0 * (XARG - 1.0D0/XARG)                               MIS12890      RETURN                                                            MIS12900      END                                                               MIS12910C                                                                       MIS12920C                                                                       MIS12930C                                                                       MIS12940      SUBROUTINE AKP2(RES)                                              MIS12950      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS12960      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS12970      COMPLEX*16 AI                                                     MIS12980      TWO=2.D0                                                          MIS12990      GAM=DSQRT(DEL**2-SCRK**2)                                         MIS13000      SGAM=SNS*GAM                                                      MIS13010      C1=(SIGMA-SGAM)/TWO                                               MIS13020      C2=(SIGMA+SGAM)/TWO                                               MIS13030      DGDA=DEL/GAM                                                      MIS13040      DC1DA=SPS/TWO-SNS/TWO*DGDA                                        MIS13050      DC2DA=SPS/TWO+SNS/TWO*DGDA                                        MIS13060      RES=1.D0/GAM*DGDA+SNS*DCOTAN(SGAM)*DGDA                           MIS13070     1-DCOTAN(C1)*DC1DA-DCOTAN(C2)*DC2DA                                MIS13080      RETURN                                                            MIS13090      END                                                               MIS13100      SUBROUTINE AKAPM(ARG,BKPM)                                        MIS13110C                                                                       MIS13120C     SUBROUTINE FOR COMPUTING KAPPA MINUS                              MIS13130C                                                                       MIS13140      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS13150      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS13160      COMMON/BLK1A/ALP0,TWO,SPMSN,DSTR2,TPI,GAM0,A1,B1                  MIS13170      COMMON/BLK2/BSYCON                                                MIS13180      COMMON/CNVRG/CNVRGC                                               MIS13190      COMPLEX*16 BKPM,ALP0,C1,AI,CDEXP,ALP,ALN,C1TEST,BSYCON,ARG,CDSIN  MIS13200      COMPLEX*16 CDSQRT                                                 MIS13210      COMPLEX*16 C2P,C2Q,C2N,C3Q                                        MIS13220      COMPLEX*16 AT2,AT3                                                MIS13230      C1=CDEXP(-AI*ARG/TWO*SPMSN)                                       MIS13240      C1=C1*(1.D0-ARG/ALP0)                                             MIS13250      A2=-A1                                                            MIS13260
      C1TEST=0.D0                                                       MIS13270      DO 20 I=1,200                                                     MIS13280      R=I                                                               MIS13290      GAMP=TPI*R+GAM0                                                   MIS13300      GAMN=-TPI*R+GAM0                                                  MIS13310      C2P=GAMP/DSTR-SCRK                                                MIS13320      C2Q=GAMP/DSTR+SCRK                                                MIS13330      C2N=GAMN/DSTR-SCRK                                                MIS13340      C3Q=GAMN/DSTR+SCRK                                                MIS13350      ALP=GAMP*SPS/DSTR2+SNS/DSTR*CDSQRT(C2P)*CDSQRT(C2Q)               MIS13360      ALN=GAMN*SPS/DSTR2+SNS/DSTR*CDSQRT(C2N)*CDSQRT(C3Q)               MIS13370      AT2=(ALP-A1*R-B1)/(A1*R+B1-ARG)                                   MIS13380      AT3=(ALN-A2*R-B1)/(A2*R+B1-ARG)                                   MIS13390      C1=C1*(1.D0+AT2)*(1.D0+AT3)                                       MIS13400      IF(CDABS((C1-C1TEST)/C1) .LT. CNVRGC)  GO TO 50                   MIS13410      C1TEST=C1                                                         MIS1342020    CONTINUE                                                          MIS13430      GO TO 9999                                                        MIS1344050    CONTINUE                                                          MIS13450      C1=C1*B1/(ARG-B1)*CDSIN(PI/A1*(ARG-B1))/(DSIN(PI*B1/A1))          MIS13460      C1=C1*BSYCON                                                      MIS13470      BKPM=C1                                                           MIS13480      RETURN                                                            MIS134909999  WRITE(6,1000)                                                     MIS135001000  FORMAT(5X,'ERROR RETURN FROM AKAPM')                              MIS13510      STOP                                                              MIS13520      END                                                               MIS13530      SUBROUTINE ALAMDA(ARG,Y,BLAMDA)                                   MIS13540C                                                                       MIS13550C     SUBROUTINE FOR COMPUTING LAMDA                                    MIS13560C                                                                       MIS13570      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS13580      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS13590      COMPLEX*16 BLAMDA ,AI,CDEXP,C1                                    MIS13600      IF(ARG-SCRK .LT. 0.0)  GO TO 10                                   MIS13610      GAM=DSQRT(ARG**2-SCRK**2)                                         MIS13620      C1=DCOS(GAM*(SNS-Y))-CDEXP(AI*((ARG-DEL)*SPS+SIGMA))*DCOS(GAM*Y)  MIS13630      C2=DCOS(SNS*GAM)-DCOS((ARG-DEL)*SPS+SIGMA)                        MIS13640      BLAMDA=C1/C2                                                      MIS13650
      RETURN                                                            MIS1366010    CONTINUE                                                          MIS13670      GAM=DSQRT(SCRK**2-ARG**2)                                         MIS13680      C1=DCOSH(GAM*(SNS-Y))-CDEXP(AI*((ARG-DEL)*SPS+SIGMA))*DCOSH(GAM*Y)MIS13690      C2=DCOSH(SNS*GAM)-DCOS((ARG-DEL)*SPS+SIGMA)                       MIS13700      BLAMDA=C1/C2                                                      MIS13710      RETURN                                                            MIS13720      END                                                               MIS13730      SUBROUTINE AKAPPA(ARG,BKAPPA)                                     MIS13740C                                                                       MIS13750C     SUBROUTINE FOR COMPUTING KAPPA                                    MIS13760C                                                                       MIS13770      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS13780      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS13790      COMPLEX*16 AI                                                     MIS13800      IF(ARG-SCRK .LT. 0.D0)  GO TO 10                                  MIS13810      GAM=DSQRT(ARG**2-SCRK**2)                                         MIS13820      C1=BETA*GAM*DSIN(SNS*GAM)                                         MIS13830      C2=DCOS(SNS*GAM)-DCOS((ARG-DEL)*SPS+SIGMA)                        MIS13840      BKAPPA=C1/C2                                                      MIS13850      RETURN                                                            MIS1386010    CONTINUE                                                          MIS13870      GAM=DSQRT(SCRK**2-ARG**2)                                         MIS13880      C1=-BETA*GAM*DSINH(SNS*GAM)                                       MIS13890      C2=DCOSH(SNS*GAM)-DCOS((ARG-DEL)*SPS+SIGMA)                       MIS13900      BKAPPA=C1/C2                                                      MIS13910      RETURN                                                            MIS13920      END                                                               MIS13930      SUBROUTINE DLKAPM(ARG,BLKAPM)                                     MIS13940C                                                                       MIS13950C     SUBROUTINE FOR COMPUTING LOGARITHMIC DERIVATIVE OF KAPPA MINUS    MIS13960C                                                                       MIS13970      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS13980      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS13990      COMMON/BLK1A/ALP0,TWO,SPMSN,DSTR2,TPI,GAM0,A1,B1                  MIS14000      COMMON/CNVRG/CNVRGC                                               MIS14010      COMPLEX*16 BLKAPM,AI,C1,D1,D2,C1TEST,ARG,ALP0,ALP,ALN,AMB1        MIS14020      COMPLEX*16 CDCOS,CDSIN,CDSQRT                                     MIS14030      COMPLEX*16 C2P,C2Q,C2N,C3Q                                        MIS14040
      C1=-AI/2.D0*SPMSN                                                 MIS14050      GAM0=SPS*DEL-SIGMA                                                MIS14060      C1=C1+1.D0/(ARG-ALP0)                                             MIS14070      A2=-A1                                                            MIS14080      AMB1=ARG-B1                                                       MIS14090      C1TEST=0.D0                                                       MIS14100      DO 20 I=1,200                                                     MIS14110      R=I                                                               MIS14120      GAMP=TPI*R+GAM0                                                   MIS14130      GAMN=-TPI*R+GAM0                                                  MIS14140      C2P=GAMP/DSTR-SCRK                                                MIS14150      C2Q=GAMP/DSTR+SCRK                                                MIS14160      C2N=GAMN/DSTR-SCRK                                                MIS14170      C3Q=GAMN/DSTR+SCRK                                                MIS14180      ALP=GAMP*SPS/DSTR2+SNS/DSTR*CDSQRT(C2P)*CDSQRT(C2Q)               MIS14190      ALN=GAMN*SPS/DSTR2+SNS/DSTR*CDSQRT(C2N)*CDSQRT(C3Q)               MIS14200      D1=(ALP-A1*R-B1)/(A1*R-AMB1)                                      MIS14210      D2=(ALP-A1*R-B1)/((A1*R-AMB1)**2)                                 MIS14220      C1=C1+1.D0/(1.D0+D1)*D2                                           MIS14230      D1=(ALN-A2*R-B1)/(A2*R-AMB1)                                      MIS14240      D2=(ALN-A2*R-B1)/((A2*R-AMB1)**2)                                 MIS14250      C1=C1+1.D0/(1.D0+D1)*D2                                           MIS14260      IF(CDABS((C1-C1TEST)/C1) .LT. CNVRGC)  GO TO 50                   MIS14270      C1TEST=C1                                                         MIS1428020    CONTINUE                                                          MIS14290      GO TO 9999                                                        MIS1430050    CONTINUE                                                          MIS14310      C1=C1-1.D0/AMB1+PI/A1                                             MIS14320     1*CDCOS(PI/A1*AMB1)/(CDSIN(PI/A1*AMB1))                            MIS14330      BLKAPM=C1                                                         MIS14340      RETURN                                                            MIS143509999  WRITE(6,1000)                                                     MIS143601000  FORMAT(5X,'ERROR RETURN FROM DLKAPM')                             MIS14370      STOP                                                              MIS14380      END                                                               MIS14390      SUBROUTINE DRKAPM(ARG,INDX,RESLT)                                 MIS14400C                                                                       MIS14410C     THIS SUBROUTINE COMPUTES THE DERVIATIVE OF KAPPA MINUS            MIS14420C                                                                       MIS14430
      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS14440      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS14450      COMMON/BLK1A/ALP0,TWO,SPMSN,DSTR2,TPI,GAM0,A1,B1                  MIS14460      COMPLEX*16 ALP,ALN                                                MIS14470      COMMON/BLK2/BSYCON                                                MIS14480      COMMON/CNVRG/CNVRGC                                               MIS14490      COMPLEX*16 AI,ARG,RESLT,BSYCON,C1,CDEXP,C2Q,C3Q,CDSQRT,ALP0,CDSIN,MIS14500     *C2,                                                               MIS14510     1C2TEST,C2P,C2N,AT2,AT3                                            MIS14520      A2=-A1                                                            MIS14530      C1=CDEXP(-AI*ARG/TWO*SPMSN)                                       MIS14540      RINDX=INDX                                                        MIS14550      IF(INDX .EQ. 0)  GO TO 10                                         MIS14560      C2=C1*B1/ALP0*CDSIN(PI/A1*(ARG-B1))/(A1*RINDX+B1-ARG)*            MIS14570     1(1.D0+(ALP0-B1)/(B1-ARG))/(DSIN(PI*B1/A1))*BSYCON                 MIS14580      GO TO 20                                                          MIS1459010    CONTINUE                                                          MIS14600      C2=C1*B1/ALP0*CDSIN(PI/A1*(ARG-B1))/((B1-ALP0)*DSIN(PI*B1/A1))    MIS14610     1*BSYCON                                                           MIS1462020    CONTINUE                                                          MIS14630      C2TEST=0.D0                                                       MIS14640      DO 30 I=1,200                                                     MIS14650      R=I                                                               MIS14660      IF(INDX.LT. 0   .AND. DABS(RINDX) .EQ. R)  GO TO 30               MIS14670      IF(INDX .GT. 0  .AND.   RINDX .EQ. R)  GO TO 30                   MIS14680      GAMP=TPI*R+GAM0                                                   MIS14690      GAMN=-TPI*R+GAM0                                                  MIS14700      C2P=GAMP/DSTR-SCRK                                                MIS14710      C2Q=GAMP/DSTR+SCRK                                                MIS14720      C2N=GAMN/DSTR-SCRK                                                MIS14730      C3Q=GAMN/DSTR+SCRK                                                MIS14740      ALP=GAMP*SPS/DSTR2+SNS/DSTR*CDSQRT(C2P)*CDSQRT(C2Q)               MIS14750      ALN=GAMN*SPS/DSTR2+SNS/DSTR*CDSQRT(C2N)*CDSQRT(C3Q)               MIS14760      AT2=(ALP-A1*R-B1)/(A1*R+B1-ARG)                                   MIS14770      AT3=(ALN-A2*R-B1)/(A2*R+B1-ARG)                                   MIS14780      C2=C2*(1.D0+AT2)*(1.D0+AT3)                                       MIS14790      IF(CDABS((C2-C2TEST)/C2) .LT. CNVRGC)  GO TO 40                   MIS14800      C2TEST=C2                                                         MIS1481030    CONTINUE                                                          MIS14820
      GO TO 9999                                                        MIS1483040    CONTINUE                                                          MIS14840      RESLT=C2                                                          MIS14850      RETURN                                                            MIS148609999  CONTINUE                                                          MIS14870      WRITE(6,2040)                                                     MIS148802040  FORMAT(10X,'ERROR RETURN FROM DRKAPM')                            MIS14890      STOP                                                              MIS14900      END                                                               MIS14910      SUBROUTINE ASYCON                                                 MIS14920C                                                                       MIS14930C     SUBROUTINE FOR COMPUTING CONSTANT TERM IN KAPPA MINUS             MIS14940C                                                                       MIS14950      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS14960      COMMON/BLK2/ BSYCON                                               MIS14970      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS14980      COMMON/BLK1A/ALP0,TWO,SPMSN,DSTR2,TPI,GAM0,A1,B1                  MIS14990      COMMON/CNVRG/CNVRGC                                               MIS15000      COMPLEX*16 BSYCON,AI,C1,C1TEST,ALP,ALN                            MIS15010      COMPLEX*16 ARAT1,ARAT2,CDSQRT                                     MIS15020      COMPLEX*16 C2P,C2Q,C2N,C3Q,ALP0                                   MIS15030      C1=1.D0                                                           MIS15040      A2=-A1                                                            MIS15050      C1TEST=0.D0                                                       MIS15060      DO 10 I=1,200                                                     MIS15070      R=I                                                               MIS15080      GAMP=TPI*R+GAM0                                                   MIS15090      GAMN=-TPI*R+GAM0                                                  MIS15100      C2P=GAMP/DSTR-SCRK                                                MIS15110      C2Q=GAMP/DSTR+SCRK                                                MIS15120      C2N=GAMN/DSTR-SCRK                                                MIS15130      C3Q=GAMN/DSTR+SCRK                                                MIS15140      ALP=GAMP*SPS/DSTR2+SNS/DSTR*CDSQRT(C2P)*CDSQRT(C2Q)               MIS15150      ALN=GAMN*SPS/DSTR2+SNS/DSTR*CDSQRT(C2N)*CDSQRT(C3Q)               MIS15160      ARAT1=(A1*R+B1)/ALP                                               MIS15170      ARAT2=(A2*R+B1)/ALN                                               MIS15180      C1=C1*ARAT1*ARAT2                                                 MIS15190      IF(CDABS((C1-C1TEST)/C1) .LT. CNVRGC)  GO TO 60                   MIS15200      C1TEST=C1                                                         MIS15210
10    CONTINUE                                                          MIS15220      GO TO 9999                                                        MIS1523060    CONTINUE                                                          MIS15240      BSYCON=C1                                                         MIS15250      RETURN                                                            MIS152609999  WRITE(6,1000)                                                     MIS152701000  FORMAT(5X,'ERROR RETURN FROM ASYCON')                             MIS15280      STOP                                                              MIS15290      END                                                               MIS15300C                                                                       MIS15310C    SUBROUTINE RAO TO REPLACE  SUBROUTINE SMITH                        MIS15320C                                                                       MIS15330      SUBROUTINE RAO(AMACH,BSIG,AC)                                     MIS15340C                                                                       MIS15350C $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS15360C     $$                                                                MIS15370C     MODIFIED TO FIT THE REQUIREMENTS OF  NASA TM-82813                MIS15380C        BY  DURBHA V. MURTHY  DT. AUGUST 11,1982                       MIS15390C                                                                       MIS15400C                                                                       MIS15410C    AMACH      : MACH NUMBER                                           MIS15420C    BSIG       : INTERBLADE PHASE ANGLE (RADIANS)                      MIS15430C    AC      : OUTPUT MATRIX OF AERODYNAMIC DERIVATIVES                 MIS15440C                 ACCORDING TO NOTATION IN NASA TM-82813                MIS15450C    REDF2      : REDUCED FREQUENCY WITH RESPECT TO FULL CHORD          MIS15460C    STAG       : STAGGER ANGLE(RADIANS)                                MIS15470C    SC         : GAP TO CHORD RATIOWITH RESPECT TO FULL CHORD          MIS15480C                                                                       MIS15490C $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$MIS15500C     $$$$                                                              MIS15510C                                                                       MIS15520      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS15530      COMPLEX*16 AN(401),AB(401),FK(401),CN(401),CB(401),PD(401)        MIS15540      COMPLEX*16 SO(100),S1(100),P(215),A(25,30),AC(2,3)                MIS15550      COMPLEX*16 FF,ST,STP,FG,FS,FO,PILI,LIFT,MOM                       MIS15560      COMPLEX*16 WZ(26),WL(26),SL,SZ,SLM,SZM,CZ,CM,MZ,ML,W(26)          MIS15570      COMPLEX*16 ASTORE(25,30),FFF                                      MIS15580      REAL*8 M,KAPPA,MU,MUS,LAMDA,LAMDM,NU                              MIS15590      REAL*8 CZ1(2),CL1(2),MZ1(2),ML1(2)                                MIS15600
      EQUIVALENCE (CZ1(1),CZ),(CL1(1),CM),(MZ1(1),MZ),(ML1(1),ML)       MIS15610      REAL*8 X(26),LAMDE                                                MIS15620      COMMON/GENB/REDF2,STAG,ETAW,SC,CHIPW                              MIS15630C NUMBER OF STATIONS KEPT AT 25                                         MIS15640      N=25                                                              MIS15650      PI=3.141593                                                       MIS15660      PI2=PI*2                                                          MIS15670      CON=1.0E-5                                                        MIS15680      NNN=100                                                           MIS15690      KKK=2*NNN+1                                                       MIS15700      M = AMACH                                                         MIS15710C   ANGLES INPUT IN RADIANS- INTERBLADE PHASE ANGLE DIVIDED BY TWO*PI ANMIS15720C   FREQUENCY CONVERTED TO HALF-CHORD TO CONFORM TO RAO'S PROGRAM       MIS15730      OMEGA=0.5*REDF2                                                   MIS15740      DELTM=-BSIG/PI2                                                   MIS15750      SS=2.0*SC                                                         MIS15760      XL=STAG                                                           MIS15770      B=1.0/N                                                           MIS15780      B2=2*B                                                            MIS15790      Q1 = B/2                                                          MIS15800      Q2=3*B2/8                                                         MIS15810      Q3=B2**2/40                                                       MIS15820      D=SS*DSIN(XL)                                                     MIS15830120   HH=SS*DCOS(XL)                                                    MIS15840      BETA=DSQRT(1-M**2)                                                MIS15850      H=HH*BETA                                                         MIS15860      ZER=0.0                                                           MIS15870      S=DSQRT(H**2+D**2)                                                MIS15880C                                                                       MIS15890C   CHECK FOR ACOUSTIC RESONANCE                                        MIS15900C                                                                       MIS15910      SIGD = BSIG*180./PI                                               MIS15920      SIG = BSIG                                                        MIS15930      CS = 1./SC                                                        MIS15940      XM2 = M*M                                                         MIS15950      XK = XM2*SC*REDF2*DSIN(STAG)/(1.D0-XM2)                           MIS1596010    IF(SIG-XK-PI) 12,12,11                                            MIS1597011    SIG=SIG-2.D0*PI                                                   MIS15980      GOTO 10                                                           MIS15990
12    IF(SIG-XK+PI) 13,13,14                                            MIS1600013    SIG=SIG+2.D0*PI                                                   MIS16010      GOTO 12                                                           MIS1602014    XK=SIG*CS                                                         MIS16030      XK2= XK*XK                                                        MIS16040      XA = REDF2**2+XK2+2.*REDF2*XK*DSIN(STAG)                          MIS16050      XCHEC = XK2-XM2*XA                                                MIS16060      IF (DABS(XCHEC) .LT. .05D0) WRITE(6,100) SIGD                     MIS16070100   FORMAT(' !!! WARNING   ACOUSTIC RESONANCE NEAR SIGMA = ',G12.5)   MIS16080C  ---------------------------------------------------------------------MIS16090C     ---                                                               MIS16100      LAMDM=DATAN(D/H)                                                  MIS16110      CL=DCOS(LAMDM)                                                    MIS16120      SL=DSIN(LAMDM)                                                    MIS16130      NU=OMEGA/BETA**2                                                  MIS16140130   KAPPA=M*NU                                                        MIS16150      LAMDA=M*KAPPA                                                     MIS16160      DELTA=DELTM+LAMDA*D/PI2                                           MIS16170      MU=KAPPA*S/PI2                                                    MIS16180      MUS=MU**2                                                         MIS16190      FF=(0.0,1.0)                                                      MIS16200      FG=DCMPLX(ZER,NU*S)                                               MIS16210      L=1                                                               MIS16220      CC=DELTA**2-MUS                                                   MIS16230      IF(CC.EQ.0.0) GO TO 200                                           MIS16240      IF(CC.LT.0.0) FK(L)=DSQRT(-CC)*FF                                 MIS16250      IF(CC.GT.0.0) FK(L)=DSQRT(CC)                                     MIS16260      AN(L)=FK(L)*CL+FF*DELTA*SL                                        MIS16270      AB(L)=FK(L)*CL-FF*DELTA*SL                                        MIS16280      PD(L)=FK(L)*(PI2*AB(L)+FG)                                        MIS16290      CK=PI2*B/S                                                        MIS16300      CN(L)=CDEXP(-AN(L)*CK)                                            MIS16310      CB(L)=CDEXP(-AB(L)*CK)                                            MIS16320      DO 20 I=1,NNN                                                     MIS16330      L=L+1                                                             MIS16340      CC=(DELTA+I)**2-MUS                                               MIS16350      IF(CC.EQ.0.0) GO TO 200                                           MIS16360      IF(CC.LT.0.0) FK(L)=DSQRT(-CC)*FF                                 MIS16370      IF(CC.GT.0.0) FK(L)=DSQRT(CC)                                     MIS16380
      AN(L)=FK(L)*CL+(DELTA+I)*FF*SL                                    MIS16390      AB(L)=FK(L)*CL-(DELTA+I)*FF*SL                                    MIS16400      PD(L)=FK(L)*(PI2*AB(L)+FG)                                        MIS16410      CN(L)=CDEXP(-AN(L)*CK)                                            MIS16420      CB(L)=CDEXP(-AB(L)*CK)                                            MIS16430      L=L+1                                                             MIS16440      CC=(DELTA-I)**2-MUS                                               MIS16450      IF(CC.EQ.0.0) GO TO 200                                           MIS16460      IF(CC.GT.0.0) FK(L)=DSQRT(CC)                                     MIS16470      IF(CC.LT.0.0) FK(L)=DSQRT(-CC)*FF                                 MIS16480      AN(L)=FK(L)*CL+(DELTA-I)*FF*SL                                    MIS16490      AB(L)=FK(L)*CL-(DELTA-I)*FF*SL                                    MIS16500      PD(L)=FK(L)*(PI2*AB(L)+FG)                                        MIS16510      CN(L)=CDEXP(-AN(L)*CK)                                            MIS16520      CB(L)=CDEXP(-AB(L)*CK)                                            MIS1653020    CONTINUE                                                          MIS16540      STP=0.0                                                           MIS16550      L=1                                                               MIS16560      ST=((1-CN(L))/AN(L)+(1-CB(L))/AB(L))/FK(L)                        MIS16570      DO 25 I=2,KKK,2                                                   MIS16580      L=I                                                               MIS16590      ST=((1-CN(L))/AN(L)+(1-CB(L))/AB(L))/FK(L)+ST                     MIS16600      L=L+1                                                             MIS16610      ST=((1-CN(L))/AN(L)+(1-CB(L))/AB(L))/FK(L)+ST                     MIS16620      IF(CDABS(ST-STP).LT.CON) GO TO 30                                 MIS16630      STP=ST                                                            MIS1664025    CONTINUE                                                          MIS1665030    CONTINUE                                                          MIS16660      SO(1)=-ST*S/(2*PI2*B2)                                            MIS16670      DO 40 J=2,N                                                       MIS16680      JK=2*(J-1)                                                        MIS16690      L=1                                                               MIS16700      STP=0.0                                                           MIS16710      ST=CN(L)**JK/FK(L)                                                MIS16720      DO 32 I=2,KKK,2                                                   MIS16730      L=L+1                                                             MIS16740      ST=CN(L)**JK/FK(L)+ST                                             MIS16750      L=L+1                                                             MIS16760      ST=CN(L)**JK/FK(L)+ST                                             MIS16770
      IF(CDABS(ST-STP).LT.CON) GO TO 35                                 MIS1678032    STP=ST                                                            MIS1679035    SO(J)=-0.5*ST                                                     MIS1680040    CONTINUE                                                          MIS16810      N1=N+1                                                            MIS16820      N2=3*N-1                                                          MIS16830      DO 50 J=N1,N2                                                     MIS16840      JK=J-N                                                            MIS16850      STP=0.0                                                           MIS16860      L=1                                                               MIS16870      ST=CB(L)**JK/FK(L)                                                MIS16880      DO 42 I=2,KKK,2                                                   MIS16890      L=L+1                                                             MIS16900      ST=CB(L)**JK/FK(L)+ST                                             MIS16910      L=L+1                                                             MIS16920      ST=CB(L)**JK/FK(L)+ST                                             MIS16930      IF(CDABS(ST-STP).LT.CON) GO TO 45                                 MIS1694042    STP=ST                                                            MIS1695045    SO(J)=-0.5*ST                                                     MIS1696050    CONTINUE                                                          MIS16970      DO 55 J=1,N                                                       MIS16980      JK=(J-1)*2+1                                                      MIS16990      L=1                                                               MIS17000      STP=0.0                                                           MIS17010      ST=AN(L)*CN(L)**JK/FK(L)                                          MIS17020      DO 52 I=2,KKK,2                                                   MIS17030      L=L+1                                                             MIS17040      ST=AN(L)*CN(L)**JK/FK(L)+ST                                       MIS17050      L=L+1                                                             MIS17060      ST=AN(L)*CN(L)**JK/FK(L)+ST                                       MIS17070      IF(CDABS(ST-STP).LT.CON) GO TO 54                                 MIS17080      STP=ST                                                            MIS1709052    CONTINUE                                                          MIS1710054    S1(J)=-PI/S*ST                                                    MIS1711055    CONTINUE                                                          MIS17120      N1=N+1                                                            MIS17130      N2=2*N                                                            MIS17140      DO 60 J=N1,N2                                                     MIS17150      JK=(J-N1)*2+1                                                     MIS17160
      L=1                                                               MIS17170      STP=0.0                                                           MIS17180      ST=AB(L)*CB(L)**JK/FK(L)                                          MIS17190      DO 57 I=2,KKK,2                                                   MIS17200      L=L+1                                                             MIS17210      ST=AB(L)*CB(L)**JK/FK(L)+ST                                       MIS17220      L=L+1                                                             MIS17230      ST=AB(L)*CB(L)**JK/FK(L)+ST                                       MIS17240      IF(CDABS(ST-STP).LT.CON) GO TO 59                                 MIS17250      STP=ST                                                            MIS1726057    CONTINUE                                                          MIS1727059    S1(J)=PI/S*ST                                                     MIS1728060    CONTINUE                                                          MIS17290      DO 64 J=1,N                                                       MIS17300      JK=(J-1)*2+1                                                      MIS17310      L=1                                                               MIS17320      STP=0.0                                                           MIS17330      ST=CB(L)**JK/PD(L)                                                MIS17340      DO 61 I=2,KKK,2                                                   MIS17350      L=L+1                                                             MIS17360      ST=CB(L)**JK/PD(L)+ST                                             MIS17370      L=L+1                                                             MIS17380      ST=CB(L)**JK/PD(L)+ST                                             MIS17390      IF(CDABS(ST-STP).LT.CON) GO TO 62                                 MIS17400      STP=ST                                                            MIS1741061    CONTINUE                                                          MIS1742062    P(J)=-S/2*ST                                                      MIS1743064    CONTINUE                                                          MIS17440      FG=DCMPLX(ZER,-NU*B)                                              MIS17450      FG=1/(CDEXP(FG)+DCMPLX(ZER,NU*B2))                                MIS17460      FS=DCMPLX(ZER,NU)                                                 MIS17470      CJ=(NU*BETA)**2                                                   MIS17480      L=0                                                               MIS17490      CT=2*KAPPA**2*B                                                   MIS17500      DO 70 J=1,N                                                       MIS17510      DO 70 I=1,N                                                       MIS17520      L=L+1                                                             MIS17530      NK=I-J+1                                                          MIS17540      NK1=I-J                                                           MIS17550
      NK2=NK1+1                                                         MIS17560      IF(I.EQ.J) NK1=N+1                                                MIS17570      IF(I.EQ.J) NK2=1                                                  MIS17580      IF(J.LE.I) GO TO 65                                               MIS17590      NK1=N+J-I+1                                                       MIS17600      NK2=NK1-1                                                         MIS17610      NK=N+2*(J-I)                                                      MIS1762065    A(I,J)=S1(NK1)-S1(NK2)+CT*SO(NK)                                  MIS17630      IF(J.NE.N) GO TO 70                                               MIS17640      NK=N+2*(J-I)+1                                                    MIS17650      NK2=J-I+1                                                         MIS17660      A(I,J)=A(I,J)-FG*(S1(NK1)+SO(NK)*FS+CJ*P(NK2))                    MIS1767070    CONTINUE                                                          MIS17680      X(1)=-1.0+B                                                       MIS17690      DO 81 I=2,N                                                       MIS1770081    X(I)=X(I-1)+B2                                                    MIS17710C  ---------------------------------------------------------------------MIS17720C     --                                                                MIS17730C                                                                       MIS17740C  MATRIX A IS STORED FOR USE IN CALCULATION OF GUST COEFFICIENTS       MIS17750C                                                                       MIS17760      DO 300 I=1,25                                                     MIS17770      DO 300 J=1,30                                                     MIS17780300   ASTORE(I,J)=A(I,J)                                                MIS17790C  ---------------------------------------------------------------------MIS17800C     --                                                                MIS17810      N1=N+1                                                            MIS17820      N2=N+2                                                            MIS17830      DO 82 I=1,N                                                       MIS17840      A(I,N1)=FF*OMEGA/BETA*CDEXP(-FF*LAMDA*X(I))                       MIS1785082    A(I,N2)=(1+FF*OMEGA*X(I))*CDEXP(-FF*LAMDA*X(I))/BETA              MIS17860      CALL GAUSSR(A,N,N2)                                               MIS17870      DO 84 I=1,N                                                       MIS17880      WZ(I)=A(I,N1)*CDEXP(LAMDA*FF*X(I))                                MIS1789084    WL(I)=A(I,N2)*CDEXP(LAMDA*FF*X(I))                                MIS17900      WZ(N+1)=WZ(N)*FG*CDEXP(LAMDA*FF*B)                                MIS17910      WL(N+1)=WL(N)*FG*CDEXP(LAMDA*FF*B)                                MIS17920      SZ=Q1*(WZ(1)+WZ(N)+WZ(N+1))                                       MIS17930      SL=Q1*(WL(1)+WL(N)+WL(N+1))                                       MIS17940
      SZM=Q1*(WZ(1)*(-1+Q1)+(WZ(N)+WZ(N+1))*(1-Q1))                     MIS17950      SLM=Q1*(WL(1)*(-1+Q1)+(WL(N)+WL(N+1))*(1-Q1))                     MIS17960      LL=N-3                                                            MIS17970      L=1                                                               MIS1798085    ST=Q2*(WZ(L)+3*WZ(L+1)+3*WZ(L+2)+WZ(L+3))                         MIS17990      STP=Q2*(WL(L)+3*WL(L+1)+3*WL(L+2)+WL(L+3))                        MIS18000      SZ=SZ+ST                                                          MIS18010      SL=SL+STP                                                         MIS18020      SZM=SZM+ST*X(L)+Q3*(6*WZ(L)+27*WZ(L+1)+108*WZ(L+2)+39*WZ(L+3))    MIS18030      SLM=SLM+STP*X(L)+Q3*(6*WL(L)+27*WL(L+1)+108*WL(L+2)+39*WL(L+3))   MIS18040      L=L+3                                                             MIS18050      IF(L.LE.LL) GOTO 85                                               MIS18060      CZ=WZ(N+1)+FF*OMEGA*SZ                                            MIS18070      CM=WL(N+1)+FF*OMEGA*SL                                            MIS18080      MZ=-WZ(N+1)+SZ-SZM*FF*OMEGA                                       MIS18090      ML=-WL(N+1)+SL-SLM*FF*OMEGA                                       MIS18100      CZ=CZ*PI2                                                         MIS18110      CM=CM*PI2                                                         MIS18120      MZ=MZ*PI2                                                         MIS18130      ML=ML*PI2                                                         MIS1814090    CONTINUE                                                          MIS18150C  ---------------------------------------------------------------------MIS18160C     -----                                                             MIS18170C                                                                       MIS18180C   CALCULATION OF GUST COEFFICIENTS                                    MIS18190      DO 400 I=1,25                                                     MIS18200      DO 400 J=1,30                                                     MIS18210400   A(I,J)=ASTORE(I,J)                                                MIS18220C                                                                       MIS18230      DS=B**2                                                           MIS18240      DTS=B2**2                                                         MIS18250      NN=N+1                                                            MIS18260      X(NN)=1.0                                                         MIS18270      DO 982 I=1,N                                                      MIS18280982   A(I,NN)=PI2*CDEXP(-FF*(LAMDA+OMEGA)*X(I))/BETA                    MIS18290      CALL GAUSSR(A,N,NN)                                               MIS18300      DO 984 I=1,N                                                      MIS18310984   W(I)=A(I,NN)*CDEXP(LAMDA*FF*X(I))                                 MIS18320      W(NN)=W(N)*FG*CDEXP(LAMDA*FF*B)                                   MIS18330
      FFF=DCMPLX(ZER,OMEGA)                                             MIS18340      CALL LM(W,N,B,B2,DS,DTS,LIFT,MOM,X,FFF)                           MIS18350      LIFT=LIFT/PI2                                                     MIS18360      MOM=MOM/PI2/2                                                     MIS18370C                                                                       MIS18380C    RAO'S COEFFICIENTS ARE PUT INTO A MATRIX FORM BELOW                MIS18390C                                                                       MIS18400      AC(1,1)=CZ                                                        MIS18410      AC(2,1)=MZ                                                        MIS18420      AC(1,2)=CM                                                        MIS18430      AC(2,2)=ML                                                        MIS18440      AC(1,3)=LIFT                                                      MIS18450      AC(2,3)=MOM                                                       MIS18460C                                                                       MIS18470C  RAO'S COEFFICIENTS ARE CONVERTED TO THE FORM REQUIRED BY             MIS18480C  NASA TM-82813                                                        MIS18490C                                                                       MIS18500      PILI = FF*PI*REDF2                                                MIS18510      AC(1,1) = -AC(1,1)/PILI                                           MIS18520      AC(1,2) = -AC(1,2)/PI2                                            MIS18530      AC(2,1) = AC(2,1)/(2.*PILI)                                       MIS18540      AC(2,2) = AC(2,2)/(4.*PI)                                         MIS18550      AC(1,3) = -AC(1,3)                                                MIS18560      AC(2,3) = AC(2,3)                                                 MIS18570C                                                                       MIS18580C    THE AERODYNAMIC COEFFICIENTS W.R.T. MID-CHORD ARE NOW CONVERTED TO MIS18590C      CORRESPOND TO LEADING EDGE                                       MIS18600C                                                                       MIS18610      AC(1,1) = AC(1,1)                                                 MIS18620      AC(2,1) = AC(2,1)+0.5*AC(1,1)                                     MIS18630      AC(1,2) = AC(1,2)+FF*OMEGA*AC(1,1)                                MIS18640      AC(2,2) = AC(2,2)+0.5*AC(1,2)+FF*OMEGA*AC(2,1)-0.25*FF*REDF2*AC(1,MIS18650     *1)                                                                MIS18660      AC(1,3)=AC(1,3)*CDEXP(-FF*OMEGA)                                  MIS18670      AC(2,3)=AC(2,3)*CDEXP(-FF*OMEGA)+0.5*AC(1,3)                      MIS18680C                                                                       MIS18690200   RETURN                                                            MIS18700      END                                                               MIS18710      SUBROUTINE GAUSSR(A,N,N2)                                         MIS18720
      COMPLEX*16 A(25,30)                                               MIS18730C                                                                       MIS18740      DO 100 I=1,N                                                      MIS18750      K= I+1                                                            MIS18760      DO 10 J=K,N2                                                      MIS1877010    A(I,J) = A(I,J)/A(I,I)                                            MIS18780      DO 30 M=1,N                                                       MIS18790      IF (M .EQ. I) GOTO 30                                             MIS18800      DO 20 L=K,N2                                                      MIS1881020    A(M,L) = A(M,L) - A(M,I)*A(I,L)                                   MIS1882030    CONTINUE                                                          MIS18830100   CONTINUE                                                          MIS18840      RETURN                                                            MIS18850      END                                                               MIS18860      SUBROUTINE LM(K,M,D,DT,DS,DTS,LIFT,MOM,X,FF)                      MIS18870      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS18880      COMPLEX*16 K(26),LIFT,MOM,DL,FF                                   MIS18890      REAL*8 X(26)                                                      MIS18900      LIFT=D*(2.25*K(1)+0.75*K(2))                                      MIS18910      MOM=LIFT*X(1)+DS*(1.125*K(1)+1.125*K(2))                          MIS18920      DL=D*(K(M)+K(M+1))/2                                              MIS18930      LIFT=LIFT+DL                                                      MIS18940      MOM=MOM+DL*(1+X(M))/2                                             MIS18950      M1=2                                                              MIS18960      IF(M/2*2 .EQ. M) GOTO 15                                          MIS18970      DL=0.75*D*(K(2)+3*K(3)+3*K(4)+K(5))                               MIS18980      LIFT=LIFT+DL                                                      MIS18990      MOM=MOM+DL*X(2)+DTS/40*(6*K(2)+27*K(3)+108*K(4)+39*K(5))          MIS19000      M1=5                                                              MIS1901015    IF (M1 .GE. M) GO TO 25                                           MIS19020      M2=M-2                                                            MIS19030      DO 20 N=M1,M2,2                                                   MIS19040      DL=DT/3*(K(N)+4*K(N+1)+K(N+2))                                    MIS19050      LIFT=LIFT+DL                                                      MIS19060      MOM=MOM+DL*X(N)+DTS/3*(4*K(N+1)+2*K(N+2))                         MIS1907020    CONTINUE                                                          MIS19080      MOM=-K(M+1)+LIFT-FF*MOM                                           MIS19090      LIFT=K(M+1)+FF*LIFT                                               MIS1910025    CONTINUE                                                          MIS19110
      RETURN                                                            MIS19120      END                                                               MIS19130C                                                                       MIS19140C                                                                       MIS19150C                                                                       MIS19160      SUBROUTINE SSCASC(ALPR,DISAMP,GUSAMP,GL,BSIG,CL,CM)               MIS19170C                                                             6/29/87   MIS19180C     CASCADE SUPERSONIC LEADING EDGE LOCUS PROBLEM                     MIS19190C     DEVELOPMENT CODE BY JOHN J. ADAMCZYK                              MIS19200C     NASA LEWIS RESERACH CENTER CLEVELAND,OHIO                         MIS19210C                                                                       MIS19220C     CODE DEVELOPED ON UNIVAC 1100 SYSTEM                              MIS19230C                                                                       MIS19240C     MODIFIED FOR IBM 3033 BY ROBERT E. KIELB                          MIS19250C                                                                       MIS19260C     UNSTEADY FLOW ANAYSIS OF A SUPERSONIC CASCADE                     MIS19270C                                                                       MIS19280C                                                                       MIS19290C     LIFT AND MOMENT COEFICIENT                                        MIS19300C                                                                       MIS19310      IMPLICIT REAL*8 (A-H,O-Z)                                         MIS19320      COMMON/BLK1/SCRK,SPS,SNS,DSTR,AI,PI,DEL,SIGMA,BETA                MIS19330      COMMON/BLK1A/ALP0,TWO,SPMSN,DSTR2,TPI,SDS,A1,B1                   MIS19340      COMMON/BLK2/BSYCON                                                MIS19350      COMMON /AERO1/ XNB,REDF,XI,AB,PITCOR,XMU,XRA,XA,W0,WD1,AMACH      MIS19360      COMMON/CNVRG/CNVRGC                                               MIS19370      COMPLEX*16 SBKDE1,SBKDE2,CL,CM,CE1,CE2,CE2M,TPAI,AAI,TMSPSI       MIS19380      COMPLEX*16 F4,F4S,AM4,F5S,F6S,AM4TST,SUM3,SUM4,AM5TT,AM6          MIS19390      COMPLEX*16 SUMSV1,SUMSV2,SVKL1,SVKL2,F5,F5T,AM5,AM5T              MIS19400      COMPLEX*16 AI,A,B,BSYCON,ALP, AM1,ALN,BLKAPM,BKDEL3,F1S,C1        MIS19410     1,C2P,C2N                                                          MIS19420      COMPLEX*16 C2,AMTEST,FT2,BLAM1,FT3,AM2,SUM1,SUM2,BLAM2,FT2T,C1T,  MIS19430     1FT3T,F2P,AM2P,SUM1T,SUM2T                                         MIS19440      COMPLEX*16 C1P,C1N,CDSQRT,BKDEL1,CDEXP,BKDEL2,BLKAP1,ARG,ARG2,    MIS19450     1FT3TST                                                            MIS19460      COMPLEX*16 BC,BC2,BC3,BC4,BC5,CA1,CA2,CA3,CA4                     MIS19470      COMPLEX*16 ALPAMP,ALP0,C2Q,C3Q                                    MIS19480      COMPLEX*16 CLIFT,CMOMT,EIGL                                       MIS19490      COMPLEX*16 FQ7,AISDS,AISPS,AISNS                                  MIS19500
      COMPLEX*16 F1,F2,CE3,CE4,CE5,CE6,CE7,CE8,AISPSN,TAI               MIS19510      DIMENSION SBKDE1(201),SBKDE2(201)                                 MIS19520      DIMENSION SUMSV1(201),SUMSV2(201),SVKL1(201),SVKL2(201)           MIS19530      CNVRGC=.001D0                                                     MIS19540      ZERO=0.D0                                                         MIS195505     CONTINUE                                                          MIS19560      ONE=1.D0                                                          MIS19570      TWO=2.D0                                                          MIS19580      FOUR=4.D0                                                         MIS19590      PI=3.1415927D0                                                    MIS19600      AI=DCMPLX(0.D0,ONE)                                               MIS19610      PK2=PI*REDF**2                                                    MIS19620      STAGR=PI/TWO-XI                                                   MIS19630      SIGMA=-BSIG                                                       MIS19640      PITAXS=AB+ONE                                                     MIS19650      AMOAXS=PITAXS                                                     MIS19660      ALPAMP=DCMPLX(ALPR,ZERO)                                          MIS19670      BETA=DSQRT(AMACH**2-ONE)                                          MIS19680      SCRK=REDF*AMACH/(BETA**2)                                         MIS19690      DEL=SCRK*AMACH                                                    MIS19700      CARG=DEL-GL                                                       MIS19710      AMU=REDF/(BETA**2)                                                MIS19720      SP=PITCOR*DCOS(STAGR)*TWO                                         MIS19730      SN=PITCOR*DSIN(STAGR)*TWO                                         MIS19740      SPS=SP                                                            MIS19750      TMSPSI=AI*(TWO-SPS)                                               MIS19760      SNS=SN*BETA                                                       MIS19770      SPMSN=SPS-SNS                                                     MIS19780      IF(SPMSN .LT. 0.00001D0)  GO TO 9991                              MIS19790      SPMSN2=SPMSN**2                                                   MIS19800      TPI=TWO*PI                                                        MIS19810      DSTR2=SPS**2-SNS**2                                               MIS19820      DSTR=DSQRT(DSTR2)                                                 MIS19830      SDS=SPS*DEL-SIGMA                                                 MIS19840      SNDD=SNS/DSTR                                                     MIS19850      TPNMP=TWO+SNS-SPS                                                 MIS19860      SPPSN=SPS+SNS                                                     MIS19870      TPAI=TWO*PI*AI                                                    MIS19880      SPD=SPS*DEL                                                       MIS19890
      CE2=CDEXP(AI*SIGMA)                                               MIS19900      CE2M=ONE/CE2                                                      MIS19910      SPDD=SPS/DSTR2                                                    MIS19920      SCRK2=SCRK**2                                                     MIS19930      AISDS=AI*SDS                                                      MIS19940      CE1=CDEXP(AISDS/TWO)                                              MIS19950      AISPS=AI*SPS                                                      MIS19960      AISNS=AI*SNS                                                      MIS19970      SMSPD=SIGMA-SPD                                                   MIS19980      DSMS=-DEL*SNS-SIGMA                                               MIS19990      C2Q=SDS/DSTR-SCRK                                                 MIS20000      C3Q=SDS/DSTR+SCRK                                                 MIS20010      ALP0=SDS*SPS/DSTR2+SNS/DSTR*CDSQRT(C2Q)*CDSQRT(C3Q)               MIS20020      AISPSN=AI*SPMSN                                                   MIS20030      TAI=TWO*AI                                                        MIS20040      DMAMU=DEL-AMU                                                     MIS20050      SMSD=SIGMA-SNS*DEL                                                MIS20060      TPNMP2=TPNMP**2                                                   MIS20070      TPNMP3=TPNMP2*TPNMP                                               MIS20080      A=(ONE+AI*REDF*PITAXS)*ALPAMP-AI*REDF*DISAMP                      MIS20090      B=-AI*REDF*ALPAMP                                                 MIS20100      IF( DABS(GL) .LT. .000001D0)  GO TO 2047                          MIS20110      A=GUSAMP                                                          MIS20120      B=0.D0                                                            MIS201304000  CONTINUE                                                          MIS201402047  CONTINUE                                                          MIS20150      AAI=A*AI                                                          MIS20160      A1=TPI/SPMSN                                                      MIS20170      B1=SDS/SPMSN                                                      MIS20180      CALL ASYCON                                                       MIS20190      GAM=SDS                                                           MIS20200      C1P=GAM/DSTR-SCRK                                                 MIS20210      C1N=GAM/DSTR+SCRK                                                 MIS20220      ALP=GAM*SPDD+SNDD*CDSQRT(C1P)*CDSQRT(C1N)                         MIS20230      BC=-B1/ALP*BSYCON/DSIN(PI*B1/A1)                                  MIS20240      F1=(ALP-AMU)/(ALP-DEL)*AISNS/(BETA*(GAM-ALP*SPS))                 MIS20250      ARG2=DEL                                                          MIS20260      CALL AKAPM(ARG2,BKDEL1)                                           MIS20270      ARG=CARG                                                          MIS20280
      CALL AKAPM(ARG,BKDEL2)                                            MIS20290      CALL DLKAPM(ARG2,BLKAP1)                                          MIS20300      INX=0                                                             MIS20310      CALL DRKAPM(ALP,INX,BLKAPM)                                       MIS20320      F1=F1*BKDEL1/BLKAPM*(-(ALP-DEL)/(ALP-DEL+GL)*AAI*BKDEL2/BKDEL1    MIS20330     1+B*BLKAP1+B/(ALP-DEL))                                            MIS20340      F1S=F1                                                            MIS20350      F1=F1*AI/(ALP-DEL)*(CDEXP(-AI*(ALP-DEL)*SPMSN)-ONE)               MIS20360      AM1=F1/(AI*(ALP-DEL))-F1S/(AI*(ALP-DEL))*SPMSN*CDEXP(-AI*(        MIS20370     1ALP-DEL)*SPMSN)                                                   MIS20380      AMTEST=0.D0                                                       MIS20390      DO 20 I=1,200                                                     MIS20400      R=I                                                               MIS20410      GAMP=TPI*R+SDS                                                    MIS20420      GAMN=-TPI*R+SDS                                                   MIS20430      C1P=(GAMP/DSTR)-SCRK                                              MIS20440      C2P=(GAMP/DSTR)+SCRK                                              MIS20450      ALP=GAMP*SPDD+SNDD*CDSQRT(C1P)*CDSQRT(C2P)                        MIS20460      IDX=I                                                             MIS20470      CALL DRKAPM(ALP,IDX,BLKAPM)                                       MIS20480      C1=(ALP-AMU)/(ALP-DEL)*AISNS/(BETA*(GAMP-ALP*SPS))*BKDEL1/        MIS20490     1(       BLKAPM)*(-(ALP-DEL)/(ALP-DEL+GL)*AAI*BKDEL2/BKDEL1+       MIS20500     2B*BLKAP1+B/(ALP-DEL))                                             MIS20510      C1N=(GAMN/DSTR)-SCRK                                              MIS20520      C2N=(GAMN/DSTR)+SCRK                                              MIS20530      ALN=GAMN*SPDD+SNDD*CDSQRT(C1N)*CDSQRT(C2N)                        MIS20540      IDX=-I                                                            MIS20550      CALL DRKAPM(ALN,IDX,BLKAPM)                                       MIS20560      C2=(ALN-AMU)/(ALN-DEL)*AISNS/(BETA*(GAMN-ALN*SPS))*BKDEL1/        MIS20570     1(       BLKAPM)*(-(ALN-DEL)/(ALN-DEL+GL)*AAI*BKDEL2/BKDEL1+       MIS20580     2B*BLKAP1+B/(ALN-DEL))                                             MIS20590      F1=F1+C1*AI/(ALP-DEL)*(CDEXP(-AI*(ALP-DEL)*SPMSN)-ONE)+C2         MIS20600     1*AI/(ALN-DEL)*(CDEXP(-AI*(ALN-DEL)*SPMSN)-ONE)                    MIS20610      AM1=AM1+C1/(AI*(ALP-DEL))*(-SPMSN*CDEXP(-AI*(ALP-DEL)             MIS20620     1*SPMSN)+AI/(ALP-DEL)*(CDEXP(-AI*(ALP-DEL)*SPMSN)-ONE))            MIS20630     2+C2/(AI*(ALN-DEL))*(-SPMSN*CDEXP(-AI*(ALN-DEL)*SPMSN)+            MIS20640     3AI/(ALN-DEL)*(CDEXP(-AI*(ALN-DEL)*SPMSN)-ONE))                    MIS20650      IF(CDABS((AM1-AMTEST)/AM1) .LT. CNVRGC)  GO TO 45                 MIS20660      AMTEST=AM1                                                        MIS20670
20    CONTINUE                                                          MIS20680      GO TO 9992                                                        MIS2069045    CONTINUE                                                          MIS20700      Y=0.D0                                                            MIS20710      Y1=SNS                                                            MIS20720      ARG=CARG                                                          MIS20730      CALL ALAMDA(ARG,Y,BLAM1)                                          MIS20740      CALL ALAMDA(ARG,Y1,BLAM2)                                         MIS20750      CALL AKAPPA(ARG,BKAP1)                                            MIS20760      FT2=AAI*(CARG-AMU)*BLAM1/BKAP1                                    MIS20770      FT2T=AAI*(CARG-AMU)*BLAM2/BKAP1                                   MIS20780      ARG=DEL                                                           MIS20790      CALL ALAMDA(ARG,Y,BLAM1)                                          MIS20800      CALL ALAMDA(ARG,Y1,BLAM2)                                         MIS20810      CALL AKAPPA(ARG,BKAP1)                                            MIS20820      GAM=DSQRT(DEL**2-SCRK2)                                           MIS20830      C1=-ONE/(BETA*GAM*DSIN(SNS*GAM))                                  MIS20840      C1T=C1*(AISPS*CE2*DCOS(GAM*SNS)-SNS*DEL/GAM*CDEXP                 MIS20850     1 (AI*SIGMA)*DSIN(GAM*SNS))-BLAM2/BKAP1*DEL/GAM*(DSIN(SNS*GAM)     MIS20860     2+GAM*SNS*DCOS(SNS*GAM))/(GAM*DSIN(SNS*GAM))                       MIS20870      C1=C1*(ARG/GAM*SNS*DSIN(SNS*GAM)+AISPS*CE2)-BLAM1/                MIS20880     1BKAP1*DEL/(GAM*DSIN(SNS*GAM))*(DSIN(SNS*GAM)/GAM+SNS*DCOS(SNS*GAM)MIS20890     *)                                                                 MIS20900      FT3=-B*(BLAM1/BKAP1+(DMAMU)*C1)                                   MIS20910      FT3T=-B*(BLAM2/BKAP1+(DMAMU)*C1T)                                 MIS20920      IF(DABS(GL).LT..000001D0)GO TO 50                                 MIS20930      F2=FT2*(CDEXP(TAI*GL)-CDEXP(AI*GL*SPMSN))/(AI*GL)                 MIS20940     1+FT3*TPNMP+B*AI*(DMAMU)*BLAM1/BKAP1*(FOUR-SPMSN2)                 MIS20950     2/TWO                                                              MIS20960      AM2=FT2*(TWO*CDEXP(TAI*GL)/(AI*GL)-SPMSN/(AI*GL)*CDEXP(GL*        MIS20970     1AISPSN)+(CDEXP(TAI*GL)-CDEXP(AISPSN*GL))/GL**2)                   MIS20980     2+FT3*(FOUR-SPMSN2)/TWO+B*AI*(DMAMU)*BLAM1/BKAP1*                  MIS20990     3(8.D0-SPMSN**3)/3.D0                                              MIS21000      F2P=FT2T*CE2M*CDEXP(AI*GL*SNS)/(AI*GL)*(CDEXP(TAI*                MIS21010     1GL)-CDEXP(AI*GL*SPMSN))+FT3T*CE2M*TPNMP                           MIS21020     2+B*AI*(DMAMU)*CE2M*BLAM2/BKAP1*(TPNMP2/                           MIS21030     3TWO+SPS*TPNMP)                                                    MIS21040      AM2P=FT2T*CE2M*(CDEXP(AI*GL*SPS)/(AI*GL)*TPNMP                    MIS21050     1*CDEXP(AI*GL*TPNMP)+CDEXP(AI*GL*SPS)/(GL**2)*(CDEXP               MIS21060
     2(AI*GL*TPNMP)-ONE))+FT3T*CE2M*TPNMP2                              MIS21070     3/TWO+B*AI*(DMAMU)*CE2M*BLAM2/BKAP1*(TPNMP3                        MIS21080     4/3.D0+SPS*TPNMP2/TWO)                                             MIS21090      GO TO 55                                                          MIS2110050    CONTINUE                                                          MIS21110      F2=FT2*TPNMP+FT3*TPNMP+B*AI*(DMAMU)*BLAM1/                        MIS21120     1BKAP1*(FOUR-SPMSN2)/TWO                                           MIS21130      AM2=FT2*(FOUR-SPMSN2)/TWO+FT3*(FOUR-SPMSN2)/TWO                   MIS21140     1+B*AI*(DMAMU)*BLAM1/BKAP1*(8.D0-SPMSN**3)/3.D0                    MIS21150      F2P=FT2T*CE2M*TPNMP+FT3T*CE2M*(TWO                                MIS21160     1+SNS-SPS)+B*AI*(DMAMU)*CE2M*BLAM2/BKAP1*((TWO+SNS-                MIS21170     2SPS)**2/TWO+SPS*TPNMP)                                            MIS21180      AM2P=FT2T*CE2M*TPNMP2/TWO+FT3T*CDEXP(-AI*                         MIS21190     1SIGMA)*TPNMP2/TWO+B*AI*(DMAMU)*CE2M*BLAM2                         MIS21200     2/BKAP1*(TPNMP3/3.D0+SPS*TPNMP2/TWO)                               MIS2121055    CONTINUE                                                          MIS21220      FT3TST=0.D0                                                       MIS21230      FT2=0.D0                                                          MIS21240      FT3=0.D0                                                          MIS21250      FT2T=0.D0                                                         MIS21260      FT3T=0.D0                                                         MIS21270      DO 60 I=1,101                                                     MIS21280      RT=0.D0                                                           MIS21290      R=I-1                                                             MIS21300      RI=(-ONE)**(I-1)                                                  MIS21310      ALP=DSQRT((R*PI/SNS)**2+SCRK2)                                    MIS21320      ALN=-ALP                                                          MIS21330      CALL AKAPM(ALP,BKDEL3)                                            MIS21340      SVKL1(I)=BKDEL3                                                   MIS21350      IF(I.EQ.1)  RT=ONE                                                MIS21360      SUM1=(ALP-AMU)/(ALP-DEL)*(RI-CDEXP    (AI*(ALP-DEL)*SPS)*CDEXP(AI*MIS21370     1SIGMA))/(BETA*(ONE+RT))*RI/(SNS*ALP)*BKDEL1/BKDEL3*(AAI*BKDEL2/   MIS21380     2BKDEL1*(ALP-DEL)/(ALP-DEL+GL)-B*BLKAP1-B/(ALP-DEL))               MIS21390      SUM1T=(ALP-AMU)/(ALP-DEL)*(ONE-CDEXP(AI*(ALP-DEL)*SPS)*CDEXP(AI*  MIS21400     1SIGMA)*RI)/(BETA*(ONE+RT))*RI/(SNS*ALP)*BKDEL1/BKDEL3*(AAI*       MIS21410     2BKDEL2/BKDEL1*(ALP-DEL)/(ALP-DEL+GL)-B*BLKAP1-B/(ALP-DEL))        MIS21420      SUMSV1(I)=(ALP-AMU)/(ALP-DEL)*(ONE-CDCOS((ALP-DEL)*SPS+SIGMA      MIS21430     1+R*PI))/(BETA*(ONE+RT)*SNS*ALP)*BKDEL1/BKDEL3*CDEXP(-TAI*(ALP     MIS21440     2-DEL))*(A*BKDEL2/BKDEL1*(ALP-DEL)/(ALP-DEL+GL)+B*AI*BLKAP1        MIS21450
     3+B*AI/(ALP-DEL))                                                  MIS21460      FT2=SUM1*AI/(ALP-DEL)*(CDEXP(-TAI*(ALP-DEL))-CDEXP(-AISPSN        MIS21470     1*(ALP-DEL)))+FT2                                                  MIS21480      FT3=SUM1*(TAI*CDEXP(-TAI*(ALP-DEL))/(ALP-DEL)-AISPSN/             MIS21490     1(ALP-DEL)*CDEXP(-AI*(ALP-DEL)*SPMSN)+CDEXP(-TAI*(ALP-DEL))/       MIS21500     2((ALP-DEL)**2)-CDEXP(-AI*(ALP-DEL)*SPMSN)/((ALP-DEL)**2))+FT3     MIS21510      FT2T=SUM1T*CE2M*CDEXP(-AI*(ALP-DEL)*SPS)*AI/(ALP-DEL)             MIS21520     1*(CDEXP(-AI*(ALP-DEL)*TPNMP)-ONE)+FT2T                            MIS21530      FT3T=SUM1T*CE2M*CDEXP(-AI*(ALP-DEL)*SPS)*(TPNMP                   MIS21540     1*AI/(ALP-DEL)*CDEXP(-AI*(ALP-DEL)*TPNMP)+ONE/((ALP-DEL)           MIS21550     2**2)*(CDEXP(-AI*(ALP-DEL)*TPNMP)-ONE))+FT3T                       MIS21560      CALL AKAPM(ALN,BKDEL3)                                            MIS21570      SVKL2(I)=BKDEL3                                                   MIS21580      SUM2=(ALN-AMU)/(ALN-DEL)*(RI-CDEXP(AI*(ALN-DEL)*SPS)*CDEXP(AI*    MIS21590     1SIGMA))/(BETA*(ONE+RT))*RI/(SNS*ALN)*BKDEL1/BKDEL3*(AAI*BKDEL2/   MIS21600     2BKDEL1*(ALN-DEL)/(ALN-DEL+GL)-B*BLKAP1-B/(ALN-DEL))               MIS21610      SUM2T=(ALN-AMU)/(ALN-DEL)*(ONE-CDEXP(AI*(ALN-DEL)*SPS)*CDEXP(AI*  MIS21620     1SIGMA)*RI)/(BETA*(ONE+RT))*RI/(SNS*ALN)*BKDEL1/BKDEL3*(AAI*       MIS21630     2BKDEL2/BKDEL1*(ALN-DEL)/(ALN-DEL+GL)-B*BLKAP1-B/(ALN-DEL))        MIS21640      SUMSV2(I)=(ALN-AMU)/(ALN-DEL)*(ONE-CDCOS((ALN-DEL)*SPS+SIGMA      MIS21650     1+R*PI))/(BETA*(ONE+RT)*SNS*ALN)*BKDEL1/BKDEL3*CDEXP(-TAI*(ALN     MIS21660     2-DEL))*(A*BKDEL2/BKDEL1*(ALN-DEL)/(ALN-DEL+GL)+B*AI*BLKAP1        MIS21670     3+B*AI/(ALN-DEL))                                                  MIS21680      FT2=FT2+SUM2*AI/(ALN-DEL)*(CDEXP(-TAI*(ALN-DEL))-CDEXP(-AI*(SPS   MIS21690     1-SNS)*(ALN-DEL)))                                                 MIS21700      FT2T=SUM2T*CE2M*CDEXP(-AI*(ALN-DEL)*SPS)*AI/(ALN-DEL)             MIS21710     1*(CDEXP(-AI*(ALN-DEL)*TPNMP)-ONE)+FT2T                            MIS21720      FT3=FT3+SUM2*(TAI*CDEXP(-TAI*(ALN-DEL))/(ALN-DEL)-AI*(SPS         MIS21730     1-SNS)/(ALN-DEL)*CDEXP(-AI*(ALN-DEL)*SPMSN)+CDEXP(-TAI*            MIS21740     2(ALN-DEL))/((ALN-DEL)**2)-CDEXP(-AI*(ALN-DEL)*SPMSN)/             MIS21750     3((ALN-DEL)**2))                                                   MIS21760      FT3T=FT3T+SUM2T*CE2M*CDEXP(-AI*(ALN-DEL)*SPS)*((TWO               MIS21770     1+SNS-SPS)*AI/(ALN-DEL)*CDEXP(-AI*(ALN-DEL)*TPNMP)+ONE/            MIS21780     2((ALN-DEL)**2)*(CDEXP(-AI*(ALN-DEL)*TPNMP)-ONE))                  MIS21790      I7=I                                                              MIS21800      FT3TST=FT3                                                        MIS2181060    CONTINUE                                                          MIS21820      F2=F2+FT2                                                         MIS21830      AM2=AM2+FT3                                                       MIS21840
      F2P=F2P+FT2T                                                      MIS21850      AM2P=AM2P+FT3T                                                    MIS21860      GAM=SDS                                                           MIS21870      C1P=(GAM/DSTR)-SCRK                                               MIS21880      C2P=(GAM/DSTR)+SCRK                                               MIS21890      ALP=GAM*SPDD-SNDD*CDSQRT(C1P)*CDSQRT(C2P)                         MIS21900      F4=CDEXP(AI*(ALP*SPS-GAM))*(ALP*SPS-GAM)/((ALP*DSTR2-GAM*SPS)     MIS21910     1*(ALP-DEL))                                                       MIS21920      CALL AKAPM(ALP,BKDEL3)                                            MIS21930      SBKDE1(1)=BKDEL3                                                  MIS21940      SBKDE2(1)=0.D0                                                    MIS21950      CALL AKP2(RES)                                                    MIS21960      CALL AKAPPA(DEL,BKAP1)                                            MIS21970      CALL AKAPPA(CARG,CKAP1)                                           MIS21980      F4=F4*BKDEL3/(BKDEL1*BKAP1)*(A*(BKDEL1/BKDEL2*(ALP-DEL)/(ALP-DEL  MIS21990     1+GL)*(CARG-AMU)*CDEXP(TAI*GL)*BKAP1/CKAP1)+B*AI*(ONE-TWO          MIS22000     2*AI*(DMAMU)-(DMAMU)*RES)-B*AI*(DMAMU)*(BLKAP1-ONE/(ALP-DEL))      MIS22010     3)                                                                 MIS22020      F5S=B*AI/(BKDEL1*BKAP1)*(ONE-TAI*(DMAMU)-(DMAMU)*RES-             MIS22030     1(DMAMU)*BLKAP1)                                                   MIS22040      F6S=A/(BKDEL1*BKAP1)*(BKDEL1/BKDEL2*(CARG-AMU)*CDEXP(TAI*GL)      MIS22050     1*BKAP1/CKAP1)                                                     MIS22060      F4S=F4                                                            MIS22070      C1=CDEXP(-AI*(ALP-DEL)*SPS)                                       MIS22080      C2=CDEXP(-AI*(ALP-DEL)*SNS)                                       MIS22090      F4=F4*AI*CE2M/(ALP-DEL)*(C1-C2)                                   MIS22100      AM4=F4S*CE2M*(AISPS*C1/(ALP-DEL)-AISNS*C2/(ALP-DEL)               MIS22110     1+(C1-C2)/((ALP-DEL)**2))+F4S*TMSPSI*CE2M/                         MIS22120     2(ALP-DEL)*(C1-C2)                                                 MIS2213065    AM4TST=0.D0                                                       MIS22140      DO 70 I=1,200                                                     MIS22150      R=I                                                               MIS22160      GAMP=TPI*R+SDS                                                    MIS22170      GAMN=-TPI*R+SDS                                                   MIS22180      C1P=(GAMP/DSTR)-SCRK                                              MIS22190      C2P=(GAMP/DSTR)+SCRK                                              MIS22200      ALP=GAMP*SPDD-SNDD*CDSQRT(C1P)*CDSQRT(C2P)                        MIS22210      CALL AKAPM(ALP,BKDEL3)                                            MIS22220      SBKDE1(I+1)=BKDEL3                                                MIS22230
      SUM1=CDEXP(AI*(ALP*SPS-GAMP))*(ALP*SPS-GAMP)*BKDEL3/((ALP*DSTR2   MIS22240     1-GAMP*SPS)*(ALP-DEL))*(F6S*(ALP-DEL)/(ALP-DEL+GL)+F5S             MIS22250     2+B*AI/(BKDEL1*BKAP1)*(DMAMU)/(ALP-DEL))                           MIS22260      C1N=(GAMN/DSTR)-SCRK                                              MIS22270      C2N=(GAMN/DSTR)+SCRK                                              MIS22280      ALN=GAMN*SPDD-SNDD*CDSQRT(C1N)*CDSQRT(C2N)                        MIS22290      CALL AKAPM(ALN,BKDEL3)                                            MIS22300      SBKDE2(I+1)=BKDEL3                                                MIS22310      SUM2=CDEXP(AI*(ALN*SPS-GAMN))*(ALN*SPS-GAMN)*BKDEL3/((ALN*DSTR2   MIS22320     1-GAMN*SPS)*(ALN-DEL))*(F6S*(ALN-DEL)/(ALN-DEL+GL)+F5S             MIS22330     2+B*AI/(BKDEL1*BKAP1)*(DMAMU)/(ALN-DEL))                           MIS22340      C1P=CDEXP(-AI*(ALP-DEL)*SPS)                                      MIS22350      C2P=CDEXP(-AI*(ALP-DEL)*SNS)                                      MIS22360      C1N=CDEXP(-AI*(ALN-DEL)*SPS)                                      MIS22370      C2N=CDEXP(-AI*(ALN-DEL)*SNS)                                      MIS22380      F4=F4+SUM1*CE2M*AI/(ALP-DEL)*(C1P-C2P)+SUM2*CDEXP(-AI             MIS22390     1*SIGMA)*AI/(ALN-DEL)*(C1N-C2N)                                    MIS22400      AM4=AM4+SUM1*CE2M*(AISPS*C1P/(ALP-DEL)-AISNS*C2P/                 MIS22410     1(ALP-DEL)+ONE/((ALP-DEL)**2)*(C1P-C2P)+TMSPSI/(ALP-DEL)*          MIS22420     2(C1P-C2P))+SUM2*CE2M*(AISPS*C1N/(ALN-DEL)-AISNS*C2N/              MIS22430     3(ALN-DEL)+ONE/((ALN-DEL)**2)*(C1N-C2N)+TMSPSI/(ALN-DEL)*          MIS22440     4(C1N-C2N))                                                        MIS22450      I6=I+1                                                            MIS22460      IF(CDABS(AM4).LT.1.D-9)GO TO 74                                   MIS22470      IF(CDABS((AM4-AM4TST)/AM4)  .LT. CNVRGC) GO TO 75                 MIS22480      AM4TST=AM4                                                        MIS2249070    CONTINUE                                                          MIS22500      GO TO 9994                                                        MIS2251074    AM4=0.D0                                                          MIS22520      F4=0.D0                                                           MIS2253075    CONTINUE                                                          MIS22540      AM6=0.D0                                                          MIS22550      F5=0.D0                                                           MIS22560      AM5=0.D0                                                          MIS22570      CE4=CDEXP(AISDS*(-SPMSN)/(TWO*SPPSN))/TPAI                        MIS22580      CE3=CDEXP(-AISDS*(SPS+3.D0*SNS)/(TWO*SPPSN))/TPAI                 MIS22590      DO 80 IOUT=1,200                                                  MIS22600      IF(IOUT .GT. I7)  GO TO 9997                                      MIS22610      R5=IOUT-1                                                         MIS22620
      RQ1=DSQRT((R5*PI/SNS)**2+SCRK2)                                   MIS22630      RQ2=-RQ1                                                          MIS22640      C4=(RQ1*SPPSN+SMSPD)/TPI                                          MIS22650      C5=(RQ2*SPPSN+SMSPD)/TPI                                          MIS22660      BC2=BC/(TWO*SVKL1(IOUT))*CE3                                      MIS22670      BC3=BC2*SVKL1(IOUT)/SVKL2(IOUT)                                   MIS22680      BC4=BC/(TWO*SVKL1(IOUT))*CE4                                      MIS22690      BC5=BC4*SVKL1(IOUT)/SVKL2(IOUT)                                   MIS22700      F5T=0.D0                                                          MIS22710      AM5T=0.D0                                                         MIS22720      AM5TT=0.D0                                                        MIS22730      DO 85 INER=1,200                                                  MIS22740      R=INER-1                                                          MIS22750      GAMP=TPI*R+SDS                                                    MIS22760      GAMN=-TPI*R+SDS                                                   MIS22770      C1P=(GAMP/DSTR)-SCRK                                              MIS22780      C2P=(GAMP/DSTR)+SCRK                                              MIS22790      ALP=GAMP*SPDD-SNDD*CDSQRT(C1P)*CDSQRT(C2P)                        MIS22800      BKDEL3=SBKDE1(INER)                                               MIS22810      IF(INER .LE. I6)  GO TO 200                                       MIS22820      CALL AKAPM(ALP,BKDEL3)                                            MIS22830      SBKDE1(INER)=BKDEL3                                               MIS22840200   CONTINUE                                                          MIS22850      CE5=CDEXP(AI*(ALP*SPS-GAMP))                                      MIS22860      SUM1=SUMSV1(IOUT)*CE5*BKDEL3*(ALP*SPS-GAMP)/(                     MIS22870     1(ALP*DSTR2-GAMP*SPS)* SVKL1(IOUT)*(ALP-RQ1))                      MIS22880      SUM3=SUMSV2(IOUT)*CE5*BKDEL3*(ALP*SPS-GAMP)/(                     MIS22890     1(ALP*DSTR2-GAMP*SPS)*SVKL2(IOUT)*(ALP-RQ2))                       MIS22900      IF(INER .EQ. 1) GO TO 90                                          MIS22910      C1N=(GAMN/DSTR)-SCRK                                              MIS22920      C2N=(GAMN/DSTR)+SCRK                                              MIS22930      ALN=GAMN*SPDD-SNDD*CDSQRT(C1N)*CDSQRT(C2N)                        MIS22940      BKDEL3=SBKDE2(INER)                                               MIS22950      IF(INER  .LE.  I6)  GO TO 210                                     MIS22960      CALL AKAPM(ALN,BKDEL3)                                            MIS22970      SBKDE2(INER)=BKDEL3                                               MIS22980210   CONTINUE                                                          MIS22990      CE5=CDEXP(AI*(ALN*SPS-GAMN))                                      MIS23000      SUM2=SUMSV1(IOUT)*CE5*BKDEL3*(ALN*SPS-GAMN)/(                     MIS23010
     2(ALN*DSTR2-GAMN*SPS)*SVKL1(IOUT)*(ALN-RQ1))                       MIS23020      SUM4=SUMSV2(IOUT)*CE5*BKDEL3*(ALN*SPS-GAMN)/(                     MIS23030     2(ALN*DSTR2-GAMN*SPS)*SVKL2(IOUT)*(ALN-RQ2))                       MIS2304090    CONTINUE                                                          MIS23050      IF(INER .EQ. 1)  SUM2=0.D0                                        MIS23060      IF(INER .EQ. 1)  SUM4=0.D0                                        MIS23070      C1P=CDEXP(-AI*(ALP-DEL)*SPS)                                      MIS23080      C2P=CDEXP(-AI*(ALP-DEL)*SNS)                                      MIS23090      C1N=CDEXP(-AI*(ALN-DEL)*SPS)                                      MIS23100      C2N=CDEXP(-AI*(ALN-DEL)*SNS)                                      MIS23110      F5T=F5T+(SUM1+SUM3)*AI*CE2M/(ALP-DEL)*(C1P-C2P)+                  MIS23120     1(SUM2+SUM4)*CE2M*AI/(ALN-DEL)*(C1N-C2N)                           MIS23130      AM5T=AM5T+(SUM1+SUM3)*CE2M*(AISPS*C1P/(ALP-DEL)-AI                MIS23140     1*SNS*C2P/(ALP-DEL)+ONE/((ALP-DEL)**2)*(C1P-C2P)+TMSPSI/(          MIS23150     2ALP-DEL)*(C1P-C2P))+(SUM2+SUM4)*CE2M*(AISPS*C1N/(ALN-             MIS23160     3DEL)-AISNS*C2N/(ALN-DEL)+ONE/((ALN-DEL)**2)*(C1N-C2N)+AI*(TWO-    MIS23170     4SPS)/(ALN-DEL)*(C1N-C2N))                                         MIS23180      BETNP=(TPI*R+DSMS)/SPPSN                                          MIS23190      BETNN=(-TPI*R+DSMS)/SPPSN                                         MIS23200      C1N=CDEXP(TPI*R*AISNS/SPPSN)                                      MIS23210      C2N=CDEXP(TPI*R*AISPS/SPPSN)                                      MIS23220      C1P=ONE/C1N                                                       MIS23230      C2P=ONE/C2N                                                       MIS23240      CE5=CDEXP(-AI*BETNP*SPS)                                          MIS23250      CE6=CDEXP(-AI*BETNP*SNS)                                          MIS23260      CE7=CDEXP(-AI*BETNN*SPS)                                          MIS23270      CE8=CDEXP(-AI*BETNN*SNS)                                          MIS23280      CA1=AI*CE2M/BETNP*(CE5-CE6)                                       MIS23290      CA2=AI*CE2M/BETNN*(CE7-CE8)                                       MIS23300      CA3=CE2M*(AISPS/BETNP*CE5-AISNS                                   MIS23310     1*CE6/BETNP+(CE5-CE6)                                              MIS23320     2 /BETNP**2+TMSPSI/BETNP*(CE5-                                     MIS23330     3CE6))                                                             MIS23340      CA4=CE2M*(AISPS*CE7/BETNN-AISNS*                                  MIS23350     1CE8/BETNN+(CE7-CE8)                                               MIS23360     2/BETNN**2+TMSPSI/BETNN*(CE7-                                      MIS23370     3CE8))                                                             MIS23380      IF(INER .GT. 1)  GO TO 300                                        MIS23390      F5T=F5T-SUMSV1(IOUT)*(BC2*C1P-BC4*C2P)/(R-C4)*CA1-SUMSV2(IOUT)    MIS23400
     1*(BC3*C1P-BC5*C2P)/(R-C5)*CA1                                     MIS23410      AM5T=AM5T-SUMSV1(IOUT)*(BC2*C1P-BC4*C2P)/(R-C4)*CA3-SUMSV2(IOUT)  MIS23420     1*(BC3*C1P-BC5*C2P)/(R-C5)*CA3                                     MIS23430      GO TO 310                                                         MIS23440300   CONTINUE                                                          MIS23450      F5T=F5T-SUMSV1(IOUT)*((BC2*C1P-BC4*C2P)/(R-C4)*CA1-(BC2*C1N-BC4   MIS23460     1*C2N)/(R+C4)*CA2)-SUMSV2(IOUT)*((BC3*C1P-BC5*C2P)/(R-C5)*CA1      MIS23470     2-(BC3*C1N-BC5*C2N)/(R+C5)*CA2)                                    MIS23480      AM5T=AM5T-SUMSV1(IOUT)*((BC2*C1P-BC4*C2P)/(R-C4)*CA3-(BC2*C1N-    MIS23490     1BC4*C2N)/(R+C4)*CA4)-SUMSV2(IOUT)*((BC3*C1P-BC5*C2P)/(R-C5)*CA3   MIS23500     2 -(BC3*C1N-BC5*C2N)/(R+C5)*CA4)                                   MIS23510310   CONTINUE                                                          MIS23520      IF(CDABS((AM5TT-AM5T)/AM5T)  .LT. CNVRGC)    GO TO 95             MIS23530      AM5TT=AM5T                                                        MIS2354085    CONTINUE                                                          MIS23550      GO TO 9995                                                        MIS2356095    CONTINUE                                                          MIS23570      IF(INER  .LE.  I6)  GO TO 220                                     MIS23580      I6=INER                                                           MIS23590220   CONTINUE                                                          MIS23600      F5=F5+F5T                                                         MIS23610      AM5=AM5+AM5T                                                      MIS23620      ALP1=(TPI*C4+DSMS)/SPPSN                                          MIS23630      ALP2=(TPI*C5+DSMS)/SPPSN                                          MIS23640      CE5=CDEXP(TPAI*C4*SNS/SPPSN)                                      MIS23650      CE6=CDEXP(TPAI*C5*SNS/SPPSN)                                      MIS23660      CE7=ONE-CDEXP(-TPAI*C4)                                           MIS23670      CE8=ONE-CDEXP(-TPAI*C5)                                           MIS23680      C1P=ONE/(CE5*CE7)                                                 MIS23690      C2P=CE5/CE7                                                       MIS23700      C1N=ONE/(CE6*CE8)                                                 MIS23710      C2N=CE6/CE8                                                       MIS23720      CA1=AI*CE2M/ALP1*(CDEXP(-AISPS*ALP1)-CDEXP(-AISNS                 MIS23730     1*ALP1))                                                           MIS23740      CA2=AI*CE2M/ALP2*(CDEXP(-AISPS*ALP2)-CDEXP(-AISNS                 MIS23750     2*ALP2))                                                           MIS23760      CA3=CE2M*(AISPS*CDEXP(-AI*ALP1*SPS)/ALP1-AISNS                    MIS23770     1*CDEXP(-AI*ALP1*SNS)/ALP1+(CDEXP(-AI*ALP1*SPS)-CDEXP(-AI*ALP1*SNS)MIS23780     *)                                                                 MIS23790
     2/ALP1**2+TMSPSI/ALP1*(CDEXP(-AI*ALP1*SPS)-CDEXP(-AI*ALP1*SNS)     MIS23800     3))                                                                MIS23810      CA4=CE2M*(AISPS*CDEXP(-AI*ALP2*SPS)/ALP2-AISNS                    MIS23820     1 *CDEXP(-AI*ALP2*SNS)/ALP2+(CDEXP(-AI*ALP2*SPS)-CDEXP(-AI*ALP2*SNSMIS23830     *))                                                                MIS23840     2/ALP2**2+TMSPSI/ALP2*(CDEXP(-AI*ALP2*SPS)-CDEXP(-AI*ALP2*SNS)     MIS23850     3))                                                                MIS23860      F5=F5-TPAI*SUMSV1(IOUT)*(BC2*C1P-BC4*C2P)*CA1-TPAI                MIS23870     1*SUMSV2(IOUT)*(BC3*C1N-BC5*C2N)*CA2                               MIS23880      AM5=AM5-TPAI*SUMSV1(IOUT)*(BC2*C1P-BC4*C2P)*CA3-TPAI              MIS23890     2 *SUMSV2(IOUT)*(BC3*C1N-BC5*C2N)*CA4                              MIS23900      IF(CDABS((AM5-AM6)/AM5) .LT. CNVRGC)  GO TO 100                   MIS23910      AM6=AM5                                                           MIS2392080    CONTINUE                                                          MIS23930      GO TO 9996                                                        MIS23940100   CONTINUE                                                          MIS23950      CLIFT=F1+F2-F2P+F4+F5                                             MIS23960      CMOMT=AM1+AM2-AM2P+AM4+AM5-AMOAXS*CLIFT                           MIS23970      CL=CLIFT/PK2                                                      MIS23980      CM=CMOMT/PK2                                                      MIS23990      IF(DABS(GL).LT..00001D0)RETURN                                    MIS24000C                                                                       MIS24010C      NOTE THAT WAKE COEFFICIENTS HAVE BEEN DEFINED WRT THE LEADING EDGMIS24020C     E                                                                 MIS24030C                                                                       MIS24040      EIGL=CDEXP(-AI*GL)                                                MIS24050      CL=CL*EIGL                                                        MIS24060      CM=CM*EIGL                                                        MIS24070      RETURN                                                            MIS240809992  WRITE(6,3005)                                                     MIS240903005  FORMAT(5X,'AM1 LOOP DID NOT CONVERGE')                            MIS24100      GO TO 5000                                                        MIS241109994  WRITE (6,3015)                                                    MIS241203015  FORMAT(5X,'AM4 LOOP DID NOT CONVERGE')                            MIS24130      GO TO 5000                                                        MIS241409995  WRITE(6,3020)                                                     MIS241503020  FORMAT(5X,'AM5T LOOP DID NOT CONVERGE')                           MIS24160      GO TO 5000                                                        MIS241709996  WRITE(6,3025)                                                     MIS24180
3025  FORMAT(5X,'AM5 LOOP DID NOT CONVERGE')                            MIS24190      GO TO 5000                                                        MIS242009997  WRITE(6,3030)                                                     MIS242103030  FORMAT(5X,'OUTER LOOP OF AM5 EXCEEDED I7')                        MIS242205000  RETURN                                                            MIS242309991  WRITE(6,3000)                                                     MIS242403000  FORMAT(5X,'AXIAL MACH NUMBER IS EQUAL TO OR GREATER THAN ONE')    MIS24250      RETURN                                                            MIS24260      END                                                               MIS24270C                                                                       MIS24280C                                                                       MIS24290C                                                                       MIS24300      SUBROUTINE TITPAG                                                 MIS24310C                                                               080687RAMIS24320C                                                                       MIS24330C                                                                       MIS24340      WRITE(6,10)                                                       MIS24350   10 FORMAT(1H1////26X,                                                MIS24360     &       ' ***         ***   ***    **********   ************   ****MIS24370     &********')                                                        MIS24380      WRITE(6,12)                                                       MIS24390   12 FORMAT(25X,                                                       MIS24400     &       ' ****       ****   ***   ***********   ************   ****MIS24410     &*********')                                                       MIS24420      WRITE(6,14)                                                       MIS24430   14 FORMAT(24X,                                                       MIS24440     &       ' *****     *****   ***   ***           ***            *** MIS24450     &      ***')                                                       MIS24460      WRITE(6,18)                                                       MIS24470   18 FORMAT(23X,                                                       MIS24480     &       ' ******   ******   ***   **********    ************   ****MIS24490     &*********')                                                       MIS24500      WRITE(6,20)                                                       MIS24510   20 FORMAT(22X,                                                       MIS24520     &       ' *** *** *** ***   ***    **********   ************   ****MIS24530     &********')                                                        MIS24540      WRITE(6,22)                                                       MIS24550   22 FORMAT(21X,                                                       MIS24560     &       ' ***  *****  ***   ***           ***   ***            *** MIS24570
     &    ***')                                                         MIS24580      WRITE(6,24)                                                       MIS24590   24 FORMAT(20X,                                                       MIS24600     &       ' ***   ***   ***   ***   ***********   ************   *** MIS24610     &     ***')                                                        MIS24620      WRITE(6,26)                                                       MIS24630   26 FORMAT(19X,                                                       MIS24640     &       ' ***    *    ***   ***   **********    ************   *** MIS24650     &      ***')                                                       MIS24660C     WRITE(6,15)                                                       MIS24670C  15 format(/23x,' the official aero code for the 1988 korean olymp',  MIS24680C    &              'ics'//////////)                                    MIS24690C                                                                       MIS24700      RETURN                                                            MIS24710      END                                                               MIS24720C                                                                       MIS24730C                                                                       MIS24740C                                                                       MIS24750C.....ROOT LOCUS PLOTTING SUBROUTINE                            6/30/87 MIS24760C                                                                       MIS24770C                                                                       MIS24780      SUBROUTINE RLPLT(NPT,ANG,X,Y)                                     MIS24790      COMMON /RID/ TITLE(10), TUNE                                      MIS24800      CHARACTER*9 HEAD,BLNK,FREQ,HZ                                     MIS24810      CHARACTER*4 TITLE                                                 MIS24820      CHARACTER*1 S1,S2,S3,S4,S5,SPOT,SYMBL                             MIS24830      DIMENSION ANG(120), X(120), Y(120), XL(11), SPOT(101), SYMBL(10)  MIS24840C                                                                       MIS24850      DATA S1,S2,S3,S4,S5/'I','+', '-', ' ', '*'/                       MIS24860      DATA SYMBL/'1','2','3','4','5','6','7','8','9','0'/               MIS24870      DATA BLNK,FREQ,HZ/'         ', 'FREQUENCY', '   HZ.   '/          MIS24880      DATA XMIN,YMIN,XMAX,YMAX/2*10.E8, 2*-10.E8/                       MIS24890C                                                                       MIS24900C                                                                       MIS24910      BACKSPACE 5                                                       MIS24920      READ(5,799) PLOTS                                                 MIS24930  799 FORMAT(T21,F10.5)                                                 MIS24940      IF (PLOTS.LT.1.) PLOTS = 1.1                                      MIS24950      NPLOT = INT(PLOTS)                                                MIS24960
      BACKSPACE 5                                                       MIS24970C                                                                       MIS24980      DO 1000 IPLOT = 1,NPLOT                                           MIS24990      DO 5 I=1,NPT                                                      MIS25000      IF (X(I).LT.XMIN) XMIN=X(I)                                       MIS25010      IF (X(I).GT.XMAX) XMAX=X(I)                                       MIS25020      IF (Y(I).LT.YMIN) YMIN=Y(I)                                       MIS25030      IF (Y(I).GT.YMAX) YMAX=Y(I)                                       MIS25040    5 CONTINUE                                                          MIS25050      READ(5,800) XMI,XMA,YMI,YMA                                       MIS25060  800 FORMAT(T31,4F10.5)                                                MIS25070      YL5 = YMAX + (YMAX-YMIN)*.05                                      MIS25080      YL1 = YMIN - (YMAX-YMIN)*.05                                      MIS25090      IF (YMI.NE.0.) YL1 = YMI                                          MIS25100      IF (YMA.NE.0.) YL5 = YMA                                          MIS25110C.... DELY = (YL5-YL1)/4.                                               MIS25120      DELY = (YL5-YL1)/5.                                               MIS25120      YL2 = YL1 + DELY                                                  MIS25130      YL3 = YL2 + DELY                                                  MIS25140      YL4 = YL3 + DELY                                                  MIS25150      XL(11) = XMAX + (XMAX-XMIN)*.05                                   MIS25160      XL(1)  = XMIN - (XMAX-XMIN)*.05                                   MIS25170      IF (XMI.NE.0.) XL(1) = XMI                                        MIS25180      IF (XMA.NE.0.) XL(11) = XMA                                       MIS25190      DELX = (XL(11) - XL(1))/10.                                       MIS25200      DO 7 I=2,10                                                       MIS25210      XL(I) = XL(I-1) + DELX                                            MIS25220    7 CONTINUE                                                          MIS25230C                                                                       MIS25240      WRITE(6,10)TITLE                                                  MIS25250   10 FORMAT('1',' ROOT LOCUS PLOT',3X,10A4//)                          MIS25260      DELX = (XL(11)-XL(1))/100.                                        MIS25270C.... DELY = (YL5-YL1)/40.                                              MIS25280      DELY = (YL5-YL1)/50.                                              MIS25280C                                                                       MIS25290C                                                                       MIS25300      YL = YL5                                                          MIS25310C.... DO 50 I=1,41                                                      MIS25320      DO 50 I=1,51                                                      MIS25320
C.....                                                                  MIS25330      DO 15 II=2,101                                                    MIS25340      SPOT(II) = S4                                                     MIS25350   15 CONTINUE                                                          MIS25360      SPOT(1) = S1                                                      MIS25370      IONE = I-1                                                        MIS25380      ITWO = ((I-1)/10)*10                                              MIS25390      IF (IONE.EQ.ITWO) SPOT(1) = S2                                    MIS25400C.....                                                                  MIS25410      YU = YL                                                           MIS25420      YL = YU-DELY                                                      MIS25430      DO 40 III = 1,NPT                                                 MIS25440      IF (YL.GE.Y(III).OR.YU.LT.Y(III)) GO TO 40                        MIS25450C                                                                       MIS25460C.....                                                                  MIS25470      XR = XL(1)                                                        MIS25480      DO 30 J=1,101                                                     MIS25490      XLFT=XR                                                           MIS25500      XR = XLFT+DELX                                                    MIS25510      IF (XLFT.GE.X(III).OR.XR.LT.X(III)) GO TO 30                      MIS25520C                                                                       MIS25530      SPOT(J) = S5                                                      MIS25540C                                                                       MIS25550      RES = ANG(III)                                                    MIS25560      IF (RES.EQ.0.) THEN                                               MIS25570         SPOT(J+1) = SYMBL(10)                                          MIS25580         GO TO 30                                                       MIS25590      ENDIF                                                             MIS25600      XLOG = ALOG10(RES)                                                MIS25610      NCHAR = INT(XLOG) + 1                                             MIS25620      DO 29 K=1,NCHAR                                                   MIS25630         NEXP = INT(XLOG)                                               MIS25640         IEXP = NCHAR - K                                               MIS25650         IF (NEXP.NE.IEXP) THEN                                         MIS25660  27          SPOT(J+K) = SYMBL(10)                                     MIS25670              GO TO 29                                                  MIS25680         ENDIF                                                          MIS25690         XMANT = XLOG - INT(XLOG)                                       MIS25700         NUMB  = INT(10.**XMANT + .005)                                 MIS25710
         SPOT(J+K) = SYMBL(NUMB)                                        MIS25720         RES  = RES - NUMB*(10.**(NCHAR-K))                             MIS25730              IF (K.EQ.NCHAR.OR.RES.LT.1.) GO TO 29                     MIS25740         XLOG = ALOG10(RES)                                             MIS25750   29 CONTINUE                                                          MIS25760      GO TO 40                                                          MIS25770   30 CONTINUE                                                          MIS25780C.....                                                                  MIS25790C                                                                       MIS25800   40 CONTINUE                                                          MIS25810C.... IF (I.NE.41) GO TO 43                                             MIS25820      IF (I.NE.51) GO TO 43                                             MIS25820      DO 42 M=1,91,10                                                   MIS25830      SPOT(M) = S2                                                      MIS25840      DO 41 N=2,10                                                      MIS25850      NN = M-1 + N                                                      MIS25860      SPOT(NN) = S3                                                     MIS25870   41 CONTINUE                                                          MIS25880   42 CONTINUE                                                          MIS25890      SPOT(101) = S2                                                    MIS25900   43 CONTINUE                                                          MIS25910      HEAD = BLNK                                                       MIS25920      IF (I.EQ.15) HEAD = FREQ                                          MIS25930      IF (I.EQ.16) HEAD = HZ                                            MIS25940      IF (IONE.EQ.ITWO) WRITE(6,44) YU,(SPOT(L),L=1,101)                MIS25950      IF (IONE.NE.ITWO) WRITE(6,45) HEAD,(SPOT(L),L=1,101)              MIS25960   44 FORMAT(T9,F8.4,T17,101A1)                                         MIS25970   45 FORMAT(T4,A9,T17,101A1)                                           MIS25980   50 CONTINUE                                                          MIS25990C                                                                       MIS26000      WRITE(6,52) (XL(L),L=1,11)                                        MIS26010   52 FORMAT(T13,11(F8.4,2X)/T64,'DAMPING'//                            MIS26020     &  T19,'***FLUTTER SUMMARY***'/                                    MIS26030     &  T17,'PHASE'/T17,'ANGLE',T26,'DAMPING',T37,'FREQUENCY'/          MIS26040     &  T14,'==================================='/)                     MIS26050      DO 54 I=1,NPT                                                     MIS26060      IF (YL1.LE.Y(I).AND.Y(I).LE.YL5) WRITE(6,53) ANG(I),X(I),Y(I)     MIS26070   53 FORMAT(T16,F6.1,T25,F8.4,T36,F8.4)                                MIS26080   54 CONTINUE                                                          MIS26090
C                                                                       MIS26100 1000 CONTINUE                                                          MIS26110      RETURN                                                            MIS26120      END                                                               MIS26130C                                                                       MIS26140C                                                                       MIS26150      SUBROUTINE TIME                                                   MIS26160      DIMENSION I(8)                                                    MIS26170      CALL DATIM(I)                                                     MIS26180      I(8) = I(8) - 1900                                                MIS26190      WRITE(6,10) I(7),I(6),I(8),I(5),I(4),I(3)                         MIS26200   10 FORMAT(T3,I2,'/',I2,'/',I2,5X,I2,':',I2,':',I2)                   MIS26210      RETURN                                                            MIS26220      END                                                               MIS26230
